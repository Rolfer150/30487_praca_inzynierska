(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{C7fj:function(t,e,n){"use strict";n.r(e),n.d(e,"EditorModule",(function(){return Cc}));var i=n("5xGT"),a=n("CNgt"),r=n("EM62"),o=n("s2Ay"),s=function(){function t(t){this.state=t}return t.prototype.openFullScreen=function(){this.state.set("LeftSidebarVisibility",!0),this.state.set("FolderPanelScreen",a.a.FULL_SCREEN)},t.\u0275fac=function(e){return new(e||t)(r.gc(i.Mb))},t.\u0275cmp=r.ac({type:t,selectors:[["dashboard-canvas-message"]],decls:7,vars:0,consts:[[1,"fx-cover","dashboard-canvas-message-container"],[1,"dashboard-canvas-message-box"],["translate","",1,"dashboard-canvas-message-title"],[1,"dashboard-canvas-message-button"],["translate","",1,"btn-medium","btn-primary","fx-no-margin",3,"click"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"h2",2),r.fd(3,"MESSAGES.DASHBOARD_CANVAS_MESSAGE"),r.lc(),r.mc(4,"div",3),r.mc(5,"button",4),r.uc("click",(function(){return e.openFullScreen()})),r.fd(6," BUTTONS.VIEW_WORKSPACES "),r.lc(),r.lc(),r.lc(),r.lc())},directives:[o.a],styles:[".dashboard-canvas-message-container[_ngcontent-%COMP%]{z-index:2;background-color:#f0f0f0}.dashboard-canvas-message-box[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.dashboard-canvas-message-box[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{text-align:center}.dashboard-canvas-message-title[_ngcontent-%COMP%]{margin-bottom:12px}"]}),t}(),c=n("pi4j"),l=n("+ETr"),u=n("D57K"),p=n("+1jB"),d=n("xVbo"),h=n("0B/R"),g=n("8j5Y"),f=n("TLy2"),b=n("J+dc"),m=n("YtkY"),v=n("TaSY"),y=n("diDk"),S=n("P1E4"),O=n("qMyy"),x=n("nsO7"),C=n("X0jn"),T=n("Xpu5"),j=n("/jjY"),P=n("unyx"),w=n("B5wR"),M=n("6Oco"),I=n("ROBh"),E=n("IdLP"),D=n("g6G6"),k=n("gZOS"),A=n("Ei0d"),_=n("xnGY"),L=n("m/OR"),R=n("0jHB"),B=function(){function t(t,e,n,i,a,r,o){this.mcu=t,this.state=e,this.eDataRegistry=n,this.commandService=i,this.ell=a,this.subManager=r,this.defLocator=o,this.eDataMemo=new Map}return Object.defineProperty(t.prototype,"name",{get:function(){return"ShapeAddedBinder"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"paths",{get:function(){return[]},enumerable:!1,configurable:!0}),t.prototype.apply=function(t,e){var n=this;if(e!==i.A.EXECUTE)return M.a;this.changeModel=t;var a=t.__sakota__.getChanges();return a.$set?this.shapeAdded(t,a).pipe(Object(d.a)((function(t){return t})),Object(h.a)(),Object(g.a)((function(t){var e,i,a={};try{for(var r=Object(u.k)(t),o=r.next();!o.done;o=r.next()){var s=o.value,c=s.id;a[c]||(a[c]={});var l=s.__sakota__.getChanges();Object(x.merge)(a[c],l)}}catch(p){e={error:p}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}n.commitEdataChanges(a)}))):void 0},t.prototype.commitEdataChanges=function(t){var e=this;Object.keys(t).forEach((function(n){t[n]&&e.subManager.getFutureSub(n).pipe(Object(f.a)((function(t){return t.status})),Object(d.a)((function(t){return t.subStatus===_.f.started})),Object(b.a)(1)).subscribe((function(){e.commandService.dispatch(T.a.applyModifierEData,n,{modifier:t[n],origin:"ShapeAddedBinder"})}))}))},t.prototype.updateEdata=function(t){var e=this;if(t.triggerNewEData)if(t.eData){var n=Object.keys(t.eData);if(1===n.length){var a=n[0],r=t.eData[a];return this.getEDataChangeModel(a).pipe(Object(m.a)((function(n){if(n){var i=void 0;return i=r?n.entities[r]:e.addEntityToEData(n,t),e.mcu.addEntityToShape(e.changeModel,{shapeId:t.id,eDataId:n.id,entityId:i.id,entityDefId:i.eDefId,data:n.getEntityDataItems(i.id,!0,!0),taskMap:i.taskMap}),e.addShapeToEntity(e.changeModel.id,i.id,t,n),n}return null})))}i.hb.error("Invalid eData config passed on drop")}else{var o=this.eDataRegistry.searchEntityDef([""+t.defId]);if(o){var s=this.eDataRegistry.getEDataDef(o.id);if(s)return this.getEDataModelByDefId(s).pipe(Object(m.a)((function(n){if(n){var i=k.Sakota.create(n),a=e.addEntityToEData(i,t);return e.mcu.addEntityToShape(e.changeModel,{shapeId:t.id,eDataId:n.id,entityId:a.id,entityDefId:a.eDefId}),e.eDataMemo.set(o.id,i),i}return null})));throw Error("Definition "+o.id+" is missing and cannot start for shape")}}},t.prototype.getEDataChangeModel=function(t){return this.ell.getEData(t).pipe(Object(f.a)((function(t){return t.getEDataModelOnce().pipe(Object(m.a)((function(t){return k.Sakota.create(t)})))})),Object(b.a)(1))},t.prototype.shapeAdded=function(t,e){var n=[Object(I.a)()];this.eDataMemo.clear();var i=!1;for(var a in e.$set){var r=a.split(".");if(2===r.length&&"shapes"===r[0]){i=!0;var o=r[1],s=t.shapes[o];if("connector"!==s.type){var c=this.updateEdata(s);c instanceof E.a&&n.push(c)}}}return i&&L.a.newShapesAdded.next(!0),D.a.apply(void 0,Object(u.j)(n))},t.prototype.addShapeToEntity=function(t,e,n,i){var a={entityId:e,shapeId:n.id,shapeDefId:n.defId,diagramId:t};this.mcu.addShapeToEntity(i,a)},t.prototype.addEntityToEData=function(t,e,n){var a,r;if(!n){if(!e)throw Error("Cannot add an Entity without a Shape reference");var o,s=t.defId;if(!s){var c=Object.values(t.entities);c&&c[0]&&(s=c[0].defId)}e.entityDefId&&(o=t.customEntityDefs[e.entityDefId]),e.entityDefId&&o||(o=w.a.instance.getEntityDefByShapeId(e.defId,s)),n=new j.a(i.wb.entityId(),o.id),o&&o.dataItems&&(n.data||(n.data={}),n.refData||(n.refData={}),Object.keys(o.dataItems).forEach((function(t){var e=o.dataItems[t];if(e.type===C.d.LOOKUP?n.data[t]=[]:n.data[t]=e.value?e.value:e.default,e.type===C.d.FORMULA){for(var i=e.options.parsedExpression,a=/data\['([a-zA-Z0-9]+)'\]/g,r=/refData\['([a-zA-Z0-9]+)'\]\['([a-zA-Z0-9]+)'\]/g,s=void 0,c=!1;null!==(s=a.exec(i));)c=!0,n.addRefField(s[1],t);for(;null!==(s=r.exec(i));){c=!0;var l=s[1],u=s[2];n.refData[l]||(n.refData[l]={}),n.refData[l][u]||(n.refData[l][u]={value:[],refFields:[]}),-1===n.refData[l][u].refFields.indexOf(t)&&n.refData[l][u].refFields.push(t)}c||(n.data[t]=A.a.evaluate(i))}}))),n.defId=s,n.dataSource=e.dataSource,n.style={shape:Object(u.a)({},e.style),bounds:{width:(null===(a=null==e?void 0:e.defaultBounds)||void 0===a?void 0:a.width)*(e.scaleX||1),height:(null===(r=null==e?void 0:e.defaultBounds)||void 0===r?void 0:r.height)*(e.scaleY||1),angle:e.angle||0,defaultBounds:e.defaultBounds}},n.defaultShapeContext=e.shapeContext}return this.mcu.addEntity(t,{entity:n,shape:e,diagram:this.changeModel}),n},t.prototype.getEDataModelByDefId=function(t){var e=this;return this.ell.currentEDataModelsOnce().pipe(Object(m.a)((function(n){return e.getEDataModelByDefIdForProjectEData(t,n)})))},t.prototype.getEDataModelByDefIdForProjectEData=function(t,e){var n,i=this;if(e.length>0&&(n=Object(x.find)(e,(function(e){if(e.defId)return e.defId===t.defId;if(e.entities){var n=Object.values(e.entities);if(n&&n[0])return n[0].defId===t.defId}}))),n)return this.addEdataModel(n.id),this.commandService.dispatch(O.a.startEDataSubscription,n.id),n;if("home"!==this.state.get("CurrentProject")){if(this.eDataMemo.has(t.defId))return this.eDataMemo.get(t.defId);var a=this.createEdata(this.state.get("CurrentProject"),t.defId);return this.addEdataModel(a.id),this.commandService.dispatch(S.a.createEData,this.state.get("CurrentProject"),a).pipe(Object(v.a)(),Object(f.a)((function(){return i.commandService.dispatch(O.a.startEDataSubscription,a.id).pipe(Object(v.a)())}))).subscribe(),a=Object(x.merge)(new P.b(a.id),a),this.eDataMemo.set(t.defId,a),a}},t.prototype.addEdataModel=function(t){if(t){var e=void 0;this.changeModel.eData?(e=Object(x.clone)(this.changeModel.eData),-1===this.changeModel.eData.indexOf(t)&&e.push(t)):e=[t],this.changeModel.eData=e}},t.prototype.createEdata=function(t,e){var n={},a=this.eDataRegistry.getEDataDef(e);return n.id=i.wb.eDataId(),n.createdTime=Date.now(),n.dataDefs={},n.defId=e,n.rid=t,n.name=a.name,n},t.\u0275fac=function(e){return new(e||t)(r.qc(p.a),r.qc(i.Mb),r.qc(w.a),r.qc(i.B),r.qc(y.a),r.qc(_.d),r.qc(R.a))},t.\u0275prov=r.cc({token:t,factory:t.\u0275fac}),t}(),H=n("3AeD"),F=n("STWM"),N=n("Jzy8"),G=n("w1VY"),q=n("QoSw"),V=n("wx9+"),U=n("W9bu"),z=n("NNJu"),Y=n("C05f"),X=n("KTx3"),K=n("3mST"),Q=n("c7W3"),W=n("r3/A"),Z=n("2kYt"),J=n("Wrqg"),$=["textInput"],tt=["container"];function et(t,e){if(1&t){var n=r.nc();r.mc(0,"div",13),r.mc(1,"a",14),r.uc("blur",(function(){return r.Qc(n),r.yc(2).onBlur()}))("click",(function(t){return r.Qc(n),r.yc(2).navigate(t)})),r.fd(2),r.lc(),r.lc()}if(2&t){var i=e.ngIf;r.Sb(2),r.gd(i)}}function nt(t,e){if(1&t){var n=r.nc();r.mc(0,"div",6),r.dd(1,et,3,1,"div",7),r.mc(2,"button",8),r.uc("click",(function(){return r.Qc(n),r.yc().onEditBtnClick()})),r.xc(),r.mc(3,"svg",9),r.hc(4,"use",10),r.lc(),r.lc(),r.wc(),r.mc(5,"button",11),r.uc("click",(function(){return r.Qc(n),r.yc().removeLink()})),r.xc(),r.mc(6,"svg",9),r.hc(7,"use",12),r.lc(),r.lc(),r.lc()}if(2&t){var i=r.yc();r.Sb(1),r.Dc("ngIf",i.editorState.value.value)}}function it(t,e){if(1&t){var n=r.nc();r.mc(0,"div"),r.mc(1,"text-input",15,16),r.uc("updateText",(function(){return r.Qc(n),r.yc().handleInputChange()}))("keydown",(function(t){return r.Qc(n),r.yc().handleKeydown(t)}))("blur",(function(){return r.Qc(n),r.yc().onBlur()})),r.zc(3,"translate"),r.lc(),r.lc()}if(2&t){var i=r.yc();r.Sb(1),r.Ec("placeholder",r.Ac(3,2,"LABELS.ADD_LINK_AND_ENTER")),r.Dc("value",i.editorState.value.value)}}function at(t,e){1&t&&(r.mc(0,"div",17),r.fd(1,"LABELS.PRESS_ESCAPE_TO_CANCEL"),r.lc())}var rt,ot=function(){function t(t,e,n,i,a,r){this.ll=t,this.viewportService=e,this.linkService=n,this.commandService=i,this.dtov=a,this.state=r,this.toolbarGap=2,this.subs=[],this.editorState=new Y.a({state:"view",value:""}),this.shapelinkViewValue=new Y.a(""),this.shapelinkEditValue=new Y.a("")}return Object.defineProperty(t.prototype,"containerElement",{get:function(){return this.container.nativeElement},enumerable:!1,configurable:!0}),t.prototype.ngAfterViewInit=function(){var t=this;this.containerElement.style.display="none",this.subs.push(this.state.changes("ShapelinkEditState").pipe(Object(f.a)((function(e){return e.open?(t.updateLinkValue(),t.containerElement.style.display="block",t.textInput&&t.textInput.focus(),t.position(),Object(D.a)(t.state.changes("Selected").pipe(Object(K.a)(1),Object(b.a)(1),Object(g.a)((function(){return t.closeEditor()}))),t.onEscape().pipe(Object(g.a)((function(){return t.closeEditor()}))),t.viewportService.getShapeModels().pipe(Object(g.a)((function(){return t.position()}))))):(t.containerElement.style.display="none",Object(M.b)())}))).subscribe())},t.prototype.onBlur=function(){this.closeEditor()},t.prototype.onEditBtnClick=function(){i.Ob.track("shapelinkEditor.edit.click");var t=this.linkData&&this.linkData.link&&this.linkData.link.link?this.linkData.link.link:"";this.editorState.next({state:"edit",value:t||""})},t.prototype.ngOnDestroy=function(){for(;this.subs.length;)this.subs.pop().unsubscribe()},t.prototype.handleKeydown=function(t){t.keyCode===C.l.Enter?(t.preventDefault(),this.applyLink()):t.keyCode===C.l.Escape&&this.closeEditor()},t.prototype.handleInputChange=function(){this.containerElement.classList.contains("invalid-url")&&this.containerElement.classList.remove("invalid-url")},t.prototype.navigate=function(t){t.preventDefault(),this.linkService.navigate(this.linkData.link)},t.prototype.updateLinkValue=function(){var t=this;this.getLinkAndSource().subscribe((function(e){e.link?t.editorState.next({state:"view",value:e.link.placeHolder||e.link.link}):(t.editorState.next({state:"edit",value:""}),t.textInput&&t.textInput.clear()),t.linkData=e}))},t.prototype.getLinkAndSource=function(){var t=this.state.get("Selected");return 1===t.length?this.ll.forCurrent(!1).getShapeOnce(t[0]).pipe(Object(m.a)((function(e){return{link:e.links?e.links[0]:void 0,source:{type:"s",id:t[0]}}}))):t.length>1?this.ll.forCurrent(!1).getDiagramOnce().pipe(Object(m.a)((function(e){var n,i;if(e.isShapeInGroup(t)){var a=e.getGroupId(t[0]);return{link:null===(i=null===(n=e.groups[a])||void 0===n?void 0:n.links)||void 0===i?void 0:i[0],source:{type:"g",id:t[0]}}}return null}))):void 0},t.prototype.position=function(){var t=this;this.getSelectionBounds().subscribe((function(e){var n=t.containerElement.getBoundingClientRect(),i=t.dtov.x(e.centerX)-n.width/2,a=t.dtov.y(e.bottom)+10;t.containerElement.style.top=a+"px",t.containerElement.style.left=i+"px"}))},t.prototype.onEscape=function(){return Object(X.a)(window,"keydown").pipe(Object(d.a)((function(t){return t.keyCode===C.l.Escape})))},t.prototype.closeEditor=function(){this.editorState.next({state:"edit",value:""}),this.commandService.dispatch(Q.a.openShapelinkEditor,{open:!1})},t.prototype.removeLink=function(){i.Ob.track("shapelinkEditor.unlink.click"),this.commandService.dispatch(Q.a.applyShapelink,{source:this.linkData.source,link:this.linkData.link,isDelete:!0}),this.closeEditor()},t.prototype.applyLink=function(){if(this.textInput&&this.textInput.value){var t=encodeURI(this.textInput.value);if(W(t)||(t="https://"+t),!W(t))return void this.containerElement.classList.add("invalid-url");var e=N.E.fromUrl(t);this.commandService.dispatch(Q.a.applyShapelink,{source:this.linkData.source,link:e,curLink:this.linkData.link})}this.closeEditor()},t.prototype.getSelectionBounds=function(){var t=this.state.get("Selected");return this.ll.forCurrent(!0).getDiagramOnce().pipe(Object(m.a)((function(e){return e.getBounds(t)})))},t.\u0275fac=function(e){return new(e||t)(r.gc(q.a),r.gc(V.a),r.gc(U.a),r.gc(i.B),r.gc(G.a),r.gc(i.Mb))},t.\u0275cmp=r.ac({type:t,selectors:[["shapelink-editor"]],viewQuery:function(t,e){var n;(1&t&&(r.kd($,!0),r.kd(tt,!0)),2&t)&&(r.Mc(n=r.vc())&&(e.textInput=n.first),r.Mc(n=r.vc())&&(e.container=n.first))},decls:8,vars:7,consts:[[1,"shapelink-editor-container"],["container",""],[1,"shapelink-editor-inner-container"],["class","fx-height-inherit fx-center-vertical",4,"ngIf"],[4,"ngIf"],["class","fx-center caption","translate","",4,"ngIf"],[1,"fx-height-inherit","fx-center-vertical"],["class","fx-flex-expand fx-ellipsis",4,"ngIf"],[1,"shapelink-edit-btn","btn-small","btn-link","lib-browser-close-btn","fx-no-padding",3,"click"],[1,"nu-icon"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-edit"],[1,"shapelink-remove-btn","btn-small","btn-link","lib-browser-close-btn",3,"click"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-trash-thin"],[1,"fx-flex-expand","fx-ellipsis"],["target","_blank",1,"shapelink-label","fx-ellipsis","primary","body",3,"blur","click"],["autoFocus","true","emitForInputChange","true",1,"shapelink-input",3,"placeholder","value","updateText","keydown","blur"],["textInput",""],["translate","",1,"fx-center","caption"]],template:function(t,e){1&t&&(r.mc(0,"div",0,1),r.mc(2,"div",2),r.dd(3,nt,8,1,"div",3),r.zc(4,"async"),r.dd(5,it,4,4,"div",4),r.zc(6,"async"),r.lc(),r.dd(7,at,2,0,"div",5),r.lc()),2&t&&(r.Sb(3),r.Dc("ngIf","view"===r.Ac(4,3,e.editorState).state),r.Sb(2),r.Dc("ngIf","edit"===r.Ac(6,5,e.editorState).state),r.Sb(2),r.Dc("ngIf","edit"===e.editorState.value))},directives:[Z.t,J.a,o.a],pipes:[Z.b,o.d],styles:[".shapelink-editor-inner-container[_ngcontent-%COMP%]{margin:.5rem;border:1px solid #caccce;position:relative;width:320px;height:50px;background:#fff;box-sizing:border-box;border-radius:6px;z-index:2}.shapelink-editor-container[_ngcontent-%COMP%]{position:absolute}.shapelink-label[_ngcontent-%COMP%]{padding:1rem 2.75rem 1rem 1rem}.shapelink-input[_ngcontent-%COMP%]{margin:.5rem;float:left;width:302px}.shapelink-input[_ngcontent-%COMP%]  input{margin:0!important}.shapelink-editor-container.invalid-url[_ngcontent-%COMP%]   .shapelink-input[_ngcontent-%COMP%]  input{border:1px solid #ffb5b5}.shapelink-remove-btn[_ngcontent-%COMP%]{padding-right:.625rem;padding-left:0;margin-bottom:.5rem}.shapelink-edit-btn[_ngcontent-%COMP%], .shapelink-remove-btn[_ngcontent-%COMP%]{background:transparent}.nu-icon[_ngcontent-%COMP%]:hover{color:#0c5e96}"],changeDetection:0}),t}(),st=n("XfZi"),ct=n("iRGy"),lt=n("Lk+x"),ut=n("BL7/"),pt=n("IOVY"),dt=n("xpZS"),ht=n("rKAp"),gt=n("sXdR"),ft=n("4e/d"),bt=n("Ohay"),mt=n("0Woy"),vt=n("kuMc"),yt=n("BwBJ"),St=n("cJ9h"),Ot=n("jIqt"),xt=n("jOdJ"),Ct=n("CsoK"),Tt=n("mWib"),jt=n("Wg7D"),Pt=n("yn08"),wt=n("Wpmq"),Mt=n("LLEj"),It=n("7zx0"),Et=function(){function t(){this.collisionCanvas=document.createElement("canvas"),this.collisionCtx=this.collisionCanvas.getContext("2d"),this.collisionCtx.save()}return t.prototype.getColliding=function(t,e){var n=this;return t.filter((function(t){return n.doesCollide(t,e)}))},t.prototype.doesCollide=function(t,e){var n=this.intersection(t,e);if(!this.isValidRect(n))return!1;n.pad(1,1,1,1);var i=this.getHitPoints(t),a=this.getHitPoints(e);if(i||a){var r=void 0,o=void 0;return i&&a?i.length>a.length?(r=t,o=a):(r=e,o=i):i?(r=e,o=i):(r=t,o=a),this.isPointColliding(this.pointsToRectangle(n,o),this.getImageData(n,r))}return!1},t.prototype.doesBoxCollide=function(t,e){var n=this.intersection(t,e);return this.isValidRect(n)},t.prototype.intersection=function(t,e){var n=t.hitArea||t,i=e.hitArea||e,a=this.getGlobalBounds(n,t),r=this.getGlobalBounds(i,e);if(!a||!r)throw new Error("Collision Detection is not possible on shapes that dont have bounds set");return a.intersection(r)},t.prototype.isValidRect=function(t){return!!t&&t.width>0&&t.height>0},t.prototype.pointsToRectangle=function(t,e){return e.filter((function(e){return t.contains(e.x,e.y)})).map((function(e){return{x:e.x-t.x,y:e.y-t.y}}))},t.prototype.isPointColliding=function(t,e){var n=e.data;return!!t.find((function(t){var i=Math.round(t.x),a=Math.round(t.y)*e.width*4+4*i-1;return n[a]>0}))},t.prototype.getImageData=function(t,e){this.collisionCanvas.width=t.width,this.collisionCanvas.height=t.height,this.collisionCtx.restore(),this.collisionCtx.save();var n=e.getConcatenatedMatrix();return n.tx-=t.x,n.ty-=t.y,this.collisionCtx.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),e.draw(this.collisionCtx),this.collisionCtx.getImageData(0,0,t.width,t.height)},t.prototype.getHitPoints=function(t){if(t.getHitPoints){var e=t;return t.getHitPoints().map((function(t){return e.localToGlobal(t.x,t.y)}))}},t.prototype.getGlobalBounds=function(t,e){var n=t.getBounds();if(n){var a=i.jb.fromMatrix(e.getConcatenatedMatrix()),r=a.transform(n.x,n.y),o=a.transform(n.x+n.width,n.y),s=a.transform(n.x,n.y+n.height),c=a.transform(n.x+n.width,n.y+n.height),l=r.min(o).min(s).min(c),u=r.max(o).max(s).max(c);return new ht.Rectangle(l.x,l.y,u.x-l.x,u.y-l.y)}},t}(),Dt=n("j6ZJ"),kt=n("PeB7"),At=n("kUiX"),_t=n("eS84");!function(t){t.over="endpoint-over",t.out="endpoint-out"}(rt||(rt={}));var Lt,Rt=function(t){function e(e,n,i){var a=t.call(this,e,!0,!0)||this;return a.type=e,a.handle=n,a.targetOver=i,a}return Object(u.e)(e,t),e}(ht.Event),Bt=n("wk5G"),Ht=n("S83/"),Ft=n("blAi"),Nt=n("7SLS"),Gt=function(t){function e(n,i,a){var r=t.call(this)||this;return r.gluePointId=n,r.shapeId=i,r.model=a,r.type="defined",r.visibilityAnimationTime=200,r.activationAnimationTime=300,r.expandedRadius=13,r.retractedRadius=6,r.radius=r.retractedRadius,r._active=!1,r.subs=[],r.name=i+e.idSplitter+n,r.prepare(),r}return Object(u.e)(e,t),e.getShapeId=function(t){return t.indexOf(this.idSplitter)>-1?t.split(this.idSplitter)[0]:""},e.getGluePointId=function(t){return t.indexOf(this.idSplitter)>-1?t.split(this.idSplitter)[1]:""},Object.defineProperty(e.prototype,"isActive",{get:function(){return this._active},enumerable:!1,configurable:!0}),e.prototype.getCursor=function(t){return{cursor:"pointer",tail:null,type:"css"}},e.prototype.show=function(){return this.getVisibilityAnimation(.7)},e.prototype.hide=function(){return this.getVisibilityAnimation(0)},e.prototype.expand=function(){return this._active?Object(M.b)():(this._active=!0,this.getActivationAnimation(this.expandedRadius))},e.prototype.retract=function(){return this._active?(this._active=!1,this.getActivationAnimation(this.retractedRadius)):Object(M.b)()},e.prototype.setPosition=function(t){this.x=t.x,this.y=t.y},e.prototype.addSubscription=function(t){this.subs.push(t)},e.prototype.destroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},e.prototype.prepare=function(){this.alpha=0,this.redraw(),this.drawHitArea()},e.prototype.createShape=function(){return new ht.Shape},e.prototype.drawHitArea=function(){if(!this.hitArea){var t=this.createShape();t.graphics.beginFill("white"),t.graphics.drawCircle(0,0,10),t.graphics.endFill(),t.setBounds(-5,-5,10,10),this.hitArea=t}},e.prototype.redraw=function(){this.graphics.clear(),this.graphics.beginFill("#787878"),this.graphics.drawCircle(0,0,this.radius),this.graphics.beginFill("white"),this.graphics.drawCircle(0,0,2),this.graphics.endFill()},e.prototype.getVisibilityAnimation=function(t){var e=this;this.visibilityAnimation&&(this.visibilityAnimation.cancel(),this.visibilityAnimation=void 0);var n=Ht.a.get(this).to({alpha:t},this.visibilityAnimationTime,ht.Ease.sineOut);return this.visibilityAnimation=n,n.changes().pipe(Object(g.a)({complete:function(){e.visibilityAnimation===n&&(e.visibilityAnimation=void 0)}}),Object(Nt.a)(this))},e.prototype.getActivationAnimation=function(t){var e=this;this.activationAnimation&&(this.activationAnimation.cancel(),this.activationAnimation=void 0);var n=Ht.a.get(this).to({radius:t},this.activationAnimationTime,ht.Ease.sineOut);return this.activationAnimation=n,this.activationAnimation.changes().pipe(Object(g.a)({next:function(){return e.redraw()},complete:function(){e.activationAnimation===n&&(e.activationAnimation=void 0)}}),Object(Nt.a)(this))},e.idSplitter="&",e}(ht.Shape),qt=function(t){function e(n,i){var a=t.call(this,e.id,n,i)||this;return a.expandedRadius=18,a}return Object(u.e)(e,t),Object.defineProperty(e,"id",{get:function(){return"SCijFyR8ijq"},enumerable:!1,configurable:!0}),e.createModel=function(){return Object.assign(new Ft.a,{id:this.id,x:.5,y:.5})},e.prototype.getCursor=function(t){return{cursor:"pointer",tail:null,type:"css"}},e.prototype.drawHitArea=function(){this.hitArea||(this.hitArea=this.createShape(),this.hitArea.setBounds(0,0,0,0))},e}(Gt),Vt=function(){function t(t){this.target=t}return t.prototype.change=function(t,e){var n=this.target.getMatrix().transformPoint(t,e);this.target.regX=t,this.target.regY=e,this.target.x=n.x,this.target.y=n.y},t.prototype.reset=function(){var t=this.target.getMatrix();this.target.regX=0,this.target.regY=0,this.target.x=t.tx,this.target.y=t.ty},t.prototype.translateTo=function(t,e){var n=this.target.getMatrix();n.tx=0,n.ty=0;var i=n.transformPoint(this.target.regX,this.target.regY);this.target.x=t-this.target.regX+i.x,this.target.y=e-this.target.regY+i.y},t}(),Ut=n("ZtqW"),zt=function(t){function e(e){var n=t.call(this)||this;return n.name=e.id,n}return Object(u.e)(e,t),e.prototype.getCurrentMatrix=function(){var t=this.getConcatenatedMatrix().clone(),e=this.parent.parent.getConcatenatedMatrix().clone().invert();return i.jb.fromMatrix(t.prependMatrix(e))},e}(ht.Shape),Yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),e.prototype.setTranslation=function(t){var e=this.parent.getTranslation();this.x=t.x-e.x,this.y=t.y-e.y},e.prototype.setDefaultBounds=function(t){this.setBounds(0,0,t.defaultBounds.width,t.defaultBounds.height)},e.prototype.setTransformation=function(t){this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.rotation=t.angle},e.prototype.resetTransformation=function(){this.scaleX=1,this.scaleY=1,this.rotation=0},e}(zt),Xt=n("5vYS"),Kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),e.prototype.getMatrixDiff=function(t){var e=t||this.modelMatrix.clone();return this.updateModelMatrix(),{prev:e,next:this.modelMatrix.clone()}},e.prototype.setDefaultBounds=function(t){var e=t.bounds;this.setBounds(0,0,e.width,e.height),this.updateModelMatrix()},e.prototype.setTranslation=function(t){var e=t.bounds,n=this.parent.getTranslation();this.x=e.x-n.x,this.y=e.y-n.y,this.updateModelMatrix()},e.prototype.setTransformation=function(t){},e.prototype.resetTransformation=function(){},e.prototype.updateModelMatrix=function(){this.modelMatrix=this.getCurrentMatrix()},e}(zt);!function(t){t[t.None=0]="None",t[t.SingleShape=1]="SingleShape",t[t.MultiShape=2]="MultiShape",t[t.Connector=3]="Connector"}(Lt||(Lt={}));var Qt,Wt=function(t){function e(e){var n=t.call(this)||this;return n.commandService=e,n.baseConnectorMatrices={},n.selectedShapes={},n.reg=new Vt(n),n}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"selectedIds",{get:function(){return this.selectedShapes?Object.keys(this.selectedShapes):[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedShapeList",{get:function(){return Object(x.values)(this.selectedShapes)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionCount",{get:function(){return this.selectedIds.length},enumerable:!1,configurable:!0}),e.prototype.cancelInteraction=function(){this.commandService.dispatch(Q.a.resetDiagramPreview)},e.prototype.addChild=function(e){return t.prototype.addChild.call(this,e)},e.prototype.getChildByName=function(e){return t.prototype.getChildByName.call(this,e)},e.prototype.isSelected=function(t){return!!this.selectedShapes[t]},e.prototype.addShape=function(t){if(this.addModel(t),t instanceof Ut.a){var e=new Yt(t);this.addChild(e)}if(t instanceof Xt.a){e=new Kt(t);this.addChild(e),this.cacheConnectorMatrix(t)}},e.prototype.removeShape=function(t){this.removeModel(this.selectedShapes[t]);var e=this.getChildByName(t);this.removeChild(e)},e.prototype.changeShape=function(t){this.addModel(t)},e.prototype.getTranslation=function(){return this.getMatrix().transformPoint(0,0)},e.prototype.destroy=function(){this.removeAllChildren(),this.selectedShapes=void 0},e.prototype.addModel=function(t){this.selectedShapes[t.id]=t},e.prototype.removeModel=function(t){delete this.selectedShapes[t.id]},e.prototype.getShapeMatrices=function(){var t=this,e={};return this.selectedIds.forEach((function(n){if(t.selectedShapes[n]instanceof Ut.a){var i=t.getChildByName(n);e[n]=i.getCurrentMatrix()}})),e},e.prototype.cacheConnectorMatrix=function(t){var e=t.bounds;this.baseConnectorMatrices[t.id]=new i.jb,this.baseConnectorMatrices[t.id].translate(e.x,e.y)},e.prototype.resetCachedConnectorMatrices=function(){var t=this;this.selectedIds.forEach((function(e){var n=t.selectedShapes[e];n instanceof Xt.a&&t.cacheConnectorMatrix(n)}))},e.prototype.getConnectorMatrices=function(t,e){var n=this;void 0===t&&(t=!0),void 0===e&&(e=!1);var i={};return this.selectedIds.forEach((function(a){if(n.selectedShapes[a]instanceof Xt.a){var r=n.getChildByName(a);if(t||e)i[a]=r.getMatrixDiff();else{var o=n.baseConnectorMatrices[a];i[a]=r.getMatrixDiff(o)}}})),i},e}(ht.Container),Zt=n("YJWy"),Jt=function(t){function e(e){var n=t.call(this,e)||this;return n.commandService=e,n.resetPreview(),n}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"selectionType",{get:function(){return Lt.Connector},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedShape",{get:function(){var t=this.selectedShapeList;if(t.length>1)throw new Error("Single connector container should not have mode than 1 connector");var e=t[0];return e?(this.selectedShapeId||(this.selectedShapeId=e.id),e):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectorPath",{get:function(){var t=this.selectedShape;return t?t.getPoints():[]},enumerable:!1,configurable:!0}),e.prototype.getEndPoints=function(){var t=this.connectorPath;return t.length?[t[0],t[t.length-1]].map((function(t){return{id:t.id,position:t}})):[]},e.prototype.getPathPoints=function(){var t=this.connectorPath;return t.length?t.slice(1,t.length-1).map((function(t){return{id:t.id,position:t,movement:null}})):[]},e.prototype.getBreakPoints=function(){return[]},e.prototype.onMove=function(){this.previewData.hasMove=!0},e.prototype.onEndPointMove=function(t,e,n){this.previewData.endPoint=Object(u.a)({},t),e&&(this.previewData.endPoint.shapeId=e,n?(this.previewData.endPoint.gluepointId=n,this.previewData.endPoint.gluepointLocked=!0):(this.previewData.endPoint.gluepointId=null,this.previewData.endPoint.gluepointLocked=!1))},e.prototype.onEndPointDrop=function(t,e,n){this.previewData.endPoint=Object(u.a)({},t),e&&(this.previewData.endPoint.shapeId=e,n?(this.previewData.endPoint.gluepointId=n,this.previewData.endPoint.gluepointLocked=!0):(this.previewData.endPoint.gluepointId=null,this.previewData.endPoint.gluepointLocked=!1))},e.prototype.onPathPointMove=function(t,e){this.previewData.pathPoint=Object(u.a)(Object(u.a)({id:t},e),{pathAdjustedManually:!0})},e.prototype.onPathPointDrop=function(t,e){this.previewData.pathPoint=Object(u.a)(Object(u.a)({id:t},e),{pathAdjustedManually:!0})},e.prototype.onBreakPointMove=function(t,e){},e.prototype.position=function(){var t=this.selectedShape,e=this.getChildByName(t.id);e.setDefaultBounds(t),e.setTranslation(t)},e.prototype.previewInteraction=function(){return Object(D.a)(this.fireTransformConnector(!0),this.fireMoveConnectorEndPoint(!0),this.fireMoveConnectorPathPoint(!0))},e.prototype.completeInteraction=function(t){var e=Object(D.a)(this.fireTransformConnector(!1,t),this.fireMoveConnectorEndPoint(!1),this.fireMoveConnectorPathPoint(!1));return this.resetCachedConnectorMatrices(),e},e.prototype.cancelInteraction=function(){t.prototype.cancelInteraction.call(this),this.resetPreview()},e.prototype.fireTransformConnector=function(t,e){if(!this.previewData.hasMove)return Object(M.b)();delete this.previewData.hasMove;var n=Zt.a.transformShapesAndConnectors,i={connectors:this.getConnectorMatrices(t,e)};return this.fireCommandEvent(n,i,t)},e.prototype.fireMoveConnectorEndPoint=function(t){if(!this.previewData.endPoint||!this.selectedShapeId)return Object(M.b)();var e=Zt.a.moveConnectorEndPointOnViewport,n={id:this.selectedShapeId,points:[this.previewData.endPoint],updateConnections:!t,updateDefinitions:!t};return t?n.points=Object(x.cloneDeep)(n.points):delete this.previewData.endPoint,this.fireCommandEvent(e,n,t)},e.prototype.fireMoveConnectorPathPoint=function(t){if(!this.previewData.pathPoint||!this.selectedShape)return Object(M.b)();var e=Zt.a.moveConnectorPathPointOnViewport,n={id:this.selectedShape.id,points:[this.previewData.pathPoint]};return t?n.points=Object(x.cloneDeep)(n.points):delete this.previewData.pathPoint,this.fireCommandEvent(e,n,t)},e.prototype.fireCommandEvent=function(t,e,n){var i=n?"preview":"dispatch";return this.commandService[i](t,e)},e.prototype.resetPreview=function(){this.previewData={}},e}(Wt),$t=n("qZtG"),te=n("IeS+"),ee=n("2m+3"),ne=function(){function t(t,e,n){this.container=t,this.state=e,this.restriction=n,this.subs=new Map}return Object.defineProperty(t.prototype,"inProgress",{get:function(){return this._inProgress},enumerable:!1,configurable:!0}),t.prototype.register=function(t){var e=this,n=t.getInteractionStart().subscribe((function(t){return e.startHandler(t)})),i=t.getImmediateInteraction().subscribe((function(t){return e.immediateHandler(t)})),a=t.getInteraction().pipe(Object(te.b)((function(t){return e.onHandler(t).pipe(Object(d.a)((function(){return!1})))}))).subscribe(),r=t.getInteractionEnd().subscribe((function(t){return e.endHandler(t)}));this.subs.set(t,[n,i,a,r])},t.prototype.unregister=function(t){var e,n;if(this.subs.has(t)){var i=this.subs.get(t);this.subs.delete(t);try{for(var a=Object(u.k)(i),r=a.next();!r.done;r=a.next()){r.value.unsubscribe()}}catch(o){e={error:o}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}}},t.prototype.destroy=function(){var t,e,n,i;try{for(var a=Object(u.k)(this.subs.values()),r=a.next();!r.done;r=a.next()){var o=r.value;try{for(var s=(n=void 0,Object(u.k)(o)),c=s.next();!c.done;c=s.next()){c.value.unsubscribe()}}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}}catch(p){t={error:p}}finally{try{r&&!r.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}this.subs=new Map},t.prototype.restrictMovement=function(t,e,n,a){if(!e||"free"===e)return a;var r=this.container.selectedShapeList.find((function(e){return e.id===t})).transform,o=i.jb.fromTransform(r).invert().transformPoint(n.x,n.y);switch(e){case"horizontal":o={x:o.x+5,y:o.y};break;case"vertical":o={x:o.x,y:o.y+5};break;case"diagonal-nesw":o={x:o.x-5,y:o.y+5};break;case"diagonal-nwse":o={x:o.x+5,y:o.y+5}}var s=i.jb.fromTransform(r).transformPoint(o.x,o.y),c=new i.fb(n,s).perpendicularTo(a);return{x:c.x,y:c.y}},t.prototype.getCancelInteraction=function(){return Object(X.a)(window,"keydown").pipe(Object(d.a)((function(t){return t.keyCode===C.l.Escape})))},t.prototype.startHandler=function(t){var e=this;this._inProgress=!0,this.cancelInteractionSubscription=this.getCancelInteraction().subscribe((function(){return e.cancelHandler(t)}));var n=t.target;this.interactionStart(t),this.dispatchInteractionEvent(n,Bt.b.interactionStart,t)},t.prototype.immediateHandler=function(t){this.dispatchInteractionEvent(t.handle,Bt.b.interactionStart,t),this.dispatchInteractionEvent(t.handle,Bt.b.interactionImmediate,t),this.interactionImmediate(t),this.dispatchInteractionEvent(t.handle,Bt.b.interactionEnd,t),this.container.completeInteraction(!0,t.handle)},t.prototype.getDirectionByKeycode=function(t){var e=0,n=0;return t===C.l.ArrowUp&&(n=-1),t===C.l.ArrowDown&&(n=1),t===C.l.ArrowLeft&&(e=-1),t===C.l.ArrowRight&&(e=1),{xDirection:e,yDirection:n}},t.prototype.onHandler=function(t){if(!this._inProgress)return Object(M.b)();var e=t.target;return this.interaction(t),this.dispatchInteractionEvent(e,Bt.b.interaction,t),Object($t.a)(this.container.previewInteraction(e),Object(X.a)(ht.Ticker,"tick").pipe(Object(b.a)(1)))},t.prototype.endHandler=function(t){if(this._inProgress){var e=t.target;this.interactionEnd(t),this.dispatchInteractionEvent(e,Bt.b.interactionEnd,t),this.container.completeInteraction(void 0,e),this._inProgress=!1,this.cancelInteractionSubscription.unsubscribe()}},t.prototype.cancelHandler=function(t){if(this._inProgress){var e=t.target;this.interactionCancel(t),this.dispatchInteractionEvent(e,Bt.b.interactionCancel,t),this.container.cancelInteraction(),this._inProgress=!1,this.cancelInteractionSubscription.unsubscribe()}},t.prototype.dispatchInteractionEvent=function(t,e,n){t.dispatchEvent(new Bt.a(e,this.name,t,null,n))},t}(),ie=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"MoveInteraction"},enumerable:!1,configurable:!0}),e.prototype.interactionStart=function(t){var e=void 0!==t.startX?t.startX:t.stageX,n=void 0!==t.startY?t.startY:t.stageY,i=this.restriction.pointOnViewport({x:e,y:n},["GridService"]),a=this.restriction.pointOnViewport({x:this.container.x,y:this.container.y},["GridService"]),r=i.x-a.x,o=i.y-a.y;this.container.reg.change(r,o)},e.prototype.interaction=function(t){var e=this.restriction.pointOnViewport({x:t.stageX,y:t.stageY},["GridService"]),n=e.x,a=e.y;if(this.container instanceof Jt){this.container.reg.translateTo(n,a);var r=(d=this.container.getTransformedBounds()).x-this.container.x,o=d.y-this.container.y,s=this.restriction.pointOnViewport({x:d.x,y:d.y},["SelectionMoveSnap"]);return this.container.reg.translateTo(s.x-r,s.y-o),void this.container.onMove()}this.container.reg.translateTo(n,a);var c=i.jb.fromMatrix(this.container.getMatrix()).decompose(),l=this.container.getTransformedBounds();if(l&&(0===c.angle||0===Math.abs(c.angle%90))){s=this.restriction.pointOnViewport({x:l.x,y:l.y},["SelectionMoveSnap"]);this.container.reg.translateTo(this.container.regX+s.x,this.container.regY+s.y);var u=s.x,p=s.y;if(c.scaleX>0&&-180===c.angle||c.scaleX>0&&180===c.angle||c.scaleX>0&&90===c.angle){var d=this.container.getTransformedBounds();u=s.x+d.width}if(c.scaleY<0&&0===c.angle||c.scaleY>0&&180===c.angle||c.scaleY>0&&-90===c.angle){d=this.container.getTransformedBounds();p=s.y+d.height}u===s.x&&p===s.y||this.container.reg.translateTo(this.container.regX+u,this.container.regY+p)}},e.prototype.interactionImmediate=function(t){var e=ee.a.gridSize*this.state.get("DiagramZoomLevel"),n=this.getDirectionByKeycode(t.keyCode),i=n.xDirection,a=n.yDirection,r=this.container.x+i*e,o=this.container.y+a*e,s=this.restriction.pointOnViewport({x:r,y:o},["GridService"]),c=s.x,l=s.y;this.container.reg.translateTo(c,l),this.interactionEnd(null)},e.prototype.interactionEnd=function(t){this.container.reg.reset(),this.container instanceof Jt&&this.container.onMove()},e.prototype.interactionCancel=function(t){this.container.reg.reset()},e}(ne),ae=function(t){function e(e,n,i){var a=t.call(this,e,n,i)||this;return a.container=e,a.state=n,a.restriction=i,a}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"ConnectorPointInteraction"},enumerable:!1,configurable:!0}),e.prototype.interactionStart=function(t){var e=this.getHandlePosition(t),n=e.x,i=e.y;this.container.reg.change(n,i)},e.prototype.interactionImmediate=function(t){},e.prototype.interactionEnd=function(t){this.container.reg.reset()},e.prototype.interactionCancel=function(t){this.container.reg.reset()},e.prototype.getHandlePosition=function(t){var e=t.target;return{x:e.x,y:e.y}},e.prototype.getPointerPosition=function(t){return{x:t.stageX,y:t.stageY}},e}(ne),re=n("cs9O"),oe=n("9KTM"),se=function(t){function e(e,n,i){var a=t.call(this,e,n,i)||this;return a.container=e,a.restriction=i,a.hoveredOver=[],a.vToDcoordinate=new wt.a(a.state),a.state=n,a}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"EndPointMoveInteraction"},enumerable:!1,configurable:!0}),e.prototype.register=function(e){var n=this;t.prototype.register.call(this,e);var i=e.getEndpointOver().subscribe((function(t){return n.onEndpointOver(t)})),a=e.getEndpointOut().subscribe((function(t){return n.onEndpointOut(t)}));this.subs.set(e,[i,a])},e.prototype.onEndpointOver=function(t){this.hoveredOver.unshift(t.targetOver)},e.prototype.onEndpointOut=function(t){var e=t.targetOver,n=this.hoveredOver.findIndex((function(t){return t.name===e.name}));n>=0&&this.hoveredOver.splice(n,1)},e.prototype.getHoveredTarget=function(t){return this.hoveredOver[0]},e.prototype.interactionStart=function(e){t.prototype.interactionStart.call(this,e)},e.prototype.interaction=function(t){var e=t.target,n=this.getHoveredTarget(e),i=this.getPointerPosition(t),a=i.x,r=i.y,o=this.restriction.pointOnViewport({x:t.stageX,y:t.stageY},["GridService"]).x,s=this.restriction.pointOnViewport({x:t.stageX,y:t.stageY},["GridService"]).y,c=this.restriction.pointOnViewport({x:o,y:s},["SelectionMoveSnap"]),l={};if(l.point={id:e.pointId,x:a,y:r,shapeId:null,gluepointId:null},n instanceof re.a){var p=n.getBounds();this.shouldSnap(p,c)&&(l.point=Object(u.a)(Object(u.a)({},l.point),{x:c.x,y:c.y}))}n instanceof Gt&&(l.shapeId=n.shapeId,l.gluepointId=n.gluePointId),this.container.onEndPointMove(l.point,l.shapeId,l.gluepointId)},e.prototype.interactionEnd=function(e){t.prototype.interactionEnd.call(this,e);var n=e.target,i=this.getHoveredTarget(n),a=this.getPointerPosition(e),r=a.x,o=a.y,s=this.restriction.pointOnViewport({x:e.stageX,y:e.stageY},["GridService"]).x,c=this.restriction.pointOnViewport({x:e.stageX,y:e.stageY},["GridService"]).y,l=this.restriction.pointOnViewport({x:s,y:c},["SelectionMoveSnap"]),u={};if(u.point={id:n.pointId,x:r,y:o,shapeId:null,gluepointId:null,onShape:!1},i instanceof re.a){var p=i.getBounds();u.shapeId=i.name,u.point.shapeId=i.name,u.point.onShape=!0,u.point.position=this.shouldSnap(p,l)?this.positionOnShape(i.children[0],{x:l.x,y:l.y}):this.positionOnShape(i.children[0],{x:r,y:o}),u.point.gluepointId=null}i instanceof Gt&&(u.shapeId=i.shapeId,u.gluepointId=i.gluePointId),this.container.onEndPointDrop(u.point,u.shapeId,u.gluepointId)},e.prototype.shouldSnap=function(t,e){var n=this.vToDcoordinate.x(e.x),i=this.vToDcoordinate.y(e.y);return n>=t.x&&n<=t.x+t.width&&(i===t.y||i===t.y+t.height)||i>=t.y&&i<=t.y+t.height&&(n===t.x||n===t.x+t.width)},e.prototype.positionOnShape=function(t,e){var n=e;return n.x=this.vToDcoordinate.x(n.x),n.y=this.vToDcoordinate.y(n.y),{x:(n.x-t.x)/t._bounds.width,y:(n.y-t.y)/t._bounds.height}},e.\u0275fac=function(t){return new(t||e)(r.qc(Jt),r.qc(i.Mb),r.qc(oe.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e}(ae),ce=n("ljsB"),le=n("deqJ"),ue=n("wOpJ"),pe=n("8a+/");!function(t){t.start="multiselection-start",t.end="multiselection-end",t.drag="multiselection-drag"}(Qt||(Qt={}));var de=function(t){function e(e,n){var i=t.call(this,e,!1,!1)||this;return i.relatedEvent=n,i}return Object(u.e)(e,t),e}(ht.Event),he=n("BQpn"),ge=n("MvFr"),fe=function(t){function e(e,n,i,a){return void 0===i&&(i=!0),void 0===a&&(a=!0),t.call(this,e,n,i,a)||this}return Object(u.e)(e,t),e}(ge.a),be=function(t){function e(e,n,i,a){void 0===i&&(i=!0),void 0===a&&(a=!0);var r=t.call(this,e,n,i,a)||this;return r.setRelatedShape(n),r}return Object(u.e)(e,t),e}(fe),me=function(t){function e(e,n,i,a){return void 0===i&&(i=!0),void 0===a&&(a=!0),t.call(this,e,n,i,a)||this}return Object(u.e)(e,t),e}(fe),ve=function(t){function e(e,n,i,a,r,o,s,c,l,u,p,d,h){var g=t.call(this,e,r,i)||this;return g.commandService=e,g.ll=n,g.state=i,g.contextMenuController=a,g.vToDcoordinate=r,g.dToVcoordinate=o,g.fileReceiver=s,g.postmsg=c,g.shapeBoundsLocator=l,g.viewport=u,g.realtimeStates=p,g.translate=d,g.shapeManage=h,g.pointerInactiveTime=6e4,g.containerHitTestdebounceTime=50,g.pointerThrottle=120,g.endPointMoveThrottleTime=10,g}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"defaultCursor",{get:function(){return{cursor:"default",tail:null,type:"css",viewingArea:"app"}},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,n,a){var r=this,o=t.prototype.initialize.call(this,e,n,a),s=this.getShapePressMoveStart().pipe(Object(g.a)((function(t){r.hideComments(),t.nativeEvent.ctrlKey&&0!==r.state.get("Selected").length||r.selectShape(t),r.cloneAndDragShapes(t)}))),c=this.getShapeDrag().pipe(Object(g.a)((function(t){return r.interactionCanvas.dispatchEvent(t)}))),l=this.getMultiselectionDrag().pipe(Object(g.a)((function(t){return r.interactionCanvas.dispatchEvent(t)}))),u=this.getStageMouseDown(this.gridCanvas).pipe(Object(d.a)((function(){return!r.state.get("EditingText").open})),Object(g.a)((function(t){r.hideComments(),r.selectShapes([])}))),p=this.getSingleClickOnShape().pipe(Object(g.a)((function(t){r.postmsg.sendToParent("shape:touch",{shapeId:t.currentTarget.name}),r.clickOnShape(t),r.handleTextEditor(t),r.selectShape(t,!0)}))),h=this.interactionCanvas.canvas,f=this.getCanvasDrop(h).pipe(Object(g.a)((function(t){return r.onDrop(t)}))),b=Object(X.a)(h,"mousemove").pipe(Object(gt.lodashThrottle)(this.pointerThrottle,{leading:!0,trailing:!0}),Object(g.a)((function(t){if(i.T.get("DEBUG_PHOTON_POINTER_MOVE")){var e=r.vToDcoordinate.x(t.x),n=r.vToDcoordinate.y(t.y),a=JSON.stringify([e,n]);r.realtimeStates.set("pointer",a)}})),Object(gt.lodashThrottle)(this.pointerInactiveTime,{leading:!0,trailing:!1}),Object(g.a)((function(t){r.realtimeStates.set("selected",JSON.stringify(r.state.get("Selected")))})),Object(ft.a)((function(t){return M.a}))),m=this.getDoubleClickOnGrid().pipe(Object(g.a)((function(t){r.addShapeFromMouseEvent(t,{defId:"creately.datasource.lib.sticky",version:"1"},!0)})));return this.contextMenuController.registerEventSource("shape",this.getShapeRightClick()),this.contextMenuController.registerEventSource("stage",this.getStageRightClick(this.gridCanvas)),this.contextMenuController.registerEventSource("interaction",this.getInteractionRightClick(this.interactionCanvas)),Object(D.a)(o,s,c,l,u,p,f,b,m,this.keepSelectionInViewport(),this.multiselectPanInteraction(),this.detectEndPointCollision(),this.shapeSelectionChange(),this.updateSelectionInteractionState(),this.handleAddConnector())},e.prototype.getCursor=function(){var t=this;return Object(D.a)(this.getSelectionInteractionStartEnd(),this.state.changes("Selected")).pipe(Object(f.a)((function(e){return e&&e.type===Qt.start||e&&e.type===Bt.b.interactionStart?Object(I.a)({cursor:"default",tail:null,type:"css",viewingArea:"app"}):t.getCursorByPosition()})),Object(bt.a)((function(t,e){return t.cursor===e.cursor&&t.tail===e.tail})))},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.contextMenuController.unregisterEventSource("shape"),this.contextMenuController.unregisterEventSource("stage"),this.contextMenuController.unregisterEventSource("interaction")},e.prototype.updateSelectionInteractionState=function(){var t=this,e=Object(X.a)(this.interactionCanvas,Bt.b.interactionStart),n=Object(X.a)(this.interactionCanvas,Bt.b.interactionEnd);return Object(D.a)(e.pipe(Object(g.a)((function(){return t.state.set("SelectionInteractionState",Pt.d.Started)}))),n.pipe(Object(g.a)((function(){return t.state.set("SelectionInteractionState",Pt.d.Stopped)}))))},e.prototype.cloneAndDragShapes=function(t){t.nativeEvent&&t.nativeEvent.altKey&&this.commandService.dispatch(Q.a.duplicateShapesAndMove,{onSameLocation:!0})},e.prototype.clickOnShape=function(t){var e=this,n=t.currentTarget.name;return this.ll.forCurrentObserver(!0).pipe(Object(f.a)((function(t){return t.getShapeOnce(n)})),Object(m.a)((function(i){var a;if(i&&"clickOnShape"in i){var r={x:e.vToDcoordinate.x(t.nativeEvent.clientX),y:e.vToDcoordinate.y(t.nativeEvent.clientY)},o=void 0;if(t.target instanceof ue.a||t.target instanceof Dt.a)o=t.target.name;var s={methodName:"clickOnShape",methodParams:[r,t.nativeEvent.shiftKey||t.nativeEvent.ctrlKey||t.nativeEvent.metaKey,o]},c={shapeInfo:(a={},a[n]=s,a)};return e.state.get("EditingText").open?c:(e.commandService.dispatch(Q.a.executeShapeLogicMethod,c),{})}})),Object(f.a)((function(t){return e.state.changes("EditingText").pipe(Object(d.a)((function(t){return!1===t.open})),Object(b.a)(1),Object(g.a)((function(){return e.commandService.dispatch(Q.a.executeShapeLogicMethod,t)})))}))).subscribe()},e.prototype.shapeSelectionChange=function(){var t=this;return this.state.changes("Selected").pipe(Object(mt.a)(),Object(m.a)((function(e){var n=e[0],i=e[1],a=t.state.get("SelectionHistory")||[];t.commandService.dispatch(Q.a.toggleConnectorVisibilitySystem,t.state.get("CurrentDiagram"),{hideConnector:!1,selection:!1}),n.length<2&&!Object(x.isEqual)(n,i)&&(a.push.apply(a,Object(u.j)(i)),a.length>10&&a.shift(),t.state.set("SelectionHistory",a));var r=n.filter((function(t){return!i.includes(t)}));if(t.state.set("Deselected",r),0!==r.length){var o={};r.forEach((function(t){o[t]={methodName:"deselectShape",methodParams:[i]}}));var s={shapeInfo:o};t.commandService.dispatch(Q.a.executeShapeLogicMethod,s)}})))},e.prototype.hideComments=function(){var t=this.state.get("CommentThreadData");t&&t.visible&&this.state.set("CommentThreadData",{visible:!1})},e.prototype.getOnAndSelectedSubContexts=function(t){var e=[],n=t.filter((function(t){return t.parent instanceof le.a})).map((function(t){return t.parent}));return n.forEach((function(t){!e.includes("onConnector")&&t.isConnectorView&&e.push("onConnector"),!e.includes("onShape")&&t.isShapeView&&e.push("onShape")})),n[0]&&this.isSelected(n[0].name)&&(e.push("selected"),this.state.get("Selected").length>1&&e.push("multiSelected")),e},e.prototype.keepSelectionInViewport=function(){var t=this,e=Object(X.a)(this.interactionCanvas,Bt.b.interactionStart),n=Object(X.a)(this.interactionCanvas,Bt.b.interactionEnd);return e.pipe(Object(f.a)((function(){return t.selectionHitsViewport().pipe(Object(vt.a)(n))})),Object(g.a)((function(e){var n=e.dx,i=e.dy;e.name,e.id,e.nativeEvent,e.bounds,e.type;t.dispatchPanCommand(n,i,"auto")})),Object(yt.a)(20),Object(g.a)((function(e){e.dx,e.dy;var n=e.name,i=e.id,a=e.nativeEvent;e.bounds;e.type!==Bt.b.interactionImmediate&&t.dispatchSimulatedInteraction(n,i,a)})))},e.prototype.keepCaretInsideViewport=function(){var t=this;return this.state.changes("TextEditorState-shapeText").pipe(Object(d.a)((function(e){return t.state.get("EditingText").open&&e.selection})),Object(bt.a)((function(t,e){return Object(x.isEqual)(null==t?void 0:t.selection,null==e?void 0:e.selection)})),Object(g.a)((function(e){var n=t.dToVcoordinate.y(e.selection.y)+t.dToVcoordinate.height(e.selection.height),i=t.state.get("DiagramViewPort"),a=0,r=0;n+150>i.bottom&&(a=n+150-i.bottom);var o=t.dToVcoordinate.x(e.selection.x)+t.dToVcoordinate.width(e.selection.width);o+50>i.right&&(r=o+50-i.right),(r||a)&&t.dispatchPanCommand(-r,-a,"auto")})))},e.prototype.multiselectPanInteraction=function(){var t=this,e=Object(X.a)(this.interactionCanvas,Qt.start),n=Object(X.a)(this.interactionCanvas,Qt.end);return e.pipe(Object(f.a)((function(){return t.multiSelectionHitsViewport().pipe(Object(vt.a)(n))})),Object(g.a)((function(e){var n=e.dx,i=e.dy;e.name,e.id,e.nativeEvent,e.bounds,e.type;t.dispatchPanCommand(n,i)})),Object(yt.a)(20),Object(g.a)((function(e){e.dx,e.dy;var n=e.name,i=e.id,a=e.nativeEvent;e.bounds,e.type;t.dispatchSimulatedMultiSelectInt(n,i,a)})))},e.prototype.dispatchPanCommand=function(t,e,n){var a=this;Object(i.Tb)((function(){return a.commandService.dispatch(ce.a.panDiagram,{dy:e,dx:t,animate:!1,type:n})}))},e.prototype.dispatchSimulatedMultiSelectInt=function(t,e,n){var i=this.gridCanvas.getMouseX(),a=this.gridCanvas.getMouseY(),r=new ht.MouseEvent("stagemousemove",!1,!1,i,a,n,null,!0,i,a);r.data={isSimulated:!0};var o=new de(Qt.drag,r);this.interactionCanvas.dispatchEvent(o)},e.prototype.dispatchSimulatedInteraction=function(t,e,n){if("MoveInteraction"===t){var i=this.interactionCanvas.getMouseX(),a=this.interactionCanvas.getMouseY();(o=new ht.MouseEvent("stagemousemove",!1,!1,i,a,n,null,!0,i,a)).data={isSimulated:!0};var r=new be("shapeDragMove",o);r.relatedShape={name:e},this.interactionCanvas.dispatchEvent(r)}else{var o;i=this.interactionCanvas.mouseX,a=this.interactionCanvas.mouseY;(o=new ht.MouseEvent("stagemousemove",!1,!1,i,a,n,null,!0,i,a)).data={isSimulated:!0},this.interactionCanvas.dispatchEvent(o)}},e.prototype.multiSelectionHitsViewport=function(){var t=this;return Object(X.a)(this.interactionCanvas,Qt.drag).pipe(Object(m.a)((function(e){var n=t.interactionCanvas.getMouseX(),a=t.interactionCanvas.getMouseY(),r=new i.zb(n-5,a-5,10,10),o=e.relatedEvent.nativeEvent,s=t.getPanDeltaForMultiSelection(r,1,o),c=s.dx,l=s.dy;if(c||l)return{dx:c,dy:l,name:e.name,nativeEvent:o}})),Object(d.a)((function(t){return!!t})))},e.prototype.selectionHitsViewport=function(){var t=this,e=Object(X.a)(this.interactionCanvas,Bt.b.interaction).pipe(Object(m.a)((function(e){var n=t.getDataFromInteractionEvent(e),a=t.interactionCanvas.getMouseX(),r=t.interactionCanvas.getMouseY(),o=new i.zb(a-5,r-5,10,10);return n.bounds=o,n})),Object(mt.a)(),Object(m.a)((function(e){var n=Object(u.h)(e,2),i=n[0],a=n[1];if(!a.isUserInteraction||JSON.stringify(i)!==JSON.stringify(a)){var r=t.getPanDelta(a.bounds,2),o=r.dx,s=r.dy;if(a.isUserInteraction){var c=t.isMovingOutside(i.bounds,a.bounds),l=c.x;s=c.y?s:0,o=l?o:0}return o||s?{dx:o,dy:s,name:a.name,id:a.id,nativeEvent:a.nativeEvent}:void 0}})),Object(d.a)((function(t){return!!t}))),n=Object(X.a)(this.interactionCanvas,Bt.b.interactionImmediate).pipe(Object(m.a)((function(e){var n=t.getDataFromInteractionEvent(e),a=n.id,r=n.nativeEvent,o=n.isUserInteraction,s=n.type,c=e.target.getTransformedBounds(),l=new i.zb(c.x,c.y,c.width,c.height),u=t.getPanDelta(l,10),p=u.dx,d=u.dy;if(o){var h=t.isMovingOutsideForKeys(e.relatedEvent.keyCode,l),g=h.x;d=h.y?d:0,p=g?p:0}if(p||d)return{dx:p,dy:d,name:name,id:a,isUserInteraction:o,nativeEvent:r,bounds:l,type:s}})),Object(d.a)((function(t){return!!t})));return Object(D.a)(e,n)},e.prototype.getPanDelta=function(t,e){var n=this.state.get("DiagramViewPort"),i=t.y<n.top+10?e:0;i=t.bottom>n.bottom-10?-e:i;var a=t.x<n.left+10?e:0;return{dx:a=t.right>n.right-10?-e:a,dy:i}},e.prototype.getPanDeltaForMultiSelection=function(t,e,n){var i=0,a=0,r=this.state.get("DiagramViewPort");return n.movementY>0&&n.y>r.centerY&&(i=t.bottom>r.bottom-10?-e:0),n.movementY<0&&n.y<r.centerY&&(i=t.y<r.top+10?e:0),n.movementX>0&&n.x>r.centerX&&(a=t.right>r.right-10?-e:0),n.movementX<0&&n.x<r.centerX&&(a=t.x<r.left+10?e:0),{dx:a,dy:i}},e.prototype.isMovingOutside=function(t,e){var n=this.state.get("DiagramViewPort");return{x:Math.abs(n.centerX-t.centerX)<Math.abs(n.centerX-e.centerX),y:Math.abs(n.centerY-t.centerY)<Math.abs(n.centerY-e.centerY)}},e.prototype.isMovingOutsideForKeys=function(t,e){var n=this.state.get("DiagramViewPort");return t===C.l.ArrowUp?{x:!1,y:n.centerY>e.centerY}:t===C.l.ArrowDown?{x:!1,y:n.centerY<e.centerY}:t===C.l.ArrowLeft?{x:n.centerX>e.centerX,y:!1}:t===C.l.ArrowRight?{x:n.centerX<e.centerX,y:!1}:void 0},e.prototype.getDoubleClickOnShape=function(){var t=this;return this.getShapes().pipe(Object(St.a)((function(e){return Object(X.a)(e,"dblclick").pipe(Object(vt.a)(Object(X.a)(t.diagramCanvas,"childRemoved").pipe(Object(d.a)((function(t){return t.child===e})))))})),Object(m.a)((function(t){return t})))},e.prototype.getDoubleClickOnGrid=function(){return Object(X.a)(this.gridCanvas,"dblclick")},e.prototype.getSingleClickOnShape=function(){var t=this;return this.getShapes().pipe(Object(St.a)((function(e){return Object(X.a)(e,"mousedown").pipe(Object(f.a)((function(){return Object(X.a)(e,"pressup").pipe(Object(vt.a)(Object(X.a)(e,"pressmove")))})),Object(vt.a)(Object(X.a)(t.diagramCanvas,"childRemoved").pipe(Object(d.a)((function(t){return t.child===e})))))})),Object(m.a)((function(t){return t})))},e.prototype.getShapePressMoveStart=function(){var t=this;return this.getShapes().pipe(Object(St.a)((function(e){return Object(X.a)(e,"mousedown").pipe(Object(d.a)((function(t){return 0===t.nativeEvent.button})),Object(f.a)((function(){return Object(X.a)(e,"pressmove").pipe(Object(b.a)(1))})),Object(vt.a)(Object(X.a)(t.diagramCanvas,"childRemoved").pipe(Object(d.a)((function(t){return t.child===e})))))})),Object(m.a)((function(t){return t})))},e.prototype.handleTextEditor=function(t){var e=this;if(2!==t.nativeEvent.button&&!this.state.get("PlusCreateState").inProgress){var n,i,a={x:t.localX,y:t.localY};if(t.target instanceof ue.a||t.target instanceof Dt.a){var r=t.target;n=r.name,i=r.parent.name,this.state.get("Selected").includes(i)&&this.ll.forCurrent(!0).getShapeOnce(i).pipe(Object(g.a)((function(r){var o=e.state.get("InnerShapeSelection")[i],s=o&&o.includes(n),c=s&&(t.nativeEvent.shiftKey||t.nativeEvent.ctrlKey||t.nativeEvent.metaKey);r&&r.disableOpenTextOnShapeClick&&(!s||c)||(r.texts[n]&&r.texts[n].editableTextId&&(n=r.texts[n].editableTextId),e.openTextEditor(i,n,a))}))).subscribe()}else i=t.target.name,this.state.get("Selected").includes(i)&&this.ll.forCurrent(!0).getShapeOnce(i).pipe(Object(g.a)((function(t){t&&t.disableOpenTextOnShapeClick||e.openTextEditor(i,n,a)}))).subscribe()}},e.prototype.openTextEditor=function(t,e,n){var a=this.state.get("EditingText");!0===a.open&&(a.open=!1,this.commandService.dispatch(Q.a.closeTextEditor,a)),i.Ob.track("canvas.text.doubleclick.change"),this.commandService.dispatch(Q.a.openTextEditor,{open:!0,textId:e,point:n,shapeId:t})},e.prototype.getShapeDrag=function(){var t=this,e=Object(X.a)(this.interactionCanvas,"stagemouseup").pipe(Object(b.a)(1));return this.getShapes().pipe(Object(St.a)((function(n){return Object(X.a)(n,"mousedown").pipe(Object(d.a)((function(t){return 0===t.nativeEvent.button})),Object(m.a)((function(t){return{startX:t.stageX,startY:t.stageY}})),Object(f.a)((function(t){return Object(X.a)(n,"pressmove").pipe(Object(b.a)(1),Object(g.a)((function(e){e.startX=t.startX,e.startY=t.startY})))})),Object(f.a)((function(n){return Object(D.a)(Object(X.a)(t.interactionCanvas,"stagemousemove").pipe(Object(d.a)((function(t){return!(t.nativeEvent&&t.nativeEvent.altKey)})),Object(vt.a)(e)),e).pipe(Object(m.a)((function(t){var e="stagemousemove"===t.type?"shapeDragMove":"shapeDragEnd",i=new be(e,n);return i.startX=n.startX,i.startY=n.startY,i.relatedMouseEvent=t,i})))})),Object(vt.a)(Object(X.a)(t.diagramCanvas,"childRemoved").pipe(Object(d.a)((function(t){return t.child===n})))))})))},e.prototype.selectShape=function(t,e){var n=this;void 0===e&&(e=!1),this.ll.forCurrent(!0).getShapeOnce(t.currentTarget.name).pipe(Object(m.a)((function(i){if(!i.containerLocked||e){var a=t.nativeEvent.metaKey||t.nativeEvent.shiftKey||t.nativeEvent.ctrlKey;n.selectShapes([t.currentTarget.name],a,t.nativeEvent.button)}}))).subscribe()},e.prototype.selectShapes=function(t,e,n){void 0===n&&(n=0),2!==n&&this.commandService.dispatch(O.a.selectShapes,this.state.get("CurrentDiagram"),{shapeIds:t,add:e})},e.prototype.getCanvasDrag=function(t){var e=Object(X.a)(t,"mousedown").pipe(Object(m.a)((function(t){return new me("stageDragStart",t)}))),n=Object(X.a)(t,"pressup").pipe(Object(m.a)((function(t){return new me("stageDragEnd",t)}))),i=Object(X.a)(t,"pressmove").pipe(Object(m.a)((function(t){return new me("stageDragMove",t)})));return e.pipe(Object(f.a)((function(t){return Object(D.a)(i.pipe(Object(Ot.a)(t),Object(vt.a)(n)),i.pipe(Object(xt.a)(),Object(Ct.a)(n)))})))},e.prototype.getMultiselectionDrag=function(){var t=this,e=Object(X.a)(this.gridCanvas,"mousedown").pipe(Object(m.a)((function(t){return new de(Qt.start,t)}))),n=Object(X.a)(this.diagramCanvas,"mousedown").pipe(Object(f.a)((function(e){return t.ll.forCurrent(!0).getShapeOnce(e.target.name).pipe(Object(m.a)((function(n){if(!t.state.get("Selected").includes(e.target.name)&&n&&n.containerLocked)return new de(Qt.start,e)})),Object(d.a)((function(t){return!!t})))}))),i=Object(D.a)(n,e),a=Object(D.a)(Object(X.a)(this.diagramCanvas,"pressup").pipe(Object(m.a)((function(t){return new de(Qt.end,t)}))),Object(X.a)(this.gridCanvas,"pressup").pipe(Object(m.a)((function(t){return new de(Qt.end,t)})))),r=Object(D.a)(Object(X.a)(this.diagramCanvas,"pressmove").pipe(Object(m.a)((function(t){return new de(Qt.drag,t)}))),Object(X.a)(this.gridCanvas,"pressmove").pipe(Object(m.a)((function(t){return new de(Qt.drag,t)}))));return i.pipe(Object(f.a)((function(t){return Object(D.a)(r.pipe(Object(Ot.a)(t),Object(vt.a)(a)),r.pipe(Object(xt.a)(),Object(Ct.a)(a)))})))},e.prototype.getCanvasDrop=function(t){var e=Object(X.a)(t,"dragenter").pipe(Object(g.a)((function(t){return t.preventDefault()}))),n=Object(X.a)(t,"dragover").pipe(Object(g.a)((function(t){return t.preventDefault()}))),i=Object(X.a)(t,"drop").pipe(Object(g.a)((function(t){return t.preventDefault()})));return e.pipe(Object(Ct.a)(Object(D.a)(n.pipe(Object(d.a)((function(){return!1}))),i.pipe(Object(b.a)(1)))))},e.prototype.onDrop=function(t){var e=t.dataTransfer;e.getData("Text")?this.onTextDrop(t):e.getData("PreDifQueries")?this.onQueryDrop(t):e.getData("URLData")?this.onUrlDrop(t):e.files&&e.files.length>0&&this.onFileDrop(t,!0)},e.prototype.onQueryDrop=function(t){var e=t.dataTransfer.getData("PreDifQueries"),n={};try{n=JSON.parse(e)}catch(i){return}this.addPreDefQueryShapes(n,t.offsetX,t.offsetY)},e.prototype.onTextDrop=function(t){var e,n=t.dataTransfer.getData("Text"),a=t.dataTransfer.getData("TrackingInfo");try{e=JSON.parse(n)}catch(u){return}var r={value1Type:"defId",value1:e.defId};try{var o=JSON.parse(a);o.library&&(r.value2Type="library",r.value2=o.library),o.location&&(r.value3Type="location",r.value3=o.location)}catch(u){}if(i.Ob.track("left.library.shape.drop",r),"template"===e.type)this.shapeManage.addTemplate(e,t.offsetX,t.offsetY);else{var s=void 0;if(e.sidebarEntity){var c=e.sidebarEntity.id,l=e.sidebarEntity.edefId;s=Object.assign(new j.a(c,l),e.sidebarEntity)}this.shapeManage.addShape(e,t.offsetX,t.offsetY,s).subscribe()}},e.prototype.onFileDrop=function(t,e){var n=t.dataTransfer.files;if(n&&!(n.length<1)){for(var i=[],a=0;a<n.length;a++){var r=new kt.b(n[a]);r.importType=kt.a.DragAndDrop,i.push(r)}var o={position:{x:this.vToDcoordinate.x(t.offsetX),y:this.vToDcoordinate.y(t.offsetY)},upload:e};this.fileReceiver.receiveFiles(i,o).subscribe()}},e.prototype.onUrlDrop=function(t){var e,n=t.dataTransfer.getData("URLData");try{e=JSON.parse(n)}catch(a){return}var i=this.shapeManage.addURLData(e,t.offsetX,t.offsetY).subscribe();this.subs.push(i)},e.prototype.addPreDefQueryShapes=function(t,e,n){var a=this,r={};Object.values(t).forEach((function(t){var o=i.wb.shapeId();r[o]={id:o,defId:t.defId,version:t.version,x:a.vToDcoordinate.x(e)+20,y:a.vToDcoordinate.y(n)+20,eData:t.eData,data:t.data,dataSource:t.dataSource,triggerNewEData:t.triggerNewEData,type:t.type,entityDefId:t.entityDefId,texts:t.texts}})),this.commandService.dispatch(Q.a.addPredefinedQueryShapes,{shapes:r}).pipe(Object(v.a)(),Object(f.a)((function(t){var e=t.resultData[2];return a.commandService.dispatch(Q.a.changeContainerData,e)}))).subscribe()},e.prototype.detectEndPointCollision=function(){var t=this;return Object(X.a)(this.interactionCanvas,Bt.b.interactionStart).pipe(Object(d.a)((function(t){return t.interactionName===se.prototype.name})),Object(g.a)((function(e){return t.handleEndPointMoveStart(e)})),Object(f.a)((function(){return Object(X.a)(t.interactionCanvas,Bt.b.interaction).pipe(Object(d.a)((function(t){return t.interactionName===se.prototype.name})),Object(Tt.a)(t.endPointMoveThrottleTime),Object(g.a)((function(e){return t.handleEndPointMove(e)})),Object(vt.a)(Object(D.a)(Object(X.a)(t.interactionCanvas,Bt.b.interactionEnd),Object(X.a)(t.interactionCanvas,Bt.b.interactionCancel)).pipe(Object(d.a)((function(t){return t.interactionName===se.prototype.name})),Object(g.a)((function(e){return t.handleEndPointMoveEnd(e)})))))})))},e.prototype.handleEndPointMoveStart=function(t){this.endPointCollision=new Et,this.endPointCollisionChildren=this.diagramCanvas.children.filter((function(t){return t.isShapeView}))},e.prototype.handleEndPointMove=function(t){var e,n=this.createFilterByMousePosition(t),i=((this.interactionCanvas.children.find((function(t){return"GluePointHandler"===t.name}))||{}).children||[]).filter((function(t){return t instanceof Gt&&n(t)}));if(i.length>0&&(e=this.endPointCollision.getColliding(i,t.handle))&&e.length>0){var a=e[e.length-1];this.fireEndPointHoverEvent(t.handle,a)}else if((e=this.endPointCollision.getColliding(this.endPointCollisionChildren,t.handle))&&e.length>0){a=e[e.length-1];this.fireEndPointHoverEvent(t.handle,a)}else this.fireEndPointHoverEvent(t.handle)},e.prototype.fireEndPointHoverEvent=function(t,e){if(this.endPointOverShape!==e){var n=this.endPointOverShape;e?(this.endPointOverShape=e,this.dispatchEndPointHoverEvent(rt.over,t,e)):this.endPointOverShape=void 0,n&&this.dispatchEndPointHoverEvent(rt.out,t,n)}},e.prototype.dispatchEndPointHoverEvent=function(t,e,n){n.stage===this.interactionCanvas?n.dispatchEvent(new Rt(t,e,n)):this.interactionCanvas.dispatchEvent(new Rt(t,e,n))},e.prototype.handleEndPointMoveEnd=function(t){this.endPointOverShape&&this.fireEndPointHoverEvent(t.handle),this.endPointOverShape=void 0,this.endPointCollision=void 0,this.endPointCollisionChildren=void 0},e.prototype.handleAddConnector=function(){var t=this;return this.state.changes("ConnectorAdded").pipe(Object(K.a)(1),Object(f.a)((function(e){return Object(X.a)(t.interactionCanvas,Bt.b.interactionStart).pipe(Object(d.a)((function(t){return t.interactionName===se.prototype.name})),Object(f.a)((function(){return Object(D.a)(Object(X.a)(t.interactionCanvas,Bt.b.interactionEnd),Object(X.a)(t.interactionCanvas,Bt.b.interactionCancel))})),Object(xt.a)(),Object(m.a)((function(){return e})))})),Object(yt.a)(10),Object(g.a)((function(e){return t.commandService.dispatch(Q.a.adjustConnector,{connectorId:e})})))},e.prototype.addShapeFromMouseEvent=function(t,e,n){var i=this;if(void 0===n&&(n=!1),null==t?void 0:t.nativeEvent){var a=t.nativeEvent.clientX-C.z,r=t.nativeEvent.clientY-20;this.shapeManage.addShape(e,a,r).pipe(Object(g.a)((function(t){n&&(i.selectShapes([t.id]),i.openTextEditor(t.id))}))).subscribe()}},e.prototype.getSelectionInteractionStartEnd=function(){return Object(D.a)(Object(X.a)(this.gridCanvas,Bt.b.interactionStart),Object(X.a)(this.gridCanvas,Bt.b.interactionEnd),Object(X.a)(this.gridCanvas,Qt.start),Object(X.a)(this.gridCanvas,Qt.end))},e.prototype.getCursorByPosition=function(){var t=this,e=this.state.changes("Selected");return Object(D.a)(e.pipe(Object(m.a)((function(){return{x:t.interactionCanvas.getMouseX(),y:t.interactionCanvas.getMouseY()}}))),this.pointerMove()).pipe(Object(jt.a)(100),Object(m.a)((function(e){var n=["editor","normal"],i=t.getObjectsUnderPoint(e);return n.push.apply(n,Object(u.j)(t.getOnAndSelectedSubContexts(i))),t.getCursorByContext(i,n)})))},e.prototype.isSelected=function(t){return this.state.get("Selected").findIndex((function(e){return e===t}))>-1},e.prototype.getDataFromInteractionEvent=function(t){var e=t.target,n=null;"MoveInteraction"===t.interactionName&&(n=e.selectedIds[0]);var i=t.relatedEvent.nativeEvent,a=!t.relatedEvent.data||!t.relatedEvent.data.isSimulated;return{id:n,name:t.interactionName,type:t.type,nativeEvent:i,isUserInteraction:a}},e.prototype.createFilterByMousePosition=function(t){var e=t.relatedEvent,n=e.stageX,a=e.stageY,r=new i.qb(n,a),o=t.handle.getBounds().width/2;return function(t){return r.distanceTo(t)<o+t.radius}},e.\u0275fac=function(t){return new(t||e)(r.qc(i.B),r.qc(q.a),r.qc(i.Mb),r.qc(he.a),r.qc(wt.a),r.qc(G.a),r.qc(At.a),r.qc(i.tb),r.qc(pe.a),r.qc(V.a),r.qc(It.b),r.qc(o.e),r.qc(_t.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e}(Mt.a);Object.defineProperty(ve,"name",{value:"EditorInteractionHandler"});var ye=n("C+in"),Se=n("ZTXN"),Oe=function(t){function e(e,n,i,a){void 0===i&&(i=!0),void 0===a&&(a=!0);var r=t.call(this,e,n,i,a)||this;return r.setRelatedShape(n),r}return Object(u.e)(e,t),e}(ge.a),xe=function(t){function e(e,n,i,a,r){var o=t.call(this,e,r,a)||this;return o.commandService=e,o.ll=n,o.random=i,o.state=a,o.vToDcoordinate=r,o._shapes={},o.addSource=new Se.a,o.changeSource=new Se.a,o}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"defaultCursor",{get:function(){return{cursor:"crosshair",tail:null,type:"css"}},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,n,i){var a=this,r=t.prototype.initialize.call(this,e,n,i),o=this.getShapeOver().pipe(Object(g.a)((function(t){return a.shapeOver(t)}))),s=this.getAllCanvasMouseCapture().pipe(Object(g.a)((function(t){return t.stopPropagation()})),Object(d.a)((function(t){return"mousedown"===t.type})),Object(g.a)((function(t){a.commandService.dispatch(O.a.changeMouseControlState,{state:Pt.b.Normal}),a.createConnector(t).subscribe()})));return Object(D.a)(r,s,o)},e.prototype.getCursor=function(){var t=this;return this.pointerMove().pipe(Object(Ot.a)({x:this.interactionCanvas.getMouseX(),y:this.interactionCanvas.getMouseY()}),Object(m.a)((function(e){var n=t.getObjectsUnderPoint(e).filter((function(t){return t.parent instanceof re.a||t instanceof Gt}));return t.getCursorByContext(n,["editor","createConnector"])})),Object(bt.a)((function(t,e){return t.cursor===e.cursor&&t.tail===e.tail})))},e.prototype.createConnector=function(t){var e=t.nativeEvent,n=e.offsetX,i=e.offsetY,a=this.random.shapeId();return this.addConnector(a,{x:n,y:i},t.target)},e.prototype.addConnector=function(t,e,n){var i,a=this,r=this.state.get("MouseControlState"),o={id:t,points:[Object(u.a)({},e),Object(u.a)({},e)]};r===Pt.b.Line&&(o.entryClass="connectors.bundle.js#ConnectorStraight");var s=o.points[0];return(n&&this.isValidTarget(n)?this.ll.forCurrent(!1).getShapeOnce(null===(i=null==n?void 0:n.parent)||void 0===i?void 0:i.name).pipe(Object(g.a)((function(t){if(n instanceof Gt)s.shapeId=n.shapeId,s.gluepointId=n.gluePointId,s.gluepointLocked=!0,delete o.entryClass;else if(n&&t){var i=a.positionOnShape(t,e);s.shapeId=t.id,s.onShape=!0,s.position=i}})),Object(Nt.a)(o)):Object(I.a)(o)).pipe(Object(f.a)((function(e){return a.commandService.dispatch(Q.a.addConnector,e).pipe(Object(xt.a)(),Object(g.a)((function(){a.state.set("ConnectorAdded",t)})))})))},e.prototype.getShapeOver=function(){var t=this;return this.getShapes().pipe(Object(St.a)((function(e){return Object(D.a)(Object(X.a)(e,"rollover"),Object(X.a)(e,"rollout")).pipe(Object(vt.a)(Object(X.a)(t.diagramCanvas,"childRemoved").pipe(Object(d.a)((function(t){return t.child===e})))))})),Object(m.a)((function(t){return t})))},e.prototype.shapeOver=function(t){var e="rollover"===t.type?"shapeRollOver":"shapeRollOut";this.interactionCanvas.dispatchEvent(new Oe(e,t))},e.prototype.positionOnShape=function(t,e){var n=e;n.x=this.vToDcoordinate.x(n.x),n.y=this.vToDcoordinate.y(n.y);var i=t.getPositionOnShape(n,5);return i={x:i.x.value,y:i.y.value}},e.prototype.isValidTarget=function(t){return t instanceof Gt||t.parent instanceof re.a},e.\u0275fac=function(t){return new(t||e)(r.qc(i.B),r.qc(q.a),r.qc(i.wb),r.qc(i.Mb),r.qc(wt.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e}(Mt.a);Object.defineProperty(xe,"name",{value:"ConnectorInteractionHandler"});var Ce=n("nIj0"),Te=function(){function t(t,e,n){this.defLocator=t,this.el=e,this.ll=n,this.subs=[]}return t.prototype.handleDragStart=function(t){var e=this,n=this.ll.forCurrentObserver(!1).pipe(Object(b.a)(1),Object(f.a)((function(t){return t.getDiagramEData().pipe(Object(f.a)((function(t){if(!t)return Object(I.a)([]);var n=[];return t.forEach((function(t){var i=e.el.getEData(t).pipe(Object(f.a)((function(t){return t.getEDataModelOnce()})));n.push(i)})),D.a.apply(void 0,Object(u.j)(n))})))}))).subscribe(),i=this.el.currentEDataModels().pipe(Object(b.a)(1),Object(f.a)((function(n){var i,a=(n||[]).find((function(t){return t.defId===e.eDefId})),r=e.getDataSource();return a&&a.entities&&(i=Object.keys(a.entities).map((function(t){return a.entities[t]})).find((function(t){return Object(x.isEqual)(t.dataSource,r)}))),e.defLocator.getDefinition(e.defId,e.version).pipe(Object(b.a)(1),Object(g.a)((function(n){var o;(n=Object(x.cloneDeep)(n)).name=e.data.title,n.triggerNewEData=!0,(n&&!n.data||Object(x.isEmpty)(n.data))&&(n.data={}),Object.assign(n.data,n.dataDef),n.data.number.value=e.data.dataSourceId.toString(),n.data.title.value=e.data.title.toString(),n.data.description.value=e.data.description,n.data.tags.value=e.data.tags.filter((function(t){return null!==t.name})),n.data.people.value={source:e.data.people.source,people:e.data.people.people.filter((function(t){return null!==t.fullName&&null!==t.id}))},n.data.commentCount.value=0,n.dataSource=r,i&&(n.eData=((o={})[a.id]=i.id,o)),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("Text",JSON.stringify(n))})))}))).subscribe();this.subs.push(n),this.subs.push(i)},t.prototype.ngOnDestroy=function(){this.subs.forEach((function(t){t.unsubscribe()})),this.subs=[]},t.prototype.getDataSource=function(){return this.data.dataSource.data.dataSourceId=this.data.dataSourceId,this.data.dataSource},t.\u0275fac=function(e){return new(e||t)(r.gc(R.a),r.gc(y.a),r.gc(q.a))},t.\u0275cmp=r.ac({type:t,selectors:[["data-source-card-item"]],inputs:{data:"data",eDefId:"eDefId",defId:"defId",version:"version"},decls:2,vars:2,consts:[["draggable","true",1,"data-source-card",3,"dragstart"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.uc("dragstart",(function(t){return e.handleDragStart(t)})),r.fd(1),r.lc()),2&t&&(r.Sb(1),r.id(" ",null==e.data?null:e.data.dataSourceId," ",null==e.data?null:e.data.title," "))},styles:["[_nghost-%COMP%]{margin:7px 0;display:inline-block}.data-source-card[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;padding:8px 12px;background:#fff;border:1px solid rgba(202,204,206,.5);box-sizing:border-box;border-radius:4px}.data-source-card[_ngcontent-%COMP%]:hover{background:#f0f0f0;border:1px solid #fff;transition-duration:.4s;cursor:pointer}"],changeDetection:0}),t}(),je=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.defId="creately.card.datasource",e.version=1,e}return Object(u.e)(e,t),e}(z.k),Pe=n("qlkn"),we=n("P4Xx"),Me=n("HsO4"),Ie=n("Wwqo"),Ee=n("HM3f"),De=function(){function t(t,e,n){this.defLocator=t,this.el=e,this.ll=n,this.subs=[]}return t.prototype.handleDragStart=function(t){var e=this,n=this.ll.forCurrentObserver(!1).pipe(Object(b.a)(1),Object(f.a)((function(t){return t.getDiagramEData().pipe(Object(f.a)((function(t){if(!t)return Object(I.a)([]);var n=[];return t.forEach((function(t){var i=e.el.getEData(t).pipe(Object(f.a)((function(t){return t.getEDataModelOnce()})));n.push(i)})),D.a.apply(void 0,Object(u.j)(n))})))}))).subscribe(),i=Object(Ee.b)(this.el.currentEDataModelsOnce(),this.defLocator.getDefinition(this.defId,this.version)).pipe(Object(b.a)(1),Object(g.a)((function(n){var i=Object(u.h)(n,2),a=i[0],r=i[1],o=(a||[]).find((function(t){return t.defId===e.eDefId})),s=o&&o.entities?Object.keys(o.entities).map((function(t){return o.entities[t]})):null,c={};e.data.forEach((function(t){var n,i,a=e.getDataSource(t.dataSourceId);o&&o.entities&&s&&(i=s.find((function(t){return Object(x.isEqual)(t.dataSource,a)})));var l=Object(x.cloneDeep)(r);l.name=t.title,l.triggerNewEData=!0,l.data={},Object.assign(l.data,l.dataDef),l.data.number.value=t.dataSourceId.toString(),l.data.title.value=t.title.toString(),l.data.description.value=t.description,l.data.tags.value=t.tags.filter((function(t){return null!==t.name})),l.data.people.value={source:t.people.source,people:t.people.people.filter((function(t){return null!==t.fullName&&null!==t.id}))},l.data.commentCount.value=0,l.dataSource=a,i&&(l.eData=((n={})[o.id]=i.id,n)),c[t.dataSourceId]=l})),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("PreDifQueries",JSON.stringify(c))}))).subscribe();this.subs.push(n),this.subs.push(i)},t.prototype.ngOnDestroy=function(){this.subs.forEach((function(t){t.unsubscribe()})),this.subs=[]},t.prototype.getDataSource=function(t){var e=Object(x.cloneDeep)(this.dataSource);return e.data.dataSourceId=t,e},t.\u0275fac=function(e){return new(e||t)(r.gc(R.a),r.gc(y.a),r.gc(q.a))},t.\u0275cmp=r.ac({type:t,selectors:[["data-source-card-item"]],inputs:{data:"data",eDefId:"eDefId",dataSource:"dataSource",defId:"defId",version:"version"},decls:2,vars:1,consts:[["draggable","true",1,"data-source-card",3,"dragstart"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.uc("dragstart",(function(t){return e.handleDragStart(t)})),r.fd(1),r.lc()),2&t&&(r.Sb(1),r.hd(" Fetched results ( ",e.data.length," ) "))},styles:["[_nghost-%COMP%]{margin:7px 0;display:inline-block}.data-source-card[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;padding:8px 12px;background:#fff;border:1px solid rgba(202,204,206,.5);box-sizing:border-box;border-radius:4px}.data-source-card[_ngcontent-%COMP%]:hover{background:#f0f0f0;border:1px solid #fff;transition-duration:.4s;cursor:pointer}"],changeDetection:0}),t}(),ke=n("8PfW"),Ae=n("bV32"),_e=n("xEGh"),Le=n("3Uyd"),Re=n("bFHC"),Be=n("29Wa"),He=n("Cd2c"),Fe=n("ulve"),Ne=n("mFH5"),Ge=["listContainer"];function qe(t,e){1&t&&(r.mc(0,"div",7),r.hc(1,"loading-bubbles",8),r.lc())}function Ve(t,e){if(1&t){var n=r.nc();r.mc(0,"div",9),r.mc(1,"div",10),r.fd(2," DATA_SOURCE.GITHUB.MAIN_DESC "),r.lc(),r.mc(3,"div",11),r.mc(4,"span",12),r.fd(5,"DATA_SOURCE.GITHUB.AUTH_DESC"),r.lc(),r.hc(6,"br"),r.mc(7,"span",12),r.fd(8,"DATA_SOURCE.GITHUB.TO_CONNECT"),r.lc(),r.lc(),r.mc(9,"button",13),r.uc("click",(function(){return r.Qc(n),r.yc().authenticate()})),r.fd(10,"Authenticate"),r.lc(),r.lc()}}function Ue(t,e){if(1&t){var n=r.nc();r.mc(0,"div"),r.mc(1,"div",21),r.xc(),r.mc(2,"svg",22),r.hc(3,"use",23),r.lc(),r.fd(4," DATA_SOURCE.GITHUB.BASIC_ERROR "),r.lc(),r.wc(),r.mc(5,"button",24),r.uc("click",(function(){return r.Qc(n),r.yc(2).doFetchOwnersAndRepos()})),r.fd(6,"Try Again"),r.lc(),r.lc()}}function ze(t,e){if(1&t&&(r.mc(0,"mat-option",39),r.fd(1),r.lc()),2&t){var n=e.$implicit;r.Dc("value",n),r.Sb(1),r.hd(" ",n," ")}}function Ye(t,e){if(1&t&&(r.mc(0,"mat-option",39),r.fd(1),r.lc()),2&t){var n=e.$implicit;r.Dc("value",n),r.Sb(1),r.hd(" ",n," ")}}function Xe(t,e){if(1&t&&(r.mc(0,"option",39),r.fd(1),r.lc()),2&t){var n=e.$implicit;r.Ec("value",n.value),r.Sb(1),r.gd(n.label)}}function Ke(t,e){1&t&&r.hc(0,"loading-bubbles",8)}function Qe(t,e){if(1&t){var n=r.nc();r.mc(0,"div"),r.mc(1,"form",25),r.uc("ngSubmit",(function(){return r.Qc(n),r.yc(2).onSubmit()})),r.mc(2,"mat-form-field",26),r.mc(3,"mat-label",27),r.fd(4,"Owner"),r.lc(),r.hc(5,"input",28),r.mc(6,"mat-autocomplete",29,30),r.uc("optionSelected",(function(t){return r.Qc(n),r.yc(2).ownerSelected(t)})),r.dd(8,ze,2,2,"mat-option",31),r.zc(9,"async"),r.lc(),r.lc(),r.mc(10,"mat-form-field",26),r.mc(11,"mat-label",27),r.fd(12,"Repo"),r.lc(),r.hc(13,"input",28),r.mc(14,"mat-autocomplete",null,32),r.dd(16,Ye,2,2,"mat-option",31),r.zc(17,"async"),r.lc(),r.lc(),r.mc(18,"mat-form-field",26),r.mc(19,"mat-label",27),r.fd(20,"Get"),r.lc(),r.mc(21,"select",33),r.dd(22,Xe,2,2,"option",31),r.lc(),r.lc(),r.mc(23,"mat-form-field",26),r.mc(24,"mat-label",27),r.fd(25,"Filter"),r.lc(),r.hc(26,"input",34),r.lc(),r.mc(27,"div",35),r.mc(28,"button",36),r.zc(29,"async"),r.fd(30),r.zc(31,"async"),r.lc(),r.mc(32,"button",37),r.uc("click",(function(){return r.Qc(n),r.yc(2).onAboard()})),r.zc(33,"async"),r.fd(34,"Cancel"),r.lc(),r.lc(),r.dd(35,Ke,1,0,"loading-bubbles",38),r.zc(36,"async"),r.lc(),r.lc()}if(2&t){var i=r.Nc(7),a=r.Nc(15),o=r.yc(2);r.Sb(1),r.Dc("formGroup",o.form),r.Sb(1),r.Dc("floatLabel","always"),r.Sb(3),r.Dc("formControl",o.ownersFormControl)("matAutocomplete",i),r.Sb(3),r.Dc("ngForOf",r.Ac(9,16,o.filteredOwners)),r.Sb(2),r.Dc("floatLabel","always"),r.Sb(3),r.Dc("formControl",o.reposFormControl)("matAutocomplete",a),r.Sb(3),r.Dc("ngForOf",r.Ac(17,18,o.filteredRepos)),r.Sb(2),r.Dc("floatLabel","always"),r.Sb(4),r.Dc("ngForOf",o.dataSourceTypeList),r.Sb(1),r.Dc("floatLabel","always"),r.Sb(5),r.Dc("disabled",!o.form.valid||r.Ac(29,20,o.fetching)),r.Sb(2),r.gd(r.Ac(31,22,o.fetching)?"Fetching":"Fetch"),r.Sb(2),r.Dc("disabled",!o.form.valid||!r.Ac(33,24,o.fetching)),r.Sb(3),r.Dc("ngIf",!0===r.Ac(36,26,o.fetching))}}function We(t,e){if(1&t&&(r.mc(0,"div",14),r.mc(1,"div",15),r.mc(2,"div",16),r.mc(3,"mat-expansion-panel",17),r.mc(4,"mat-expansion-panel-header"),r.mc(5,"mat-panel-title",18),r.fd(6," Search on Github "),r.lc(),r.mc(7,"mat-panel-description",19),r.mc(8,"mat-icon"),r.fd(9,"swap_vert"),r.lc(),r.lc(),r.lc(),r.dd(10,Ue,7,0,"div",20),r.zc(11,"async"),r.zc(12,"async"),r.dd(13,Qe,37,28,"div",20),r.zc(14,"async"),r.lc(),r.lc(),r.lc(),r.lc()),2&t){var n=r.yc();r.Sb(10),r.Dc("ngIf",!1===r.Ac(11,2,n.isLoading)&&!n.issues&&!0===r.Ac(12,4,n.isErrorOccur)),r.Sb(3),r.Dc("ngIf",r.Ac(14,6,n.ownerRepos))}}function Ze(t,e){if(1&t&&(r.mc(0,"span",43),r.fd(1),r.lc()),2&t){var n=e.$implicit;r.Sb(1),r.gd(n)}}function Je(t,e){if(1&t&&(r.mc(0,"div",40),r.mc(1,"div",41),r.fd(2,"Search Results"),r.lc(),r.dd(3,Ze,2,1,"span",42),r.lc()),2&t){var n=r.yc();r.Sb(3),r.Dc("ngForOf",n.filterRulesList)}}function $e(t,e){1&t&&(r.mc(0,"div",44),r.hc(1,"div",45),r.mc(2,"div",46),r.fd(3,"No results found on GitHub"),r.lc(),r.lc())}function tn(t,e){1&t&&(r.mc(0,"div",44),r.mc(1,"div",21),r.xc(),r.mc(2,"svg",22),r.hc(3,"use",23),r.lc(),r.fd(4," DATA_SOURCE.GITHUB.BASIC_ERROR "),r.lc(),r.lc())}function en(t,e){1&t&&(r.mc(0,"div",44),r.hc(1,"div",null,47),r.lc())}var nn=function(t){function e(e,n,i,a,r,o,s){var c=t.call(this,i,a)||this;return c.cyclr=e,c.state=n,c.componentFactoryResolver=i,c.injector=a,c.formBuilder=r,c.postMessage=o,c.defLocator=s,c.formData=new Y.a({}),c.filterRulesList=[],c.id="data-sources",c.title="GitHub",c.dataSourceTypeList=[{label:"Issues",value:Ie.b.Issue}],c.subText=new Y.a(""),c.ownersFormControl=new Ce.h("",Ce.G.required),c.reposFormControl=new Ce.h("",Ce.G.required),c.filterFormControl=new Ce.h("is:issue is:open",Ce.G.pattern(/[a-zA-Z]+:[a-zA-Z]+ ?/)),c.form=c.formBuilder.group({owner:c.ownersFormControl,repo:c.reposFormControl,type:Ie.b.Issue,filter:c.filterFormControl}),c.isAuthenticated=new Y.a(void 0),c.isLoading=new Y.a(!0),c.isErrorOccur=new Y.a(!1),c.fetching=new Y.a(!1),c.issues=null,c.ownerRepos=new Y.a(null),c.dataSource=Ie.a.Github,c.dataSourceDefId="creately.card.datasource",c.dataSourceDefVersion=1,c.authWaitTime=6e4,c.aboardFetch=new Se.a,c}return Object(u.e)(e,t),e.prototype.ngOnInit=function(){var t=this;this.cacheTheDataSourceDefinition(),this.aboardFetch.subscribe((function(e){e&&(t.fetching.next(!1),t.isErrorOccur.next(!1),t.issues=[])}))},e.prototype.ngAfterViewInit=function(){var t=this;this.authenticated().subscribe((function(e){!0===e?(t.isAuthenticated.next(!0),t.doFetchOwnersAndRepos()):(t.isLoading.next(!1),t.isAuthenticated.next(!1))}),(function(){t.isAuthenticated.next(!1),t.isLoading.next(!1)}))},e.prototype.doFetchOwnersAndRepos=function(){var t=this;this.isLoading.next(!0),this.isErrorOccur.next(!1),Object(we.a)({repos:this.fetchOwnersAndRepos(),user:this.getUser()}).subscribe({next:function(e){var n=e.repos,i=e.user.login;t.subText.next("Signed in as "+i),t.isAuthenticated.next(!0),t.ownerRepos.next(n);var a=Object.keys(n);t.filteredOwners=t.ownersFormControl.valueChanges.pipe(Object(Ot.a)(""),Object(m.a)((function(e){return e?t._filter(a,e):a})))},error:function(){t.isLoading.next(!1),t.isErrorOccur.next(!0)},complete:function(){t.isLoading.next(!1),t.isErrorOccur.next(!1)}})},e.prototype.ownerSelected=function(t){var e=this,n=this.ownerRepos.value[t.option.value]||[];this.reposFormControl.setValue(null),this.filteredRepos=this.reposFormControl.valueChanges.pipe(Object(Ot.a)(""),Object(m.a)((function(t){return t?e._filter(n,t):n})))},e.prototype.onSubmit=function(){var t=this;this.isErrorOccur.next(!1);var e=this.form.value,n=e.owner,i=e.repo,a=e.type,r=e.filter;if(this.filterRulesList=r.trim().split(" "),n&&i&&a){var o=this.cyclr.fetchPost({dataSource:this.dataSource,method:"getIssuesOrRequests",params:{owner:n,repo:i,filter:r,type:a}});this.listContainer.clear(),this.issues=null,this.fetching.next(!0);var s=new ke.Converter;Object(Me.a)(o).pipe(Object(vt.a)(this.aboardFetch)).subscribe((function(e){var r=t.getDataSource(n,i,a);t.issues=e.map((function(t){return t.description=t.description?s.makeHtml(t.description):"",Object(u.a)(Object(u.a)({},t),{dataSource:r})})),t.insertThePreDefinedQueryItem(t.issues,De,r),t.insertItems(t.issues,Te),t.fetching.next(!1)}),(function(){t.fetching.next(!1),t.isErrorOccur.next(!0),t.issues=[]}))}},e.prototype.onAboard=function(){this.aboardFetch.next(!0)},e.prototype.getDataSource=function(t,e,n){return{domain:Ie.a.Github,data:{type:n,owner:t,repo:e}}},e.prototype.getOwners=function(t){Object.keys(t)},e.prototype.authenticate=function(){var t=this;this.isLoading.next(!0),this.cyclr.fetchPost({dataSource:this.dataSource,method:"getOAuthUrl",params:{target:window.location.href}}).then((function(e){window.open(e.toString());var n=setTimeout((function(){t.isLoading.next(!1),t.isErrorOccur.next(!0)}),t.authWaitTime),a=[i.m.get("CYCLR_AUTH_DOMAIN")];t.postMessage.recvCyclerEvents(a).subscribe((function(e){"done"===e&&(clearTimeout(n),t.initCycle(),t.doFetchOwnersAndRepos())}))}))},e.prototype.getSecondaryMenuItems=function(){return[{id:"github-logout",label:"Logout",callback:function(){alert("Logout")}}]},e.prototype.insertThePreDefinedQueryItem=function(t,n,i){var a=this.makeComponent(n);a.instance.data=t,a.instance.eDefId=e.eDataDefId,a.instance.defId=this.dataSourceDefId,a.instance.version=this.dataSourceDefVersion,a.instance.dataSource=i,this.insert(this.listContainer,a),a.changeDetectorRef.detectChanges()},e.prototype.insertItems=function(t,n){var i=this;t.forEach((function(t){var a=i.makeComponent(n);a.instance.data=t,a.instance.eDefId=e.eDataDefId,a.instance.defId=i.dataSourceDefId,a.instance.version=i.dataSourceDefVersion,i.insert(i.listContainer,a),a.changeDetectorRef.detectChanges()}))},e.prototype.authenticated=function(){var t=this.cyclr.fetchPost({dataSource:this.dataSource,method:"isAuthenticated"});return Object(Me.a)(t)},e.prototype.getUser=function(){var t=this.cyclr.fetchPost({dataSource:this.dataSource,method:"getUser"});return Object(Me.a)(t)},e.prototype.initCycle=function(){return this.cyclr.fetchPost({dataSource:this.dataSource,method:"initCycle"})},e.prototype.fetchOwnersAndRepos=function(){var t=this.cyclr.fetchPost({dataSource:this.dataSource,method:"getAllRepos",params:{target:window.location.href}});return Object(Me.a)(t).pipe(Object(m.a)((function(t){var e={};return t.forEach((function(t){e[t.owner.login]||(e[t.owner.login]=[]),e[t.owner.login].push(t.name)})),e})))},e.prototype.getComponentType=function(t){if("issue"===t)return Te},e.prototype.cacheTheDataSourceDefinition=function(){this.defLocator.getDefinition(this.defId,this.version).pipe(Object(b.a)(1)).subscribe()},e.prototype._filter=function(t,e){var n=e.toLowerCase();return t.filter((function(t){return t.toLowerCase().includes(n)}))},e.eDataDefId="creately.edata.datasource.github",e.dataSourceIcon="github",e.\u0275fac=function(t){return new(t||e)(r.gc(Pe.a),r.gc(i.Mb),r.gc(r.m),r.gc(r.C),r.gc(Ce.g),r.gc(i.tb),r.gc(R.a))},e.\u0275cmp=r.ac({type:e,selectors:[["github-data-source"]],viewQuery:function(t,e){var n;(1&t&&r.kd(Ge,!0,r.hb),2&t)&&(r.Mc(n=r.vc())&&(e.listContainer=n.first))},features:[r.Pb],decls:21,vars:31,consts:[[1,"git-source-container"],["class","git-source-loading",4,"ngIf"],["tooltip-tour-step","data-5",1,"git-source-auth"],["class","git-source-auth-button",4,"ngIf"],["class","git-source-option",4,"ngIf"],["class","git-source-filter-list-container",4,"ngIf"],["class","git-source-list-container",4,"ngIf"],[1,"git-source-loading"],["color","xmedium-grey",1,"fx-center"],[1,"git-source-auth-button"],["translate","",1,"body"],[1,"git-source-auth-description","caption"],["translate",""],[1,"auth-btn","btn-primary","fx-span-width","fx-no-padding","fx-no-margin",3,"click"],[1,"git-source-option"],[1,"container"],[1,"row"],["hideToggle","",1,"git-search-expansion-panel"],[1,"git-search-title","body","body--bold"],[1,"git-search-description","caption"],[4,"ngIf"],["translate","",1,"main-error-title","fx-flex"],[1,"nu-icon","nu-ic-warning-solid","nu-ic-error"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-warning-solid"],[1,"auth-btn","body","nu-btn-med","primary","fx-span-width","fx-no-padding","fx-no-margin",3,"click"],[1,"form-data-source",3,"formGroup","ngSubmit"],["appearance","standard",1,"example-full-width",3,"floatLabel"],[1,"caption","mat-label-color"],["type","text","matInput","",1,"caption","mat-input-color",3,"formControl","matAutocomplete"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["auto2","matAutocomplete"],["formControlName","type","matNativeControl","","required","",1,"caption","mat-input-color"],["formControlName","filter","matInput","","placeholder","Ex. label:bug",1,"caption","mat-input-color"],[1,"form-buttons","fx-flex","fx-center"],["type","submit",1,"btn-medium","btn-primary","fx-margin-right-8",3,"disabled"],["type","button",1,"btn-medium","btn-secondary",3,"disabled","click"],["class","fx-center","color","xmedium-grey",4,"ngIf"],[3,"value"],[1,"git-source-filter-list-container"],[1,"git-source-search-result-title","body","body--bold"],["class","git-source-filter-list-container-item body",4,"ngFor","ngForOf"],[1,"git-source-filter-list-container-item","body"],[1,"git-source-list-container"],[1,"git-no-result"],[1,"git-no-result-text","body","body--lg"],["listContainer",""]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.dd(1,qe,2,0,"div",1),r.zc(2,"async"),r.mc(3,"div",2),r.dd(4,Ve,11,0,"div",3),r.zc(5,"async"),r.zc(6,"async"),r.lc(),r.dd(7,We,15,8,"div",4),r.zc(8,"async"),r.zc(9,"async"),r.dd(10,Je,4,1,"div",5),r.zc(11,"async"),r.zc(12,"async"),r.dd(13,$e,4,0,"div",6),r.zc(14,"async"),r.zc(15,"async"),r.dd(16,tn,5,0,"div",6),r.zc(17,"async"),r.zc(18,"async"),r.dd(19,en,3,0,"div",6),r.zc(20,"async"),r.lc()),2&t&&(r.Sb(1),r.Dc("ngIf",!0===r.Ac(2,7,e.isLoading)),r.Sb(3),r.Dc("ngIf",!1===r.Ac(5,9,e.isAuthenticated)&&!1===r.Ac(6,11,e.isLoading)),r.Sb(3),r.Dc("ngIf",!0===r.Ac(8,13,e.isAuthenticated)&&!1===r.Ac(9,15,e.isLoading)),r.Sb(3),r.Dc("ngIf",!0===r.Ac(11,17,e.isAuthenticated)&&e.issues&&!1===r.Ac(12,19,e.isErrorOccur)),r.Sb(3),r.Dc("ngIf",!0===r.Ac(14,21,e.isAuthenticated)&&e.issues&&0===e.issues.length&&!1===r.Ac(15,23,e.isErrorOccur)),r.Sb(3),r.Dc("ngIf",!0===r.Ac(17,25,e.isAuthenticated)&&e.issues&&0===e.issues.length&&!0===r.Ac(18,27,e.isErrorOccur)),r.Sb(3),r.Dc("ngIf",!0===r.Ac(20,29,e.isAuthenticated)))},directives:[Z.t,Ae.a,_e.a,o.a,Le.c,Le.g,Le.h,Le.f,Re.a,Ce.I,Ce.t,Ce.k,Be.c,Be.g,He.b,Ce.d,Fe.d,Ce.s,Ce.i,Fe.a,Z.s,Ce.E,Ce.j,Ce.D,Ne.k,Ce.x,Ce.H],pipes:[Z.b],styles:[".nu-beta-tag[_ngcontent-%COMP%]{padding:2px 3px;background-color:#ffc648;color:#04263d;border-radius:2px;font-size:11px;display:inline-block}.git-search-expansion-panel[_ngcontent-%COMP%]{background-color:#fafafc;border-radius:.5rem;display:flex;flex-direction:column;align-items:flex-start;flex-wrap:nowrap;box-shadow:none!important;width:100%}.git-search-title[_ngcontent-%COMP%]{line-height:1.25rem;color:#64767d}.git-source-container[_ngcontent-%COMP%]{padding-top:1.25rem}mat-expansion-panel-header[_ngcontent-%COMP%]:hover{background-color:transparent!important}.mat-expansion-panel-header-description[_ngcontent-%COMP%],   .mat-expansion-panel-header-title{margin-right:.25rem;display:flex;flex-grow:1;flex-direction:row}.git-source-auth[_ngcontent-%COMP%]{background-color:#fafafc}.git-source-auth-button[_ngcontent-%COMP%]{padding:.625rem}.git-source-loading[_ngcontent-%COMP%]{margin:auto}.git-source-option[_ngcontent-%COMP%]{width:100%}.git-source-auth-description[_ngcontent-%COMP%]{padding-top:1rem}.example-full-width[_ngcontent-%COMP%],   .mat-expansion-panel-content{width:100%}.git-source-filter-list-container[_ngcontent-%COMP%]{padding:.625rem 0;width:100%}.auth-btn[_ngcontent-%COMP%]{margin-top:1rem;padding:.125rem;height:36px}.main-error-title[_ngcontent-%COMP%]{color:#d92626}.main-error-title[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{padding-right:.375rem;width:20px;height:20px}.main-error-title[_ngcontent-%COMP%]   .nu-ic-warning-solid[_ngcontent-%COMP%]{color:#eab23a}.main-error-title[_ngcontent-%COMP%]   .nu-ic-error[_ngcontent-%COMP%]{color:#d92626}.form-data-source[_ngcontent-%COMP%]{width:100%}.form-data-source[_ngcontent-%COMP%]   .mat-label-color[_ngcontent-%COMP%]{color:#64767d}.form-data-source[_ngcontent-%COMP%]   .mat-input-color[_ngcontent-%COMP%]{color:#04263d}.form-data-source[_ngcontent-%COMP%]   .form-buttons[_ngcontent-%COMP%]{padding-bottom:.25rem;align-items:flex-end;box-sizing:border-box}.git-source-search-result-title[_ngcontent-%COMP%]{padding-bottom:.5rem;line-height:1.25rem;color:#64767d}.git-source-list-container[_ngcontent-%COMP%], .git-source-list-container[_ngcontent-%COMP%]  data-source-card-item{width:100%}.git-source-list-container[_ngcontent-%COMP%]  data-source-card-item .data-source-card{border:.5px solid transparent;font-family:Inter,Arial,sans-serif,ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Noto Sans,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-size:.875rem;font-weight:400}.git-source-list-container[_ngcontent-%COMP%]  data-source-card-item .data-source-card:hover{border:.5px solid transparent}.git-source-filter-list-container-item[_ngcontent-%COMP%]{padding:1px .375rem;margin-right:.125rem;color:#64767d;background-color:rgba(202,204,206,.5);border-radius:.125rem;display:inline-block}.git-no-result[_ngcontent-%COMP%]{margin-top:1.25rem;height:100px;background-position:top;background-repeat:no-repeat;background-image:url(/assets/images/data-source/no-result.svg)}.git-no-result-text[_ngcontent-%COMP%]{color:#64767d}.mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{border:.5px solid #caccce;background:#fff;border-radius:.25rem;height:32px;padding:8px}  .mat-form-field-type-mat-native-select .mat-form-field-infix:after{top:68.75%;right:8px}.mat-form-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{top:0}"],changeDetection:0}),e}(je),an=n("61p6"),rn=n("WH6p"),on=n("izw+"),sn=n("wp/b"),cn=n("tHMF"),ln=n("35j0"),un=n("tqrN"),pn=n("flPR"),dn=function(t){function e(){var e=t.call(this)||this;return e.lineColor="#F05252",e.backgroundColor="#F05252",e.textPadding=5,e.lineThickness=.5,e.texts=[],e.lines=new ht.Shape,e.textBgRects=new ht.Shape,e.addChild(e.lines),e.addChild(e.textBgRects),e}return Object(u.e)(e,t),e.prototype.update=function(t){var e=this;this.clear(),t.forEach((function(t){return e.drawLine(t[0],t[1])}))},e.prototype.clear=function(){var t=this;this.lines.graphics.clear(),this.textBgRects.graphics.clear(),this.texts.forEach((function(e){return t.removeChild(e)}))},e.prototype.destroy=function(){},e.prototype.drawLine=function(t,e){if(t&&e){var n=new ht.Text(""+Math.round(t.distance),"12px Arial","#fff");this.addChild(n),this.texts.push(n);var a=n.getMeasuredWidth()+2*this.textPadding,r=n.getMeasuredHeight()+2*this.textPadding,o=new i.fb(t,e).split(.5);n.x=o.x-a/2+this.textPadding,n.y=o.y-r/2+this.textPadding,this.textBgRects.graphics.setStrokeStyle(1).beginStroke(this.backgroundColor).beginFill(this.backgroundColor).drawRect(o.x-a/2,o.y-r/2,a,r).endFill(),this.lines.graphics.setStrokeStyle(this.lineThickness).beginStroke(this.lineColor).moveTo(t.x,t.y).lineTo(e.x,e.y).endStroke()}},e}(ht.Container),hn=function(t){function e(e,n,i,a){var r=t.call(this,i)||this;return r.vtoD=e,r.viewport=n,r.state=i,r.alignNodeLocator=a,r.threshold=10,r.distanceGuideDebounceTime=10,r.guidesThrottle=200,r.addSource=new Se.a,r.removeSource=new Se.a,r.changeSource=new Se.a,r._indicator=new dn,r}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"indicators",{get:function(){return[this._indicator]},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){var t=this,e=this.state.changes("InterfaceControlState").pipe(Object(f.a)((function(e){return t.state.changes("ShowGuides").pipe(Object(bt.a)(),Object(f.a)((function(n){return n&&"edit"===e?t.initForEditor():(t.removeSource.next(t._indicator),Object(M.b)())})))})));this.subs.push(e.subscribe())},e.prototype.createAddSource=function(){return this.addSource},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){return this.changeSource},e.prototype.getDistancePairs=function(t){var e=this;return this.viewport.getShapeModels(t).pipe(Object(g.a)((function(){return e._indicator.clear()})),Object(Tt.a)(this.distanceGuideDebounceTime),Object(f.a)((function(t){var n=Object(x.values)(t);if(1===n.length){if(n[0].isConnector()){var i=n[0];if(!i.isLine()||!i.isVertical()&&!i.isHorizontal())return Object(I.a)([])}return e.searchNodes(n[0].bounds)}if(n.length){var a=n[0].bounds;return n.forEach((function(t,e){e>0&&(a=a.absorb(t.bounds))})),e.searchNodes(a)}return Object(I.a)([])})))},e.prototype.searchNodes=function(t){var e=this,n=this.state.get("DiagramViewPort"),i=this.getSelectionNodesForRect(t),a=this.alignNodeLocator.search(n.left,n.right,t.top,t.bottom);a&&a.length&&a.push.apply(a,Object(u.j)(i));var r,o,s=this.alignNodeLocator.search(t.left,t.right,n.top,n.bottom);s&&s.length&&s.push.apply(s,Object(u.j)(i));var c,l,p=Object(x.maxBy)(a.filter((function(t){return"top"===t.pos})),(function(t){return t.y})),d=Object(x.minBy)(a.filter((function(t){return"bottom"===t.pos})),(function(t){return t.y})),h=Object(x.maxBy)(s.filter((function(t){return"left"===t.pos})),(function(t){return t.x})),g=Object(x.minBy)(s.filter((function(t){return"right"===t.pos})),(function(t){return t.x}));return p&&d&&(r=p.y+(d.y-p.y)/2,c=Object(x.uniq)(a.map((function(t){return t.shapeId})))),h&&g&&(o=h.x+(g.x-h.x)/2,l=Object(x.uniq)(s.map((function(t){return t.shapeId})))),this.viewport.getShapeModels().pipe(Object(b.a)(1),Object(m.a)((function(n){var i=[];if(void 0!==r&&c&&c.length){var a=e.findHorizontalPairs(t,Object(x.values)(n).filter((function(t){return c.includes(t.id)})),r);i.push.apply(i,Object(u.j)(a))}if(void 0!==o&&l&&l.length){var s=e.findVerticalPairs(t,Object(x.values)(n).filter((function(t){return l.includes(t.id)})),o);i.push.apply(i,Object(u.j)(s))}return i})))},e.prototype.findHorizontalPairs=function(t,e,n){return this.findPairs(t,e,n,"left","right","top","bottom","centerX").map((function(t){return t[0].x=t[0].v,t[1].x=t[1].v,t[0].y=n,t[1].y=n,t}))},e.prototype.findVerticalPairs=function(t,e,n){return this.findPairs(t,e,n,"top","bottom","left","right","centerY").map((function(t){return t[0].y=t[0].v,t[1].y=t[1].v,t[0].x=n,t[1].x=n,t}))},e.prototype.findPairs=function(t,e,n,i,a,r,o,s){var c=this,l=Object(x.sortBy)(e,(function(t){return t.bounds[s]})).filter((function(t){return t.bounds[r]<=n&&t.bounds[o]>=n})),u=l.filter((function(e){return e.bounds[i]>t[s]})),p=l.filter((function(e){return e.bounds[a]<t[s]})).reverse(),d=[],h=[];return u.unshift({bounds:t}),u.forEach((function(t,e){if(u[e]&&u[e+1]){var n=u[e].bounds[a],r=u[e+1].bounds[i];r>n&&h.push([{v:n,distance:Math.abs(c.vtoD.height(r-n))},{v:r}])}})),p.unshift({bounds:t}),p.forEach((function(t,e){if(p[e]&&p[e+1]){var n=p[e].bounds[i],r=p[e+1].bounds[a];n>r&&d.push([{v:n,distance:Math.abs(c.vtoD.height(r-n))},{v:r}])}})),this.getEqualySpacedPairs(h,d)},e.prototype.initForEditor=function(){var t=this;return this.state.changes("Selected").pipe(Object(f.a)((function(e){return t.duringSelectionInteraction([],e)})),Object(gt.lodashThrottle)(this.guidesThrottle),Object(f.a)((function(e){return e.length?(t.addSource.next(t._indicator),t.getDistancePairs(e).pipe(Object(g.a)((function(e){t.updateIndicator(e)})))):(t.removeSource.next(t._indicator),Object(M.b)())})))},e.prototype.getSelectionNodesForRect=function(t){return[{pos:"left",x:t.left,y:t.centerY,type:"selection"},{pos:"right",x:t.right,y:t.centerY,type:"selection"},{pos:"top",y:t.top,x:t.centerX,type:"selection"},{pos:"bottom",y:t.bottom,x:t.centerX,type:"selection"}]},e.prototype.getEqualySpacedPairs=function(t,e){var n=this,i=[],a=[];if(t.length>0){var r=t[0][0].distance;t.every((function(t,e){return Math.abs(t[0].distance-r)<=n.threshold&&(i.push(t),!0)}))}if(e.length>0){var o=e[0][0].distance;e.every((function(t,e){return Math.abs(t[0].distance-o)<=n.threshold&&(a.push(t),!0)}))}var s=[];if(1===a.length&&1===i.length){var c=Object(u.j)(a,i),l=c[0][0].distance;c.every((function(t,e){return Math.abs(t[0].distance-l)<=n.threshold&&(s.push(t),!0)}))}else s=a.length<=1?Object(u.j)(i):i.length<=1?Object(u.j)(a):Object(u.j)(a,i);return s.length>1?s:[]},e.prototype.updateIndicator=function(t){this._indicator.update(t),this.changeSource.next(this._indicator)},e.\u0275fac=function(t){return new(t||e)(r.qc(wt.a),r.qc(V.a),r.qc(i.Mb),r.qc(un.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)(),Object(u.g)("design:paramtypes",[wt.a,V.a,i.Mb,un.a])],e)}(pn.b),gn=function(t){function e(){var e=t.call(this)||this;return e.shape=new ht.Shape,e.addChild(e.shape),e}return Object(u.e)(e,t),e.prototype.update=function(t){var e=this;this.shape.graphics.clear(),t.forEach((function(t){return e.drawLine(t[0],t[1])}))},e.prototype.clear=function(){this.shape.graphics.clear()},e.prototype.destroy=function(){},e.prototype.drawLine=function(t,n){t&&n&&this.shape.graphics.setStrokeStyle(e.lineThickness).beginStroke(e.lineColor).moveTo(t.x,t.y).lineTo(n.x,n.y).endStroke()},e.lineColor="#F05252",e.lineThickness=.5,e}(ht.Container),fn=function(t){function e(e,n,i,a){var r=t.call(this,i)||this;return r.vtoD=e,r.viewport=n,r.state=i,r.alignNodeLocator=a,r.showGuidesPrecision=0,r.snap=5,r.alignDebounceTime=10,r.guidesThrottle=200,r.addSource=new Se.a,r.removeSource=new Se.a,r.changeSource=new Se.a,r._indicator=new gn,r}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"indicators",{get:function(){return[this._indicator]},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){var t=this,e=this.state.changes("InterfaceControlState").pipe(Object(f.a)((function(e){return Object(Ee.b)(t.state.changes("SnapToGuides"),t.state.changes("ShowGuides")).pipe(Object(m.a)((function(t){var e=Object(u.h)(t,2),n=e[0],i=e[1];return n||i})),Object(bt.a)(),Object(f.a)((function(n){return n&&"edit"===e?t.initForEditor():(t.removeSource.next(t._indicator),Object(M.b)())})))})));this.subs.push(e.subscribe())},e.prototype.createAddSource=function(){return this.addSource},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){return this.changeSource},e.prototype.getAlignmentNodesPaires=function(t){var e=this;return this.viewport.getShapeModels(t).pipe(Object(g.a)((function(){return e._indicator.clear()})),Object(Tt.a)(this.alignDebounceTime),Object(m.a)((function(t){var n=Object(x.values)(t);if(1===n.length){if(n[0].isConnector()){var i=n[0];if(!i.isLine()||!i.isVertical()&&!i.isHorizontal())return[]}return e.snapForRect(n[0].bounds,e.snap)}if(n.length){var a=n[0].bounds;return n.forEach((function(t,e){e>0&&(a=a.absorb(t.bounds))})),e.snapForRect(a,e.snap)}return[]})))},e.prototype.searchNodes=function(t,e){var n=this.state.get("DiagramViewPort");return{verticalLeft:this.alignNodeLocator.search(t.x-e,t.x+e,n.top,n.bottom),verticalMiddle:this.alignNodeLocator.search(t.x+t.width/2-e,t.x+t.width/2+e,n.top,n.bottom),verticalRight:this.alignNodeLocator.search(t.x-e+t.width,t.x+t.width+e,n.top,n.bottom),horizontalTop:this.alignNodeLocator.search(n.left,n.right,t.y-e,t.y+e),horizontalMiddle:this.alignNodeLocator.search(n.left,n.right,t.y+t.height/2-e,t.y+t.height/2+e),horizontalBottom:this.alignNodeLocator.search(n.left,n.right,t.y+t.height-e,t.y+t.height+e)}},e.prototype.snapForRect=function(t,e){var n,i,a,r,o,s,c=this.searchNodes(t,e),l=c.verticalLeft;l.length>0&&(a=Object(x.minBy)(l,(function(e){return Math.abs(t.x-e.x)})).x,c.verticalLeft=l.filter((function(t){return t.x===a})),o=a);var u=c.verticalMiddle;if(u.length>0){var p=Object(x.minBy)(u,(function(e){return Math.abs(t.x+t.width/2-e.x)})).x;c.verticalMiddle=u.filter((function(t){return t.x===p}));var d=p-t.width/2;void 0!==o?Math.abs(t.x-o)>Math.abs(t.x-d)&&(o=d):o=d}var h=c.verticalRight;if(h.length>0){r=Object(x.minBy)(h,(function(e){return Math.abs(t.x+t.width-e.x)})).x,c.verticalRight=h.filter((function(t){return t.x===r}));var g=r-t.width;void 0!==o?Math.abs(t.x-o)>Math.abs(t.x-g)&&(o=g):o=g}var f=c.horizontalTop;f.length>0&&(n=Object(x.minBy)(f,(function(e){return Math.abs(t.y-e.y)})).y,c.horizontalTop=f.filter((function(t){return t.y===n})),s=n);var b=c.horizontalMiddle;if(b.length>0){var m=Object(x.minBy)(b,(function(e){return Math.abs(t.y+t.height/2-e.y)})).y;c.horizontalMiddle=b.filter((function(t){return t.y===m}));var v=m-t.height/2;void 0!==s?Math.abs(t.y-s)>Math.abs(t.y-v)&&(s=v):s=v}var y=c.horizontalBottom;if(y.length>0){i=Object(x.minBy)(y,(function(e){return Math.abs(t.y+t.height-e.y)})).y,c.horizontalBottom=y.filter((function(t){return t.y===i}));var S=i-t.height;void 0!==s?Math.abs(t.y-s)>Math.abs(t.y-S)&&(s=S):s=S}var O={tx:void 0!==o?this.vtoD.x(o):void 0,ty:void 0!==s?this.vtoD.y(s):void 0,top:void 0!==n?this.vtoD.y(n):void 0,bottom:void 0!==i?this.vtoD.y(i):void 0,left:void 0!==a?this.vtoD.x(a):void 0,right:void 0!==r?this.vtoD.x(r):void 0};return this.state.get("SnapToGuides")?Object(x.isEqual)(this.state.get("SnapData"),O)||this.state.set("SnapData",O):this.state.set("SnapData",{}),this.state.get("ShowGuides")?this.getNodePairesForRect(c,t):[]},e.prototype.initForEditor=function(){var t=this;return this.state.changes("Selected").pipe(Object(f.a)((function(e){return t.duringSelectionInteraction([],e)})),Object(gt.lodashThrottle)(this.guidesThrottle),Object(f.a)((function(e){return e.length?(t.addSource.next(t._indicator),t.getAlignmentNodesPaires(e).pipe(Object(g.a)((function(e){t.updateIndicator(e)})))):(t.removeSource.next(t._indicator),Object(M.b)())})))},e.prototype.getNodePairesForRect=function(t,e){var n=t.verticalLeft;n.length&&i.pb.isEqual(n[0].x,e.left,this.showGuidesPrecision)?n.push({pos:"left",x:e.x,y:e.centerY,type:"selection"}):n=[];var a=t.verticalMiddle;a.length&&i.pb.isEqual(a[0].x,e.centerX,this.showGuidesPrecision)?(a.push({pos:"top",x:e.centerX,y:e.y,type:"selection"}),a.push({pos:"bottom",x:e.centerX,y:e.y+e.height,type:"selection"})):a=[];var r=t.verticalRight;r.length&&i.pb.isEqual(r[0].x,e.right,this.showGuidesPrecision)?r.push({pos:"right",x:e.x+e.width,y:e.centerY,type:"selection"}):r=[];var o=t.horizontalTop;o.length&&i.pb.isEqual(o[0].y,e.top,this.showGuidesPrecision)?o.push({pos:"top",x:e.centerX,y:e.y,type:"selection"}):o=[];var s=t.horizontalMiddle;s.length&&i.pb.isEqual(s[0].y,e.centerY,this.showGuidesPrecision)?(s.push({pos:"left",x:e.x,y:e.centerY,type:"selection"}),s.push({pos:"right",x:e.x+e.width,y:e.centerY,type:"selection"})):s=[];var c=t.horizontalBottom;c.length&&i.pb.isEqual(c[0].y,e.bottom,this.showGuidesPrecision)?c.push({pos:"bottom",x:e.centerX,y:e.y+e.height,type:"selection"}):c=[];var l=[n,a,r].filter((function(t){return t&&t.length>1})).map((function(t){return[Object(x.minBy)(t,(function(t){return t.y})),Object(x.maxBy)(t,(function(t){return t.y}))]})),p=[o,s,c].filter((function(t){return t&&t.length>1})).map((function(t){return[Object(x.minBy)(t,(function(t){return t.x})),Object(x.maxBy)(t,(function(t){return t.x}))]}));return Object(u.j)(l,p)},e.prototype.updateIndicator=function(t){this._indicator.update(t),this.changeSource.next(this._indicator)},e.\u0275fac=function(t){return new(t||e)(r.qc(wt.a),r.qc(V.a),r.qc(i.Mb),r.qc(un.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)(),Object(u.g)("design:paramtypes",[wt.a,V.a,i.Mb,un.a])],e)}(pn.b),bn=n("Dnwm"),mn=n("19Zn"),vn=function(t){function e(e){var n=t.call(this)||this;return n.user=e,n.animationDuration=30,n.thickness=2,n.textPadding=5,n.subs=[],n.onChange=function(){return null},n.rect=new ht.Shape,n.textRect=new ht.Shape,n.path=new ht.Shape,n.textRect.alpha=0,n.text=new ht.Text(n.user.fullName,"12px Arial","#fff"),n.text.alpha=0,n.addChild(n.path),n.addChild(n.textRect),n.addChild(n.rect),n.addChild(n.text),n}return Object(u.e)(e,t),e.prototype.toggleUserName=function(t){var e=this.text.isVisible()&&this.textRect.isVisible();if(this.bounds){var n=this.bounds.contains({x:t.x,y:t.y,width:0,height:0});!e&&n&&this.setVisibilty([this.text,this.textRect],!0),e&&!n&&this.setVisibilty([this.text,this.textRect],!1)}else{var i=this.stage.getObjectsUnderPoint(t.x,t.y,0).includes(this.path);!e&&i&&this.setVisibilty([this.text,this.textRect],!0),e&&!i&&this.setVisibilty([this.text,this.textRect],!1)}},e.prototype.destroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},e.prototype.update=function(t){var e=this.text.getMeasuredWidth()+2*this.textPadding,n=this.text.getMeasuredHeight()+2*this.textPadding;t.isConnector()?this.drawPath(t,e,n).subscribe():this.drawBox(t,e,n)},e.prototype.setVisibilty=function(t,e){var n=this;t.forEach((function(t){return ht.Tween.get(t,{override:!0,onChange:n.onChange}).to({alpha:e?1:0,visible:e},n.animationDuration)}))},e.prototype.drawBox=function(t,e,n){var a=t.defaultBounds;this.bounds=a;var r=t.transform,o=i.zb.from(a).getTransformedPoints(r),s=o.topLeft,c=o.topRight,l=o.bottomLeft,u=o.bottomRight;this.rect.graphics.clear().setStrokeStyle(this.thickness).beginStroke(this.user.displayColor).moveTo(s.x,s.y).lineTo(c.x,c.y).lineTo(u.x,u.y).lineTo(l.x,l.y).lineTo(s.x,s.y).endStroke(),this.textRect.graphics.clear().setStrokeStyle(this.thickness).beginStroke(this.user.displayColor).beginFill(this.user.displayColor).drawRect(a.right-e,a.top-n,e,n).endFill(),this.text.x=a.right-e+this.textPadding,this.text.y=a.top-n+this.textPadding},e.prototype.drawPath=function(t,e,n){var i=this;return mn.g.instance.create(t,bn.a).pipe(Object(b.a)(1),Object(g.a)((function(a){var r=t.splitByLength(t.length/2);i.path.graphics.clear(),a.shapeView=i.path,a.beginDrawHitArea(),a.graphics.setStrokeStyle(t.style.lineThickness).beginStroke(i.user.displayColor),a.draw(),a.endDraw(),i.textRect.graphics.clear().setStrokeStyle(i.thickness).beginStroke(i.user.displayColor).beginFill(i.user.displayColor).drawRect(r.x-e/2,r.y-n/2,e,n).endFill(),i.text.x=r.x-e/2+i.textPadding,i.text.y=r.y-n/2+i.textPadding})))},e}(ht.Container),yn=n("wkcE"),Sn=function(t){function e(e,n,i){var a=t.call(this,n)||this;return a.viewport=e,a.state=n,a.collabLocator=i,a._indicators={},a.addSource=new Se.a,a.removeSource=new Se.a,a.changeSource=new Se.a,a.update=new Y.a(!0),a}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"indicators",{get:function(){return Object(x.values)(this._indicators)},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){var t=this,e=this.state.changes("InterfaceControlState").pipe(Object(f.a)((function(e){return t.removeIndicators(),"edit"===e?t.initForEditor():Object(M.b)()})));this.subs.push(e.subscribe(),this.pointerMove().subscribe((function(e){t.indicators.forEach((function(t){return t.toggleUserName(e)}))})))},e.prototype.createAddSource=function(){return this.addSource},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){return this.changeSource},e.prototype.pointerMove=function(t){return void 0===t&&(t=200),Object(X.a)(this.indicatorLayer.canvas,"mousemove").pipe(Object(gt.lodashThrottle)(t,{leading:!0,trailing:!0}),Object(m.a)((function(t){return{x:t.x,y:t.y}})))},e.prototype.initForEditor=function(){var t=this;return Object(D.a)(this.state.changes("SelectionBlocked").pipe(Object(f.a)((function(e){return t.state.changes("ActiveShapes").pipe(Object(f.a)((function(n){return t.manageIndicators(e,n)})))}))),this.state.changes("ActiveShapes").pipe(Object(f.a)((function(){return t.update})),Object(f.a)((function(){return t.viewport.getShapeModels(Object.keys(t._indicators)).pipe(Object(g.a)((function(e){return t.updateIndicators(e)})))}))))},e.prototype.manageIndicators=function(t,e){var n=this,i=Object(x.flatten)(t.map((function(t){return t.selected}))).filter((function(t){return e.includes(t)}));return this.manageIndicatorsRemove(i),this.manageIndicatorsAdd(t,i).pipe(Object(g.a)({complete:function(){return n.update.next(!0)}}))},e.prototype.manageIndicatorsRemove=function(t){var e=this;Object.keys(this._indicators).forEach((function(n){t.includes(n)||e.removeIndicator(n)}))},e.prototype.manageIndicatorsAdd=function(t,e){var n=this,i=[Object(M.b)()];return t.forEach((function(t){(t.selected||[]).filter((function(t){return e.includes(t)})).forEach((function(e){if(!n._indicators[e]&&n.state.get("CurrentUser")){var a=n.getUser(t.userId).pipe(Object(d.a)((function(t){return!!t})),Object(g.a)((function(t){n._indicators[e]=new vn(t),n.addSource.next(n._indicators[e])})));i.push(a)}}))})),D.a.apply(void 0,Object(u.j)(i))},e.prototype.getUser=function(t){return this.collabLocator.getCollab(t).pipe(Object(d.a)((function(t){return null!==t})),Object(b.a)(1))},e.prototype.updateIndicators=function(t){var e=this;Object.keys(this._indicators).forEach((function(n){var i=t[n];if(i){var a=e._indicators[n];a.update(i),e.changeSource.next(a),a.onChange=function(){return e.changeSource.next(a)}}}))},e.prototype.removeIndicators=function(){var t=this;Object.keys(this._indicators).forEach((function(e){return t.removeIndicator(e)})),this._indicators={}},e.prototype.removeIndicator=function(t){var e=this._indicators[t];this.removeSource.next(e),e.destroy(),delete this._indicators[t]},e.\u0275fac=function(t){return new(t||e)(r.qc(V.a),r.qc(i.Mb),r.qc(yn.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)(),Object(u.g)("design:paramtypes",[V.a,i.Mb,yn.a])],e)}(pn.b),On=n("BQCR"),xn=n("4y1S"),Cn=n("f6YR"),Tn=n("T4Sa"),jn=n("Voii"),Pn=n("SBw3"),wn=n("Fqp3"),Mn=n("vg1f"),In=n("lu3Q"),En=n("PDpc"),Dn=n("HaSC"),kn=n("3lSR"),An=n("8lHc"),_n=n("K6aZ"),Ln=n("6EBr"),Rn=function(t){function e(e,n,i,a){var r=t.call(this)||this;return r.model=e,r.hitboxes={},r.circles={},r.plusSigns={},r.borders={},r.lastId="",r.verticalPadding=40,r.horizontalPadding=40,r.circleSize=5,r.instantScale=10/(r.circleSize+1),r.delayedScale=16/(r.circleSize+1),r.hovered=_n.a.buttonDefs.reduce((function(t,e){return t[e.id]=!1,t}),{}),r.dToV=null,r.delayedTimers=[],r.dToV=a,r.prepare(n,i),r}return Object(u.e)(e,t),e.prototype.destroy=function(){},e.prototype.onHover=function(t){var e,n,i=this;if(t!==this.lastId){var a=t||this.lastId;this.lastId=t;var r=this.instantScale,o=this.delayedScale,s=this.circles[t||a],c=this.borders[t||a];if(t){if(s.scaleX===o&&s.scaleY===o)return;this.hovered[t]=!0,s.scaleX=r,s.scaleY=r,c.graphics.setStrokeStyle(1/r),c.scaleX=r,c.scaleY=r,null===(e=null==this?void 0:this.stage)||void 0===e||e.update()}if(!t&&(this.hovered[a]=!1,s.scaleX===r&&s.scaleY===r))return s.scaleX=1,s.scaleY=1,c.graphics.setStrokeStyle(1),c.scaleX=1,c.scaleY=1,void(null===(n=null==this?void 0:this.stage)||void 0===n||n.update());var l=Object(An.a)(300).pipe(Object(b.a)(1));this.delayedTimers[a]=l,l.subscribe((function(){var e;if(t){if(!i.hovered[t])return;var n=i.plusSigns[t];if(!s||!n)return;n.alpha=1,s.scaleX=o,s.scaleY=o,c.graphics.setStrokeStyle(4),c.graphics.beginStroke("#FF0000"),c.scaleX=o,c.scaleY=o}else{if(i.hovered[a])return;n=i.plusSigns[a];if(!s||!n)return;n.alpha=0,s.scaleX=1,s.scaleY=1,c.graphics.setStrokeStyle(1),c.scaleX=1,c.scaleY=1}null===(e=null==i?void 0:i.stage)||void 0===e||e.update()}))}},e.prototype.move=function(t,e){var n=e.localX,i=e.localY,a=this.hitboxes[t];a.x+=n,a.y+=i},e.prototype.prepare=function(t,e){var n=this,i=this.horizontalPadding,a=this.verticalPadding,r=this.dToV.width(t.drawWidth)+i*e,o=this.dToV.height(t.drawHeight)+a*e,s=_n.a.buttonDefs.map((function(i){return n.createButton(i,r,o,e,t.angle)})),c=(new ht.Graphics).beginFill("rgb(255, 255, 255, 0)").drawRect(-i*e/2,-a*e/2,r,o),l=new ht.Shape(c);l.name="mainRect",l.mouseEnabled=!1,l.setBounds(-i*e/2,-a*e/2,r,o),this.addChild.apply(this,Object(u.j)([l],s)),this.addChild(l)},e.prototype.createButton=function(t,e,n,i,a){var r,o,s,c=this.horizontalPadding,l=this.verticalPadding,p=new ht.Container;p.name="buttonContainer",p.x=-c*i/2,p.y=-l*i/2;var d=this.circleSize/2,h=e*t.x,g=n*t.y,f=[0,0,2*d],b=(r=(new ht.Graphics).beginFill(Ln.a.backgroundColor)).drawCircle.apply(r,Object(u.j)(f)),m=new ht.Shape(b);m.name="circle",m.setBounds.apply(m,Object(u.j)(f,[2*d])),m.x=h,m.y=g;var v=(o=(new ht.Graphics).beginStroke("#ffffff").setStrokeStyle(1)).drawCircle.apply(o,Object(u.j)(f)),y=new ht.Shape(v);y.x=h,y.y=g,y.mouseEnabled=!1;var S=[0,0,30,30],O=(s=(new ht.Graphics).beginFill("rgb(255, 0, 0, 0.01)")).drawRect.apply(s,Object(u.j)(S)),x=new ht.Shape(O);x.name="hitbox",x.setBounds.apply(x,Object(u.j)(S)),x.x=h-15,x.y=g-15,x.mouseEnabled=!0,x.cursor="pointer";var C=(new ht.Graphics).setStrokeStyle(1.5,"round").beginStroke("#ffffff").moveTo(-7,0).lineTo(7,0).moveTo(0,-7).lineTo(0,7).endStroke(),T=new ht.Shape(C);return T.name="plusSign",T.mouseEnabled=!1,T.x=h,T.y=g,T.alpha=0,a&&(T.rotation=-a),p.addChild(m,x,T,y),this.hitboxes[t.id]=x,this.circles[t.id]=m,this.plusSigns[t.id]=T,this.borders[t.id]=y,p.setBounds(0,0,0,0),p},e}(ht.Container),Bn=n("0fSw"),Hn=n("Zog/"),Fn=n("uWBd"),Nn=function(t){function e(e,n,a,r,o,s,c,l,u,p){var d=t.call(this,a)||this;return d.ll=e,d.commandService=n,d.state=a,d.dToV=r,d.vToD=o,d.definitionLocator=s,d.toolbarManager=c,d.plusCreateService=l,d.pathingSvc=u,d.shapeBoundsLocator=p,d.delay=500,d.autoHideDelay=3e3,d._indicators=[],d.initialized=!1,d.lastShapeId="",d.isDragging=!1,d.blankId="",d.buttonSubs=[],d.tracker=i.Ob,d.redrawSource=new Y.a(""),d.addSource=new Se.a,d.removeSource=new Se.a,d.changeSource=new Se.a,d}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"indicators",{get:function(){return this._indicators},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contextualToolbar",{get:function(){return this.toolbarManager.get("contextual-toolbar")},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){var t=this;if(!this.initialized){this.initialized=!0;var e=this.toolbarManager.get("plus-create-toolbar"),n=this.ll.forCurrentObserver(!1).pipe(Object(f.a)((function(t){return t.getDiagramChanges()})),Object(Dn.a)((function(){return t.isDragging})),Object(g.a)((function(e){var n=(e.modifier||{}).$set;n&&(Object(u.j)(new Set((JSON.stringify(n).match(/shapes\.(.*?)\../g)||[]).map((function(t){var e=Object(u.h)(t.split("."),3),n=e[1],i=e[2];return"t"===i||"c"===i?"":n})))).includes(t.lastShapeId)&&t.redrawSource.next(t.lastShapeId))}))).subscribe(),a=this.ll.forCurrentObserver(!0).pipe(Object(f.a)((function(t){return t.getDiagramChanges()})),Object(g.a)((function(e){if(t._indicators.length){var n=(e.modifier||{}).$set;if(n)Object.keys(n).reduce((function(t,e){return t||e.startsWith("shapes")}),!1)&&t.removeIndicators(t._indicators.length)}}))).subscribe(),r=this.listenToSelectedChanges().pipe(Object(f.a)((function(e){return!t._indicators.length||1===e.length&&t.lastShapeId===e[0]||t.removeIndicators(t._indicators.length),t.lastShapeId=1===e.length?t.lastShapeId:"",[e]})),Object(d.a)((function(e){return t.state.get("ActiveShapes").length&&e&&1===e.length&&!!e[0]&&t.lastShapeId!==e[0]&&t.blankId!==e[0]})),Object(g.a)((function(n){"redraw"===n[0]&&(n[0]=t.lastShapeId),t.removeIndicators(t._indicators.length);var a=Object(u.h)(n,1)[0];for(t.lastShapeId=a;t.buttonSubs.length;)t.buttonSubs.pop().unsubscribe();setTimeout((function(){t.ll.forCurrentObserver(!0).pipe(Object(xt.a)(),Object(f.a)((function(t){return t.getDiagramOnce()})),Object(f.a)((function(e){var n=e.shapes[a];return n?t.definitionLocator.getDefinition(n.defId,n.version).pipe(Object(xt.a)(),Object(f.a)((function(t){return Object(I.a)([e,n,t])}))):[null]})),Object(xt.a)(),Object(d.a)((function(t){var e=Object(u.h)(t,3)[2];return _n.a.isPlusCreateEnabled(e)})),Object(g.a)((function(n){var a,r=Object(u.h)(n,3),o=r[0],s=r[1],c=r[2];if(t.isDragging=!1,t.buttonSubs.push(e.actionEmitter.pipe(Object(b.a)(1)).subscribe((function(e){var n=t,i=n.isDragging,a=n.plusCreatePoint;t.isDragging=!1,t.removeTemporaryConnector(),i&&a?t.dispatchPlusCreate(e,s,a,!0):t.dispatchPlusCreate(e,s)}))),!(null===(a=t.state.get("EditingText"))||void 0===a?void 0:a.open)){e.preparePanel(s);var l=t.state.get("DiagramZoomLevel"),p=new Rn(o,s,l,t.dToV);p.x=t.dToV.x(s.x),p.y=t.dToV.y(s.y),s.angle&&(p.rotation=s.angle);var d=Object.entries(p.hitboxes).reduce((function(t,e){var n=Object(u.h)(e,2),i=n[0],a=n[1];return t.push(Object(X.a)(a,"rollover").pipe(Object(Nt.a)(i)),Object(X.a)(a,"rollout").pipe(Object(Nt.a)(""))),t}),[]),h=Object.entries(p.hitboxes).reduce((function(t,e){var n=Object(u.h)(e,2),i=n[0],a=n[1];return t.push(Object(X.a)(a,"click").pipe(Object(yt.a)(10),Object(Nt.a)(i))),t}),[]),g=Object.entries(p.hitboxes).reduce((function(t,e){var n=Object(u.h)(e,2),i=n[0],a=n[1];return t.push(Object(X.a)(a,"pressmove").pipe(Object(K.a)(2),Object(m.a)((function(t){return{type:"move",id:i,e:t}})))),t}),[]),f=Object(D.a)(d).pipe(Object(kn.a)()).subscribe((function(t){p.onHover(t)})),v=Object(D.a)(h).pipe(Object(kn.a)()).subscribe((function(n){var a,r;t.isDragging||(i.Ob.track("canvas.shape.plusCreate.click",{value1Type:"defId",value1:s.defId,value2Type:"position",value2:n}),t.contextualToolbar.hide(),e.showAndPosition(s,n).pipe(Object(xt.a)()).subscribe(),null===(r=null===(a=t.toolbarManager)||void 0===a?void 0:a.get("contextual-toolbar"))||void 0===r||r.show())})),y=Object(D.a)(g).pipe(Object(kn.a)()).subscribe((function(e){var n=e.type,i=e.id;e.e;if("move"===n&&!t.isDragging&&!s.angle){var a=_n.a.buttonDefs.find((function(t){var e=t.id;return i===e})),r=a.x,l=a.y,u={x:s.x+s.width*r,y:s.y+s.height*l};t.startDragging(c,s,u,o),t.side=i,t.isDragging=!0}}));t.buttonSubs.push(f,v,y,e.onHide.pipe(Object(b.a)(1)).subscribe((function(){t.contextualToolbar.show(),t.isDragging=!1,t.removeTemporaryConnector(),t.commandService.dispatch(O.a.selectShapes,{shapeIds:[]})}))),t._indicators.push(p),t.addSource.next(p)}}))).subscribe()}))}))).subscribe();this.subs.push(r,a,n),this.initialized=!0}},e.prototype.createAddSource=function(){return this.addSource},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){return this.changeSource},e.prototype.destroy=function(){var t;for((t=this.subs).push.apply(t,Object(u.j)(this.buttonSubs)),this.buttonSubs=[];this.subs.length;)this.subs.pop().unsubscribe()},e.prototype.destroyButtonSubs=function(){for(;this.buttonSubs.length;)this.buttonSubs.pop().unsubscribe()},e.prototype.dispatchPlusCreate=function(t,e,n,i){var a=this,r=(t.defId,t.def);void 0===i&&(i=!1);var o=this.toolbarManager;this.ll.forCurrentObserver(!0).pipe(Object(xt.a)(),Object(f.a)((function(t){return t.getDiagramOnce()})),Object(g.a)((function(t){var s=t.shapes[e.id];if(s){var c=o.get("plus-create-toolbar"),l=i?a.side:c.getCurrentRelativePosition(),u=n||{x:a.indicatorLayer.getMouseX(),y:a.indicatorLayer.getMouseY()};a.plusCreateService.dispatchEvent(t,s,l,r,!0,u,i)}}))).subscribe(),this.destroyButtonSubs()},e.prototype.removeTemporaryConnector=function(){this.tempConnectorId&&(this.commandService.dispatch(Q.a.removeShape,null,{shapeIds:[this.tempConnectorId]}),this.tempConnectorId="")},e.prototype.dispatchDragStart=function(t,e,n){var i=this;return this.isDragging=!0,this.ll.forCurrentObserver(!0).pipe(Object(xt.a)(),Object(f.a)((function(t){return t.getDiagramOnce()})),Object(f.a)((function(a){var r=a.shapes[e.id];if(r){var o={x:i.vToD.x(i.indicatorLayer.getMouseX()),y:i.vToD.y(i.indicatorLayer.getMouseY())};return i.plusCreateService.dispatchDragEvent(r,t,o,n)}})))},e.prototype.waitForConnector=function(t,e){var n=this,a=i.wb.shapeId();return this.tempConnectorId=a,this.dispatchDragStart(t,e,a).pipe(Object(v.a)(),Object(f.a)((function(){return n.ll.forCurrentObserver(!1).pipe(Object(f.a)((function(t){return t.getDiagramChanges()})),Object(d.a)((function(t){var e,n;return(null===(n=null===(e=null==t?void 0:t.added)||void 0===e?void 0:e[0])||void 0===n?void 0:n.id)===a})),Object(b.a)(1),Object(f.a)((function(t){return Object(I.a)(t.added[0])})))})))},e.prototype.startDragging=function(t,e,n,a){var r=this;this.waitForConnector(t,e).pipe(Object(g.a)((function(t){var o=r.state.get("InteractionCanvas"),s=Object(X.a)(o,"stagemousemove").pipe().subscribe((function(e){var i,o=Object(x.cloneDeep)(t.getPoints());o[0].x=n.x,o[0].y=n.y,o[1].x=r.vToD.x(e.stageX),o[1].y=r.vToD.y(e.stageY);var s=r.pathingSvc.repath(t.id,a,o,!1),c=Xt.a.createPathFromPoints(s);Object(x.isEqual)(t.path,c)||r.commandService.preview(Q.a.applyModifierDocument,{modifier:{$set:(i={},i["shapes."+t.id+".path"]=c,i)}})})),c=Object(X.a)(o,"stagemouseup").subscribe((function(t){s.unsubscribe(),c.unsubscribe();var n=r.vToD.x(t.stageX),a=r.vToD.y(t.stageY),o=r.shapeBoundsLocator.searchShapes(n,n,a,a,[],!1).find((function(t){return"connector"!==t.type}));if(o){r.removeTemporaryConnector();var l=_n.a.sideToGluepointCoordinates(r.side),u=Object.values(e.gluepoints).find((function(t){return t.x===l.x&&t.y===l.y})),p={points:[{id:i.wb.pointId(),x:e.x,y:e.y,shapeId:e.id},{id:i.wb.pointId(),x:e.x,y:e.y,shapeId:o.id}],endpoints:{},shapeToSelect:""};p.endpoints={from:{x:(null==u?void 0:u.x)||l.x,y:(null==u?void 0:u.y)||l.y}},p.shapeToSelect=o.id,r.commandService.dispatch(Q.a.plusCreateDragConnect,p).pipe(Object(v.a)(),Object(g.a)((function(){var t;r.tracker.track("canvas.toolbar.createconnector.change",{value1:"plusCreate",value1Type:"sublocation"});var n={};n["shapes."+e.id+".x"]=e.x+1,n["shapes.undefined.x"]=0;var a=new Q.a("ApplyModifierDocument",i.Q.SYSTEM);r.commandService.dispatch(a,{modifier:{$set:n}}),r.commandService.dispatch(a,{modifier:{$set:(t={},t["shapes."+e.id+".x"]=e.x,t)}})}))).subscribe()}else{r.plusCreatePoint={x:n,y:a};var d=r.toolbarManager.get("plus-create-toolbar");r.contextualToolbar.hide(),d.showAtPoint(e,"right",{x:t.stageX,y:t.stageY})}}))}))).subscribe()},e.prototype.removeIndicators=function(t){var e=this,n=this._indicators.slice(0,t);this._indicators=this._indicators.slice(t),n.forEach((function(t){return e.removeSource.next(t)}))},e.prototype.listenToSelectedChanges=function(){return Object(D.a)(this.state.changes("Selected"),this.redrawSource.pipe(Object(d.a)((function(t){return""!==t})),Object(m.a)((function(){return["redraw"]}))))},e.removeForPanZoom=!0,e.\u0275fac=function(t){return new(t||e)(r.qc(q.a),r.qc(i.B),r.qc(i.Mb),r.qc(G.a),r.qc(wt.a),r.qc(R.a),r.qc(Bn.a),r.qc(Hn.a),r.qc(Fn.a),r.qc(pe.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)(),Object(u.g)("design:paramtypes",[q.a,i.B,i.Mb,G.a,wt.a,R.a,Bn.a,Hn.a,Fn.a,pe.a])],e)}(pn.b),Gn=function(t){function e(e,n,i,a){var r=t.call(this)||this;return r.model=e,r.verticalPadding=4,r.horizontalPadding=8,r.prepare(n,i,a),r}return Object(u.e)(e,t),e.prototype.destroy=function(){},e.prototype.prepare=function(t,e,n){var i=new ht.Text(" ","italic 12px Inter","#88A1AA").getBounds().width,a=new ht.Text(""+t,"12px Inter","#88A1AA");a.x=this.horizontalPadding,a.y=this.verticalPadding+1;var r=(a.getBounds()||{}).width,o=a.x,s=new ht.Text(e,"italic 12px Inter","#64767D");s.x=r?o+r+i:this.horizontalPadding,s.y=this.verticalPadding+1;var c=s.getBounds().width,l=s.x,u=new ht.Text(""+n,"12px Inter","#88A1AA");u.x=l+c+i,u.y=this.verticalPadding+1;var p=u.getBounds()||s.getBounds(),d=p.height+2*this.verticalPadding,h=(n?p.width:0)+i+c+(r?r+i:0)+2*this.horizontalPadding,g=(new ht.Graphics).beginFill("#F1F4FA").drawRoundRect(0,0,h,d,6),f=new ht.Shape(g);f.setBounds(0,0,h,d),this.addChild(f,a,s,u)},e}(ht.Container),qn=function(t){function e(e,n,i,a,r,o){var s=t.call(this,n)||this;return s.ll=e,s.state=n,s.linkService=i,s.dToV=a,s.definitionLocator=r,s.translator=o,s._indicators=[],s.tooltipSubs=[],s.initialized=!1,s.shapeId="",s.addSource=new Se.a,s.removeSource=new Se.a,s.changeSource=new Se.a,s}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"indicators",{get:function(){return this._indicators},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){for(var t=Object(u.j)(this.subs,this.tooltipSubs);t.length>0;)t.pop().unsubscribe()},e.prototype.initialize=function(){var t=this;if(!this.initialized){this.initialized=!0;var e=JSON.parse(localStorage.getItem(this.getTooltipStatusId()));if(e){if(e.start>=2&&e.continue>=2)return}else localStorage.setItem(this.getTooltipStatusId(),JSON.stringify({start:0,continue:0}));var n=this.ll.forCurrentObserver(!0).pipe(Object(f.a)((function(t){return t.getDiagramChanges()})),Object(g.a)((function(e){if(t._indicators.length){var n=(e.modifier||{}).$set;if(n)Object.keys(n).reduce((function(t,e){return t||e.startsWith("shapes")&&!e.includes(".texts")}),!1)&&t.removeIndicators(t._indicators.length)}}))).subscribe(),a=Object(D.a)(this.listenToSelectedChanges(),this.listenToRotateShape()).pipe(Object(f.a)((function(e){return t.removeTooltipSubs(),!t._indicators.length||1===e.shapes.length&&t.shapeId===e.shapes[0]||t.removeIndicators(t._indicators.length),t.shapeId=1===e.shapes.length?t.shapeId:"",[e]})),Object(d.a)((function(t){return t&&1===t.shapes.length&&!!t.shapes[0]})),Object(g.a)((function(e){var n=Object(u.h)(e.shapes,1)[0];t.shapeId=n,setTimeout((function(){t.ll.forCurrentObserver(!0).pipe(Object(xt.a)(),Object(f.a)((function(t){return t.getDiagramOnce()})),Object(f.a)((function(e){var i=e.shapes[n];return i?t.definitionLocator.getDefinition(i.defId,i.version).pipe(Object(xt.a)(),Object(f.a)((function(t){return Object(I.a)([e,i,t])}))):[null]})),Object(xt.a)(),Object(d.a)((function(e){var n=Object(u.h)(e,3),i=n[0],a=n[2];return i&&t.shouldShowTooltip(a)})),Object(g.a)((function(n){var a=Object(u.h)(n,2),r=a[0],o=a[1],s=t.getActionData(r,o),c=s.translation,l=s.localStorageField,p=s.trackingData,d=c.START,h=c.SHORTCUT,g=c.END,f=JSON.parse(localStorage.getItem(t.getTooltipStatusId())||"")||{},b=Object.values(f).reduce((function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t+e}));if(f[l]>=2)b>=4&&t.subs.forEach((function(t){return t.unsubscribe()}));else{i.Ob.track("canvas.pluscreate.tooltip.load",{value1:p.shortcut+" "+p.text});var m=_n.a.getRelativeBoundingBoxForRotatedShape(o.defaultBounds,o.transform,o.angle),v=new Gn(r,d,h,g);v.x=t.dToV.x(m.x+(m.width-v.getBounds().width)/2),v.y=t.dToV.y(m.y+m.height+20),t.positionIndicator(v),t._indicators.push(v),t.addSource.next(v),f[l]=f[l]+1,t.updateTooltipHistory(f,e.rotated?15e3:2e3)}}))).subscribe()}))}))).subscribe();this.subs.push(a,n),this.initialized=!0}},e.prototype.createAddSource=function(){return this.addSource},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){return this.changeSource},e.prototype.updateTooltipHistory=function(t,e){var n=this;void 0===e&&(e=2e3),this.tooltipSubs.push(Object(I.a)(null).pipe(Object(yt.a)(e),Object(g.a)((function(){localStorage.setItem(n.getTooltipStatusId(),JSON.stringify(t))}))).subscribe())},e.prototype.removeTooltipSubs=function(){for(;this.tooltipSubs.length>0;)this.tooltipSubs.pop().unsubscribe()},e.prototype.updateIndicators=function(){var t=this;this._indicators.forEach((function(e){t.positionIndicator(e),t.changeSource.next(e)}))},e.prototype.positionIndicator=function(t){var e=this.state.get("DiagramZoomLevel");t.scaleX=e,t.scaleY=e},e.prototype.removeIndicators=function(t){var e=this,n=this._indicators.slice(0,t);this._indicators=this._indicators.slice(t),n.forEach((function(t){return e.removeSource.next(t)}))},e.prototype.listenToSelectedChanges=function(){return this.state.changes("Selected").pipe(Object(m.a)((function(t){return{shapes:t,rotated:!1}})))},e.prototype.listenToRotateShape=function(){var t=this;return this.ll.forCurrentObserver(!1).pipe(Object(xt.a)(),Object(f.a)((function(t){return t.getDiagramChanges()})),Object(d.a)((function(e){return Object.keys(e.modifier.$set||{}).includes("shapes."+t.shapeId+".angle")})),Object(m.a)((function(t){var e=Object.keys(t.modifier.$set).find((function(t){return t.includes(".angle")}));return{shapes:[Object(u.h)(/shapes\.(.*?).angle/.exec(e),2)[1]],rotated:!0}})))},e.removeForPanZoom=!0,e.\u0275fac=function(t){return new(t||e)(r.qc(q.a),r.qc(i.Mb),r.qc(U.a),r.qc(G.a),r.qc(R.a),r.qc(o.e))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)(),Object(u.g)("design:paramtypes",[q.a,i.Mb,U.a,G.a,R.a,o.e])],e)}(pn.b),Vn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),e.prototype.getActionData=function(t,e){var n=Object(u.h)(_n.a.getAllConnectedShapes(t,e),1)[0],i=n.length&&n.length>=1,a=this.translator.instant("TOOLTIP_TOUR.STEPS.PLUS_CREATE_TOOLTIP_SIBLING"),r=this.translator.instant("TOOLTIP_TOUR.STEPS.PLUS_CREATE_TOOLTIP_CHILD");return{translation:i?a:r,localStorageField:i?"continue":"start",trackingData:{text:i?"to add item":"to add child item",shortcut:i?"Shift + Enter":"Tab"}}},e.prototype.getTooltipStatusId=function(){return"plusCreateTooltipStatus"},e.prototype.shouldShowTooltip=function(t){return"connector"!==(null==t?void 0:t.type)&&_n.a.isPlusCreateEnabled(t)},e.\u0275fac=function(t){return Un(t||e)},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)()],e)}(qn),Un=r.oc(Vn);Object.defineProperty(Vn,"name",{value:"PlusCreateTooltipHandler"});var zn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),e.prototype.getActionData=function(t,e){var n=this.translator.instant("TOOLTIP_TOUR.STEPS.IMAGE_RESIZE_TOOLTIP");return{translation:n,localStorageField:n?"continue":"start",trackingData:{null:null}}},e.prototype.getTooltipStatusId=function(){return"imageResizeTooltipStatus"},e.prototype.shouldShowTooltip=function(t){return"creately.basic.rasterimage"===t.defId||"creately.basic.vectorimage"===t.defId},e.\u0275fac=function(t){return Yn(t||e)},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)()],e)}(qn),Yn=r.oc(zn);Object.defineProperty(zn,"name",{value:"ImageResizeTooltipHandler"});var Xn=n("elRR"),Kn=n("0itG"),Qn=n("2ZsA"),Wn=n("ujvC"),Zn=n("2zxM"),Jn=n("13fK"),$n=n("1U5y"),ti=n("wf7V"),ei=n("zFpY"),ni=n("C3qL"),ii=n("aSB4"),ai=n("euU2"),ri=n("k0Sg"),oi=n("zsv6"),si=n("/6pf"),ci=n("dFmy"),li=n("Di8k"),ui=n("y9Mj"),pi=n("pt/I"),di=n("oK6n"),hi=n("aSzn"),gi={cursors:{rotate:'<svg xmlns="http://www.w3.org/2000/svg" width="16.83" height="15" ><title>cursors-tails</title><path d="M16.83,7.5A7.51,7.51,0,0,1,9.33,15a1,1,0,1,1,0-2A5.5,5.5,0,1,0,4.25,5.4l2.69,1c.26.09.34.34.16.45L2.39,9.51a.44.44,0,0,1-.57-.21L0,4.2C-.06,4,.17,3.87.42,4l2,.73A7.5,7.5,0,0,1,16.83,7.5Z"/></svg>',selectable:'<svg xmlns="http://www.w3.org/2000/svg" data-ox="8.5" data-oy="8.5" width="17.41" height="24.69" ><title>cursors-tails</title><circle cx="8.56" cy="8.56" r="2.03" style="fill:rgb(198,198,198)"/><polygon points="17.41 17.58 8.56 8.56 8.56 21.19 11.31 18.81 13.71 24.69 16.18 23.67 13.78 17.8 17.41 17.58"/><path d="M6.67,16.89H6.55A8.56,8.56,0,1,1,17.12,8.56a8.45,8.45,0,0,1-1.81,5.26.5.5,0,1,1-.79-.62,7.44,7.44,0,0,0,1.6-4.64A7.56,7.56,0,1,0,6.78,15.9a.5.5,0,0,1,.37.61A.49.49,0,0,1,6.67,16.89Z" style="fill:rgb(198,198,198)"/><path d="M6.67,13.46a.45.45,0,0,1-.2,0,5.32,5.32,0,1,1,6.54-2,.49.49,0,0,1-.69.15.5.5,0,0,1-.15-.69,4.29,4.29,0,1,0-5.3,1.63.5.5,0,0,1-.2,1Z" style="fill:rgb(198,198,198)"/></svg>'},tails:{textEdit:'<svg xmlns="http://www.w3.org/2000/svg" width="6.54" height="15.36"><path id="_Path_" d="M6.54.54V0A3.64,3.64,0,0,0,3.27,1.72,3.67,3.67,0,0,0,0,0V.54c1.65,0,3,1,3,2.25V7.9H1.35v.54H3v4.13c0,1.24-1.35,2.25-3,2.25v.54a3.65,3.65,0,0,0,3.27-1.73,3.66,3.66,0,0,0,3.27,1.73v-.54c-1.65,0-3-1-3-2.25V8.44H5.19V7.9H3.54V2.79C3.53,1.55,4.88.54,6.54.54Z"/></svg>',text:'<svg xmlns="http://www.w3.org/2000/svg" width="10.65" height="12.21" ><title>cursors-tails</title><path d="M.11,0H10.55l.1,3.14H10.2a3.76,3.76,0,0,0-.82-1.93A3.39,3.39,0,0,0,7.27.77h-1v9.44q0,1.06.33,1.32A2.91,2.91,0,0,0,8,11.87v.34H2.66v-.34a2.52,2.52,0,0,0,1.46-.39A2.39,2.39,0,0,0,4.41,10V.77h-1a3.5,3.5,0,0,0-2.09.44A3.28,3.28,0,0,0,.45,3.14H0Z"/></svg>',connector:'<svg xmlns="http://www.w3.org/2000/svg" width="14.93" height="12.35" ><title>cursors-tails</title><path d="M12.68,0a2.25,2.25,0,0,0-2.12,1.5H6.65V9.35H4.37a2.25,2.25,0,1,0,0,1.5H8.15V3h2.41a2.25,2.25,0,1,0,2.12-3ZM2.25,10.85A.75.75,0,1,1,3,10.1.76.76,0,0,1,2.25,10.85ZM12.68,3a.75.75,0,1,1,.75-.75A.75.75,0,0,1,12.68,3Z" style="fill:rgb(21,20,21)"/></svg>',move:'<svg xmlns="http://www.w3.org/2000/svg" width="12.6" height="12.6"><title>move-tail</title><path d="M6.3,4.87a.5.5,0,0,1-.5-.5V2.45A.5.5,0,0,1,6.3,2a.5.5,0,0,1,.5.5V4.37A.5.5,0,0,1,6.3,4.87Z" style="fill:rgb(21,20,21)"/><path d="M6.3,10.54a.5.5,0,0,1-.5-.5V8.46A.51.51,0,0,1,6.3,8a.5.5,0,0,1,.5.5V10A.5.5,0,0,1,6.3,10.54Z" style="fill:rgb(21,20,21)"/><path d="M6.48.07l2,2.39c.08.1,0,.22-.18.22h-4c-.16,0-.25-.12-.18-.22l2-2.39A.26.26,0,0,1,6.48.07Z" style="fill:rgb(21,20,21)"/><path d="M6.13,12.53l-2-2.39c-.07-.09,0-.21.18-.21h4c.16,0,.26.12.18.21l-2,2.39A.24.24,0,0,1,6.13,12.53Z" style="fill:rgb(21,20,21)"/><path d="M10.16,6.8H8.35a.5.5,0,0,1-.5-.5.5.5,0,0,1,.5-.5h1.81a.51.51,0,0,1,.5.5A.5.5,0,0,1,10.16,6.8Z" style="fill:rgb(21,20,21)"/><path d="M4.26,6.8H2.56a.5.5,0,0,1-.5-.5.5.5,0,0,1,.5-.5h1.7a.51.51,0,0,1,.5.5A.5.5,0,0,1,4.26,6.8Z" style="fill:rgb(21,20,21)"/><path d="M12.53,6.48l-2.39,2c-.09.08-.21,0-.21-.18v-4c0-.16.12-.25.21-.18l2.39,2A.24.24,0,0,1,12.53,6.48Z" style="fill:rgb(21,20,21)"/><path d="M.07,6.13l2.39-2c.1-.07.22,0,.22.18v4c0,.16-.12.26-.22.18l-2.39-2A.26.26,0,0,1,.07,6.13Z" style="fill:rgb(21,20,21)"/></svg>',resizeTopLeft:'<svg xmlns="http://www.w3.org/2000/svg" width="10.64" height="10.52" ><title>cursors-tails</title><path d="M10.64,10.15a.38.38,0,0,1-.36.37l-4.53-.34c-.18,0-.2-.23,0-.4L7.22,8.22,2.36,3.36.85,4.92c-.16.16-.38.15-.4,0L0,.37A.37.37,0,0,1,.36,0L4.89.34c.18,0,.2.23,0,.39L3.42,2.29,8.27,7.15,9.79,5.59c.16-.16.38-.14.4,0Z"/></svg>',resizeTopRight:'<svg xmlns="http://www.w3.org/2000/svg" width="10.52" height="10.64" ><title>cursors-tails</title><path d="M10.52.36l-.34,4.53c0,.18-.23.2-.4,0L8.23,3.41,3.37,8.27,4.92,9.79c.17.16.15.38,0,.4l-4.52.45A.37.37,0,0,1,0,10.28L.34,5.75c0-.18.23-.2.4,0L2.29,7.23,7.15,2.37,5.6.85c-.17-.16-.15-.38,0-.4L10.15,0A.37.37,0,0,1,10.52.36Z"/></svg>',resizeVertical:'<svg xmlns="http://www.w3.org/2000/svg" width="6.44" height="14.65" ><title>cursors-tails</title><path d="M6.41,11,3.53,14.54a.37.37,0,0,1-.51,0l-3-3.45c-.12-.13,0-.3.25-.3l2.18,0V3.89L.3,3.92c-.22,0-.37-.16-.26-.3L2.92.1a.38.38,0,0,1,.52,0l3,3.44c.12.13,0,.31-.25.31L4,3.88v6.87l2.17,0C6.37,10.72,6.52,10.88,6.41,11Z"/></svg>',resizeHorizontal:'<svg xmlns="http://www.w3.org/2000/svg" width="14.65" height="6.44" ><title>cursors-tails</title><path d="M14.55,3.43l-3.44,3c-.14.11-.31,0-.31-.26l0-2.17H3.9l0,2.17c0,.23-.17.37-.31.26L.11,3.52A.36.36,0,0,1,.1,3L3.54,0c.14-.12.31,0,.31.25l0,2.18h6.87l0-2.17c0-.23.17-.38.3-.26l3.52,2.87A.37.37,0,0,1,14.55,3.43Z"/></svg>',break:'<svg width="10" height="10" ></svg>',delete:'<svg width="10" height="10" ></svg>',drop:'<svg xmlns="http://www.w3.org/2000/svg" width="13.04" height="10.79" ><title>cursors-tails</title><path d="M13,4.94v5.85H4.19V4.94H5.56V3.53a2,2,0,0,0-4.06,0V4.94a.75.75,0,0,1-1.5,0V3.53a3.53,3.53,0,0,1,7.06,0V4.94Z" style="fill:rgb(21,20,21)"/></svg>',lock:'<svg width="12" height="15" viewBox="0 0 12 15" fill="none" xmlns="http://www.w3.org/2000/svg"><rect y="6" width="11" height="8" rx="1" fill="black"/><path d="M5.27579 0C5.50123 0 5.72667 0 5.95212 0C5.98402 0.00451488 6.01593 0.00948125 6.04783 0.0136951C6.22888 0.037323 6.41264 0.0480082 6.59052 0.0860837C8.42853 0.47948 9.84139 2.16188 9.81791 4.03585C9.81023 4.64942 9.83507 5.26345 9.8453 5.87732C9.8456 5.89403 9.84816 5.91073 9.84981 5.92984C9.87088 5.93361 9.88774 5.93767 9.9049 5.93933C10.6976 6.01683 11.4452 6.73891 11.4395 7.63241C11.4282 9.3914 11.4385 11.1506 11.435 12.9095C11.4347 13.0989 11.4205 13.292 11.381 13.4765C11.3179 13.7708 11.1456 14.0097 10.9338 14.219C10.6408 14.5087 10.3005 14.6968 9.87705 14.7056C9.55906 14.7122 9.24121 14.7295 8.92321 14.7296C6.65629 14.7307 4.38952 14.7293 2.1226 14.7262C1.88993 14.7259 1.6547 14.7272 1.42535 14.6949C1.00245 14.6353 0.669406 14.4085 0.397611 14.0837C0.168556 13.8095 0.0282933 13.5037 0.0263368 13.1403C0.0251328 12.9273 0.0159526 12.7145 0.00948125 12.5017C0.00842778 12.4645 0.00331091 12.4274 0 12.3902C0 11.0169 0 9.64348 0 8.27021C0.00496637 8.10286 0.00526736 7.93505 0.0162536 7.768C0.0291962 7.571 0.019715 7.36527 0.0753985 7.17986C0.261562 6.55937 0.688068 6.16898 1.30525 5.98553C1.40247 5.95663 1.50481 5.94535 1.60519 5.92593C1.60639 5.90983 1.60805 5.89749 1.6082 5.885C1.61858 5.22372 1.63303 4.56259 1.6377 3.90131C1.64056 3.48519 1.7149 3.08381 1.8672 2.699C2.41366 1.31699 3.40994 0.445619 4.85184 0.0866857C4.99165 0.0519211 5.13447 0.0285942 5.27579 0ZM5.71885 13.8815C7.10642 13.8815 8.494 13.8816 9.88157 13.881C9.91603 13.881 9.95411 13.8827 9.98436 13.8694C10.2355 13.7592 10.4355 13.592 10.5516 13.3376C10.5728 13.2911 10.5951 13.2394 10.5952 13.1901C10.6018 11.6391 10.6076 10.0882 10.6086 8.53719C10.6089 8.19421 10.5939 7.85108 10.58 7.50825C10.5754 7.39116 10.5654 7.2664 10.4792 7.17716C10.3773 7.07166 10.2685 6.97037 10.1505 6.88354C10.0352 6.79866 9.90249 6.76419 9.75064 6.7648C8.57602 6.76976 7.40139 6.76314 6.22662 6.7654C4.70646 6.76826 3.18615 6.77638 1.66599 6.78105C1.49894 6.7815 1.35055 6.83252 1.21902 6.93155C1.01585 7.08475 0.863847 7.2664 0.866857 7.54271C0.868814 7.7203 0.847744 7.89803 0.847895 8.07577C0.8494 9.79202 0.853011 11.5084 0.856774 13.2247C0.856774 13.2489 0.859483 13.2754 0.869416 13.2969C0.962723 13.5004 1.10359 13.6619 1.29487 13.7799C1.41015 13.8509 1.52919 13.8846 1.6687 13.8842C3.0188 13.8796 4.36875 13.8815 5.71885 13.8815ZM2.4585 5.91073C4.64039 5.91073 6.81235 5.91073 8.98853 5.91073C8.98973 5.88876 8.99154 5.87175 8.99154 5.85475C8.99033 5.27609 8.99154 4.69728 8.98672 4.11862C8.98386 3.78513 8.95181 3.45614 8.85338 3.13288C8.43109 1.74726 6.95743 0.556685 5.17872 0.880101C3.86233 1.11954 3.01143 1.92214 2.58582 3.18299C2.53977 3.31964 2.48619 3.46246 2.48303 3.60348C2.46663 4.34979 2.46512 5.0964 2.4585 5.84286C2.45835 5.86257 2.4585 5.88244 2.4585 5.91073Z" fill="black"/><path d="M5.32137 10.9636C5.32137 10.7432 5.32017 10.5227 5.32227 10.3024C5.32273 10.2559 5.31114 10.224 5.27351 10.1937C5.2073 10.1406 5.14138 10.085 5.08539 10.0217C4.89622 9.80723 4.8443 9.39397 4.96996 9.14369C5.12437 8.83638 5.44719 8.64495 5.76834 8.67023C6.33406 8.71463 6.68983 9.24287 6.50758 9.77096C6.44874 9.94162 6.33466 10.0744 6.1941 10.1839C6.14895 10.2191 6.13044 10.2562 6.13029 10.3152C6.12893 10.7534 6.12758 11.1918 6.11735 11.6299C6.11223 11.8498 5.95225 11.9885 5.72771 11.9891C5.50347 11.9897 5.34349 11.8504 5.33582 11.632C5.32799 11.4094 5.33416 11.1864 5.33416 10.9636C5.3298 10.9636 5.32559 10.9636 5.32137 10.9636Z" fill="white"/></svg>'}},fi=n("iim9"),bi=n("GoAz"),mi=n("wqq/"),vi=n("TZl/"),yi=function(t){function e(e,n,i,a){var r=t.call(this,e)||this;return r.commandService=n,r.viewport=i,r.ll=a,r.customGluepoint=null,r._shapes={},r.addSource=new Se.a,r.changeSource=new Se.a,r.removeSource=new Se.a,r.isPreviewingConnect=new Y.a(!1),r}var n;return Object(u.e)(e,t),n=e,Object.defineProperty(e.prototype,"indicators",{get:function(){return Object(x.flatten)(Object(x.values)(this._shapes).map((function(t){return t.gluePoints})))},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){var t=this;this.subs.push(this.ll.forCurrentObserver(!1).pipe(Object(f.a)((function(t){return t.getDiagramModel()})),Object(bt.a)((function(t,e){var n=Object.keys((null==t?void 0:t.shapes)||{}),i=Object.keys((null==e?void 0:e.shapes)||{});return Object(x.isEqual)(n,i)})),Object(f.a)((function(e){return t.listenToStates(e).pipe(Object(g.a)((function(n){return t.changeShapes(e,n)})))}))).subscribe())},e.prototype.destroy=function(){var e=this;t.prototype.destroy.call(this),Object.keys(this._shapes).forEach((function(t){return e.removeGluePointsFor(t)}))},e.prototype.listenToStates=function(t){var e=this;return this.state.changes("MouseControlState").pipe(Object(f.a)((function(n){return n===Pt.b.Connector||n===Pt.b.Line?e.duringConnectorControlState():n===Pt.b.Normal?e.duringNormalControlState(t):Object(I.a)({})})))},e.prototype.duringConnectorControlState=function(){var t=Object(X.a)(this.indicatorLayer,"shapeRollOver").pipe(Object(d.a)((function(t){return t.relatedShape.isShapeView})),Object(m.a)((function(t){return{shapeId:t.relatedShape.name,visibility:"show"}}))),e=Object(X.a)(this.indicatorLayer,"shapeRollOut").pipe(Object(d.a)((function(t){return t.relatedShape.isShapeView})),Object(m.a)((function(t){return{shapeId:t.relatedShape.name,visibility:"hide"}})));return Object(D.a)(t,e)},e.prototype.duringNormalControlState=function(t){var e=this;return this.duringConnectorSelection().pipe(Object(f.a)((function(n){return n?e.duringEndPointMovement(t,n):Object(I.a)({})})))},e.prototype.duringConnectorSelection=function(){var t=this,e=Object(D.a)(Object(X.a)(this.indicatorLayer,Bt.b.interactionEnd),Object(X.a)(this.indicatorLayer,Bt.b.interactionCancel));return Object(D.a)(this.state.changes("Selected"),e.pipe(Object(yt.a)(0),Object(m.a)((function(){return t.state.get("Selected")})))).pipe(Object(f.a)((function(e){return 1===e.length?t.getConnectorModel(e[0]):Object(I.a)(null)})))},e.prototype.getConnectorModel=function(t,e){void 0===e&&(e=!0);var n=this.viewport.getShapeModel(t);return e&&(n=n.pipe(Object(b.a)(1))),n.pipe(Object(m.a)((function(t){return t instanceof Xt.a?t:null})))},e.prototype.duringEndPointMovement=function(t,e){var n=this,i=this.getEndpointInteraction().pipe(Object(mi.a)(1));return Object($t.a)(Object(Ee.b)([this.getConnectorModel(e.id,!1),this.isPreviewingConnect]).pipe(Object(d.a)((function(t){var e=Object(u.h)(t,2);e[0];return!e[1]})),Object(f.a)((function(e){var i=Object(u.h)(e,1)[0];return Object($t.a)(Object(I.a)({}),n.shapesAttachedToConnector(t,i))})),Object(vt.a)(i)),i)},e.prototype.getEndpointInteraction=function(){return Object(D.a)(this.getEndpointInteractionStart(),this.getEndpointOverInteraction(),this.getEndpointOutInteraction(),this.getCustomGluepointInteraction())},e.prototype.getEndpointInteractionStart=function(){return Object(X.a)(this.indicatorLayer,Bt.b.interactionStart).pipe(Object(m.a)((function(){return{}})))},e.prototype.getEndpointOverInteraction=function(){var t=this;return Object(X.a)(this.indicatorLayer,rt.over).pipe(Object(m.a)((function(e){return t.onEndPointOver(e)})),Object(d.a)((function(t){return!!t})))},e.prototype.getEndpointOutInteraction=function(){var t=this;return Object(X.a)(this.indicatorLayer,rt.out).pipe(Object(m.a)((function(e){return t.onEndPointOut(e)})),Object(d.a)((function(t){return!!t})))},e.prototype.getCustomGluepointInteraction=function(){var t=this;return Object(X.a)(this.indicatorLayer,rt.over).pipe(Object(yt.a)(0),Object(f.a)((function(e){return Object($t.a)(Object($t.a)(Object(I.a)(e),Object(X.a)(t.indicatorLayer,Bt.b.interactionEnd)).pipe(Object(f.a)((function(i){return Object($t.a)(Object(I.a)(t.onEndPointHoverEnd(e)),Object(I.a)(i).pipe(Object(yt.a)(n.CUSTOM_HOVER_TIMEOUT),Object(m.a)((function(){return i.targetOver=e.targetOver,t.onEndPointHover(i)}))))})),Object(d.a)((function(t){return!!t})),Object(vt.a)(Object(X.a)(t.indicatorLayer,rt.out))),Object(I.a)(t.onEndPointHoverEnd(e)))})))},e.prototype.onEndPointOver=function(t){if(t.targetOver instanceof le.a)return{shapeId:t.targetOver.name,visibility:"showOne",expandOn:"endpoint"}},e.prototype.onEndPointOut=function(t){if(t.targetOver instanceof le.a)return{shapeId:t.targetOver.name,visibility:"hide"}},e.prototype.onEndPointHover=function(t){if(t.targetOver instanceof le.a){var e={x:t.currentTarget.mouseX/t.currentTarget.scaleX,y:t.currentTarget.mouseY/t.currentTarget.scaleY};return{shapeId:t.targetOver.name,visibility:"create",mousePosition:e}}},e.prototype.onEndPointHoverEnd=function(t){return{shapeId:t.targetOver.name,visibility:"remove"}},e.prototype.shapesAttachedToConnector=function(t,e){var n=[],i=e.getFromEndpoint(t),a=e.getToEndpoint(t);return i.shape&&i.gluepoint&&n.push(this.getChangeForShape(i)),a.shape&&a.gluepoint&&n.push(this.getChangeForShape(a)),Object(bi.a)(n)},e.prototype.getChangeForShape=function(t){var e=t.shape,n=Object.keys(e.gluepoints).filter((function(e){return e!==t.gluepoint.id}));return{visibility:"show",shapeId:e.id,gluePointIds:n,connectOnMouse:!0}},e.prototype.createAddSource=function(){return this.addSource},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){return this.changeSource},e.prototype.changeShapes=function(t,e){"show"===e.visibility||"showOne"===e.visibility?(this.addGluePointsFor(t,e.shapeId,e.gluePointIds,e.expandOn,e.connectOnMouse),this.setShapeActive(e.shapeId,!0),"showOne"===e.visibility&&this.removeAllGluePoints([e.shapeId])):"hide"===e.visibility?(this.setShapeActive(e.shapeId,!1),this.isAnyGluePointActive(e.shapeId)||this.removeGluePointsFor(e.shapeId),this.removeCustomGluepoint()):"create"===e.visibility||"remove"===e.visibility?this.removeCustomGluepoint():(this.removeCustomGluepoint(),this.removeAllGluePoints())},e.prototype.addGluePointsFor=function(t,e,n,i,a){var r=this;void 0===i&&(i="mouse"),this.ensureShapeDataExists(e,i,!0),this.viewport.getShapeOnce(e).subscribe((function(o){r.ensureShapeDataExists(e,i),r.createGluePoints(t,o,n,a),n&&r.removeGluePointsFor(e,n)}))},e.prototype.removeGluePointsFor=function(t,e){var n=this;void 0===e&&(e=[]);var i=this._shapes[t];if(i){for(var a=[],r=i.gluePoints.length;r--;){var o=i.gluePoints[r];-1===e.indexOf(o.gluePointId)&&a.push(this.removeGluePoint(o))}D.a.apply(void 0,Object(u.j)(a)).subscribe({complete:function(){var e=n._shapes[t];e&&!e.gluePoints.length&&(e.shapeSub.unsubscribe(),delete n._shapes[t])}})}},e.prototype.removeAllGluePoints=function(t){var e=this;void 0===t&&(t=[]),Object.keys(this._shapes).forEach((function(n){-1!==t.indexOf(n)||e.isAnyGluePointActive(n)||e.removeGluePointsFor(n)}))},e.prototype.createGluePoints=function(t,e,n,i){for(var a in e.gluepoints){var r=e.gluepoints[a];this.shouldCreateGluePoint(e.id,r.id,n)&&(this.createGluePoint(t,e.id,r,!1,i),this.positionGluePoint(e,r))}var o=qt.createModel();this.shouldCreateGluePoint(e.id,o.id,n)&&(this.createGluePoint(t,e.id,o,!0,i),this.positionGluePoint(e,o),this.updateGluePointFull(e.id)),0===this.getGluePoints(e.id).length&&this.removeGluePointsFor(e.id)},e.prototype.positionGluePoints=function(t){for(var e in t.gluepoints){var n=t.gluepoints[e];this.positionGluePoint(t,n)}this.positionGluePoint(t,qt.createModel())},e.prototype.createCustomGluepoint=function(t,e){var n=this;this.viewport.getShapeOnce(t).subscribe((function(a){var r=new Ft.a;r.id=i.wb.gluepointId(),r.type="custom",n.positionCustomGluePoint(r,a,e);var o=new Gt(r.id,t,r);o.type="custom",n.positionGluePoint(a,r,o),o.addSubscription(o.expand().subscribe((function(){return n.changeSource.next(o)}))),n.customGluepoint=o,n.addSource.next(o),n.state.set("CustomGluePoint",Object(u.j)(n.state.get("CustomGluePoint"),[{shapeId:t,gluepoint:Object(u.a)({},r)}])),o.show().subscribe({next:function(){return n.changeSource.next(o)}})}))},e.prototype.removeCustomGluepoint=function(){var t=this;if(this.customGluepoint){var e=this.customGluepoint;this.customGluepoint=null,this.removeSource.next(e),setTimeout((function(){t.state.set("CustomGluePoint",[])}),300)}},e.prototype.positionCustomGluePoint=function(t,e,i){var a=e.getPositionOnShape(i,n.CUSTOM_SNAP_THRESHOLD);t.x=a.x.value,t.y=a.y.value},e.prototype.hasShape=function(t){return!!this._shapes[t]},e.prototype.getGluePoints=function(t){return this._shapes[t]?this._shapes[t].gluePoints:[]},e.prototype.getGluePoint=function(t,e){return this.getGluePoints(t).find((function(t){return t.gluePointId===e}))},e.prototype.getGluePointFull=function(t){return this.getGluePoint(t,qt.id)},e.prototype.hasGluePoint=function(t,e){return!!this.getGluePoint(t,e)},e.prototype.addGluepoint=function(t,e){var n=this._shapes[t]&&this._shapes[t].gluePoints;if(!n)throw new Error("GluepointHandler: unexpected error: shape data not available");n.push(e)},e.prototype.shouldCreateGluePoint=function(t,e,n){return!this.hasGluePoint(t,e)&&(!n||n&&n.indexOf(e)>-1)},e.prototype.isShapeActive=function(t){return!!this.hasShape(t)&&!!this._shapes[t].shapeActive},e.prototype.isActive=function(t){return this.isShapeActive(t)||this.isAnyGluePointActive(t)},e.prototype.setShapeActive=function(t,e){this._shapes[t]&&(this._shapes[t].shapeActive=e,this.updateGluePointFull(t))},e.prototype.updateGluePointFull=function(t){var e=this,n=this.isShapeActive(t),i=this.getGluePointFull(t);i&&(n&&!i.isActive?i.expand().subscribe((function(){return e.changeSource.next(i)})):!n&&i.isActive&&i.retract().subscribe((function(){return e.changeSource.next(i)})))},e.prototype.isAnyGluePointActive=function(t){return!!this.hasShape(t)&&this.getGluePoints(t).reduce((function(t,e){return t||e.isActive}),!1)},e.prototype.createGluePoint=function(t,e,n,i,a){var r=this;void 0===i&&(i=!1),void 0===a&&(a=!1);var o=i?new qt(e,n):new Gt(n.id,e,n);this.addGluepoint(e,o),this.addSource.next(o),i||this.setupGluePointInteraction(t,o,a),o.show().subscribe((function(){return r.changeSource.next(o)}))},e.prototype.removeGluePoint=function(t){var e=this,n=this._shapes[t.shapeId].gluePoints,i=n.indexOf(t);return n.splice(i,1),t.hide().pipe(Object(g.a)({next:function(){return e.changeSource.next(t)},complete:function(){e.removeSource.next(t),t.destroy()}}))},e.prototype.positionGluePoint=function(t,e,n){var i=n||this.getGluePoint(t.id,e.id);if(i){var a={x:{type:e.xType||"relative",value:e.x},y:{type:e.yType||"relative",value:e.y}},r=vi.a.onViewportRect(a,t.defaultBounds,t.transform);i.setPosition(r),this.changeSource.next(i)}},e.prototype.setupGluePointInteraction=function(t,e,n){this.setupGluePointClickInteraction(t,e,n),this.setupGluePointRollOverInteraction(t,e,n),this.setupGluePointRollOutInteraction(e,n)},e.prototype.resetDiagramPreview=function(){return this.commandService.dispatch(Q.a.resetDiagramPreview)},e.prototype.connectToGluepoint=function(t,e,n){var i=this;return void 0===n&&(n=!1),this.duringConnectorSelection().pipe(Object(d.a)((function(t){return Boolean(t)})),Object(f.a)((function(a){var r=a.getFromEndpoint(t),o=[a.getToEndpoint(t),r].find((function(t){return t.shape&&t.shape.id===e.shapeId}));if(!o)return M.a;var s={connectorId:a.id,endpointId:o.id,shapeId:e.shapeId,gluepointId:e.gluePointId};return n?i.commandService.preview(Zt.a.changeConnectedGluepoint,s):i.commandService.dispatch(Zt.a.changeConnectedGluepoint,s)})))},e.prototype.getOverEvent=function(t){return"mouse"===this._shapes[t].expandOn?"rollover":"endpoint-over"},e.prototype.getOutEvent=function(t){return"mouse"===this._shapes[t].expandOn?"rollout":"endpoint-out"},e.prototype.ensureShapeDataExists=function(t,e,n){var i=this;if(void 0===n&&(n=!1),!this.hasShape(t)){var a=n?this.viewport.getShapeModel(t).pipe(Object(K.a)(1)):this.viewport.getShapeModel(t);this._shapes[t]={gluePoints:[],expandOn:e},this._shapes[t].shapeSub=a.subscribe((function(t){return i.positionGluePoints(t)}))}},e.prototype.setupGluePointClickInteraction=function(t,e,n){var i=this;if(n){var a=Object(X.a)(e,"click").pipe(Object(f.a)((function(){return i.isPreviewingConnect.next(!1),i.connectToGluepoint(t,e,!1)}))).subscribe();e.addSubscription(a)}},e.prototype.setupGluePointRollOverInteraction=function(t,e,n){var i=this,a=Object(X.a)(e,this.getOverEvent(e.shapeId)),r=a.pipe(Object(f.a)((function(t){return e.expand()}))).subscribe((function(){return i.changeSource.next(e)}));if(e.addSubscription(r),n){var o=a.pipe(Object(f.a)((function(){return i.isPreviewingConnect.next(!0),i.connectToGluepoint(t,e,!0)}))).subscribe();e.addSubscription(o)}},e.prototype.setupGluePointRollOutInteraction=function(t,e){var n=this,i=Object(X.a)(t,this.getOutEvent(t.shapeId)),a=i.pipe(Object(f.a)((function(e){return t.retract().pipe(Object(g.a)({complete:function(){n.isActive(t.shapeId)||n.removeGluePointsFor(t.shapeId)}}))}))).subscribe((function(){return n.changeSource.next(t)}));if(t.addSubscription(a),e){var r=i.pipe(Object(f.a)((function(){return n.isPreviewingConnect.next(!1),n.resetDiagramPreview()}))).subscribe();t.addSubscription(r)}},e.CUSTOM_HOVER_TIMEOUT=800,e.CUSTOM_SNAP_THRESHOLD=5,e.\u0275fac=function(t){return new(t||e)(r.qc(i.Mb),r.qc(i.B),r.qc(V.a),r.qc(q.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=n=Object(u.d)([Object(pn.a)(),Object(u.g)("design:paramtypes",[i.Mb,i.B,V.a,q.a])],e)}(pn.b);Object.defineProperty(yi,"name",{value:"GluePointHandler"});var Si=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.color=Ln.a.primarySelectionLineColor,e.thickness=1,e}return Object(u.e)(e,t),e.prototype.drawHightlight=function(t,e){var n=this;this.removeAllChildren();var i=[Object(I.a)({})];if(!Object(x.isEmpty)(t)){var a=this.initRectShape();Object(x.forEach)(t,(function(t){t.isConnector()?i.push(n.drawPathHightlight(t)):i.push(n.drawRectHighLight(a,t,e))}))}return D.a.apply(void 0,Object(u.j)(i))},e.prototype.destroy=function(){},e.prototype.initRectShape=function(){var t=new ht.Shape;return t.graphics.setStrokeStyle(this.thickness).beginStroke(this.color),this.addChild(t),t},e.prototype.drawRectHighLight=function(t,e,n){var a=e.defaultBounds,r=(e.style&&e.style.lineThickness?e.style.lineThickness:0)*n,o=e.transform,s=(null==o?void 0:o.scaleX)||1,c=(null==o?void 0:o.scaleY)||1,l=(Ln.a.selectionLineSpacing+r/2)/Math.abs(s),u=(Ln.a.selectionLineSpacing+r/2)/Math.abs(c),p=-l,d=-u,h=a.width+2*l,g=a.height+2*u,f=i.zb.from({x:p,y:d,width:h,height:g}).getTransformedPoints(o),b=f.topLeft,m=f.topRight,v=f.bottomLeft,y=f.bottomRight;return t.graphics.moveTo(b.x,b.y).lineTo(m.x,m.y).lineTo(y.x,y.y).lineTo(v.x,v.y).lineTo(b.x,b.y),Object(I.a)({})},e.prototype.drawPathHightlight=function(t){var e=this;return mn.g.instance.create(t,bn.a).pipe(Object(g.a)((function(t){t.initialize(),t.graphics.setStrokeStyle(e.thickness).beginStroke(e.color),t.draw(),e.addChild(t.shapeView)})))},e}(ht.Container),Oi=function(t){function e(e,n){var i=t.call(this,e)||this;return i.state=e,i.viewport=n,i.highlightIndicator=new Si,i.addSource=new Se.a,i.removeSource=new Se.a,i.changeSource=new Se.a,i}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"indicators",{get:function(){return[this.highlightIndicator]},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){var t=this,e=Object(D.a)(this.state.changes("Highlighted"),this.state.changes("Selected").pipe(Object(m.a)((function(e){return t.state.get("EditingText").open?[]:e}))),this.state.changes("EditingText").pipe(Object(m.a)((function(e){return e.open?[]:t.state.get("Selected")})))).pipe(Object(d.a)((function(e){return!!t.state.get("CurrentDiagram")})),Object(bt.a)(x.isEqual),Object(f.a)((function(e){return t.viewport.getShapeModels(e).pipe(Object(vt.a)(t.state.changes("Selected").pipe(Object(K.a)(1),Object(d.a)((function(t){return t&&0===t.length})))))}))),n=e.pipe(Object(b.a)(1),Object(g.a)((function(){return t.addSource.next(t.highlightIndicator)}))),i=e.pipe(Object(K.a)(1));this.subs.push(Object(D.a)(n,i).pipe(Object(f.a)((function(e){return t.highlightIndicator.drawHightlight(e,t.state.get("DiagramZoomLevel"))})),Object(g.a)((function(){return t.changeSource.next(t.highlightIndicator)}))).subscribe())},e.prototype.createAddSource=function(){return this.addSource},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){return this.changeSource},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.addSource.complete(),this.addSource=void 0,this.changeSource.complete(),this.changeSource=void 0,this.removeSource.complete(),this.removeSource=void 0},e.removeForPanZoom=!0,e.\u0275fac=function(t){return new(t||e)(r.qc(i.Mb),r.qc(V.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)(),Object(u.g)("design:paramtypes",[i.Mb,V.a])],e)}(pn.b);Object.defineProperty(Oi,"name",{value:"HighlightHandler"});var xi=n("rYDR"),Ci=n("i9xl"),Ti=function(t){function e(e,n){var i=t.call(this)||this;return i.vtod=e,i.dtov=n,i.bounds=new Se.a,i}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"changes",{get:function(){return this.bounds},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this.getDragStart()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){var t=this;return Object(Ci.a)((function(){return t.getDragEnd().pipe(Object(m.a)((function(){var e=t.getBounds();if(e)return new i.zb(e.x,e.y,e.width,e.height)})),Object(d.a)((function(t){return Boolean(t)})))}))},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){this.subs=[],this.alpha=.3,this.subs.push(this.getIndicatorDraw().subscribe())},e.prototype.destroy=function(){for(;this.subs&&this.subs.length>0;)this.subs.pop().unsubscribe()},e.prototype.position=function(t){this.graphics.clear().beginFill("#b4b4b4").drawRect(t.x,t.y,t.width,t.height).endFill(),this.setBounds(t.x,t.y,t.width,t.height),this.bounds.next(t)},e.prototype.calculateBounds=function(t,e,n,a){var r=Math.min(t,n),o=Math.min(e,a),s=Math.abs(t-n),c=Math.abs(e-a);return new i.zb(r,o,s,c)},e.prototype.getIndicatorDraw=function(){var t,e=this;return this.getDragStart().pipe(Object(f.a)((function(n){e.setBounds(0,0,0,0);var i=new ht.Point(n.stageX,n.stageY);t={x:e.vtod.x(i.x),y:e.vtod.y(i.y)};var a=e.getDragEnd().pipe(Object(g.a)((function(){return e.graphics.clear()})));return e.getDrag().pipe(Object(g.a)((function(n){var i=e.calculateBounds(e.dtov.x(t.x),e.dtov.y(t.y),n.stageX,n.stageY);e.position(i)})),Object(vt.a)(a))})))},e.prototype.getDragStart=function(){return this.getGridDragEvent(Qt.start)},e.prototype.getDrag=function(){return this.getGridDragEvent(Qt.drag)},e.prototype.getDragEnd=function(){return this.getGridDragEvent(Qt.end)},e.prototype.getGridDragEvent=function(t){return Object(X.a)(this.parent.parent,t).pipe(Object(m.a)((function(t){return t.relatedEvent})))},e}(ht.Shape),ji=function(t){function e(e,n,i,a,r,o){var s=t.call(this,e)||this;return s.ll=n,s.commandService=i,s.shapeBoundsLocator=a,s.dToVCordinate=r,s.vToDcoordinate=o,s.inProgress=!1,s.selection=new Ti(o,r),s.removeSource=new Se.a,s}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"indicators",{get:function(){return[this.selection]},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.selection.destroy()},e.prototype.setupSelection=function(){var t=this;this.selection.initialize();var e=this.getMultiSelection().subscribe((function(e){return t.selectShapes(e,!0)})),n=this.getHightlight().subscribe(),i=this.getMultiSelectionStart().subscribe();this.subs.push(e,i,n)},e.prototype.getMultiSelection=function(){var t=this;return this.selection.selectionEnd.pipe(Object(m.a)((function(e){return t.getContainedShapeIds(e)})),Object(g.a)((function(){t.selection.setBounds(0,0,0,0),t.state.set("Highlighted",[]),t.inProgress=!1,t.state.set("MultiSelectionInteractionState",Pt.c.Stopped)})))},e.prototype.getMultiSelectionStart=function(){var t=this;return this.selection.selectionStart.pipe(Object(g.a)((function(e){t.state.set("Highlighted",[]),t.selectShapes([],!1)})))},e.prototype.getHightlight=function(){var t=this;return this.selection.changes.pipe(Object(m.a)((function(e){return t.getContainedShapeIds(e)})),Object(g.a)((function(e){t.inProgress||(t.state.set("MultiSelectionInteractionState",Pt.c.Started),t.inProgress=!0),t.state.set("Highlighted",e)})))},e.prototype.getContainedShapeIds=function(t){return t=this.vToDcoordinate.bounds(t),this.shapeBoundsLocator.searchShapes(t.left,t.right,t.top,t.bottom,void 0,!0).map((function(t){return t.id}))},e.prototype.createAddSource=function(){var t=this;return Object(An.a)(0).pipe(Object(Nt.a)(this.selection),Object(g.a)({complete:function(){return t.setupSelection()}}))},e.prototype.createRemoveSource=function(){return Object(xi.b)()},e.prototype.createChangeSource=function(){return Object($t.a)(Object(An.a)(0),Object(D.a)(this.selection.changes,this.selection.selectionEnd)).pipe(Object(Nt.a)(this.selection))},e.prototype.selectShapes=function(t,e){this.commandService.dispatch(O.a.selectShapes,this.state.get("CurrentDiagram"),{shapeIds:t,add:e})},e.\u0275fac=function(t){return new(t||e)(r.qc(i.Mb),r.qc(q.a),r.qc(i.B),r.qc(pe.a),r.qc(G.a),r.qc(wt.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)(),Object(u.g)("design:paramtypes",[i.Mb,q.a,i.B,pe.a,G.a,wt.a])],e)}(pn.b);Object.defineProperty(ji,"name",{value:"MultiSelectionHandler"});var Pi,wi=function(t){function e(e,n,i){var a=t.call(this)||this;return a.container=e,a.state=n,a.restriction=i,a.prepare(),a}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"selectedIds",{get:function(){return this.container.selectedIds},enumerable:!1,configurable:!0}),e.prototype.isSingleSelection=function(t){return this.container.isSelected(t)&&1===this.container.selectionCount},e.prototype.refresh=function(){this.container.selectionType!==Lt.None&&this.redraw()},e.prototype.destroy=function(){this.move.destroy(),this.container.destroy(),this.removeAllChildren()},e.prototype.getInteractionStart=function(){var t=this;return this.getShapeDragEvent("shapeDragMove").pipe(Object(d.a)((function(){return!t.move.inProgress})))},e.prototype.getImmediateInteraction=function(){var t=this;return Object(X.a)(this,"added").pipe(Object(f.a)((function(){return Object(X.a)(t.parent.parent,"keyboardSelectionInteraction")})),Object(m.a)((function(e){var n=e.relatedEvent;return n.handle=t,n})))},e.prototype.getInteraction=function(){var t=this;return this.getShapeDragEvent("shapeDragMove").pipe(Object(d.a)((function(){return t.move.inProgress})))},e.prototype.getInteractionEnd=function(){return this.getShapeDragEvent("shapeDragEnd")},e.prototype.prepare=function(){this.addChild(this.container),this.move=new ie(this.container,this.state,this.restriction),this.move.register(this)},e.prototype.redraw=function(){this.container.selectionType!==Lt.MultiShape?this.container.position():this.interactionInProgress||this.container.position()},e.prototype.getShapeDragEvent=function(t){var e=this;return Object(X.a)(this,"added").pipe(Object(f.a)((function(){return Object(X.a)(e.parent.parent,t)})),Object(d.a)((function(t){return e.container.isSelected(t.relatedShape.name)})),Object(m.a)((function(t){var n=t.relatedMouseEvent.clone();return n.data=t.relatedMouseEvent.data,n.target=e,n.startX=t.startX,n.startY=t.startY,n})))},e}(ht.Container),Mi=function(t){function e(){var n=t.call(this)||this;return n.radius=e.RADIOUS,n.refresh(),n.beginRender(),n.render(),n.endRender(),n}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"selection",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"indicatorLayer",{get:function(){if(this.selection&&this.selection.parent&&this.selection.parent.parent)return this.selection.parent.parent},enumerable:!1,configurable:!0}),e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.setMovement=function(t){this.movement=t},e.prototype.getMovement=function(){return this.movement},e.prototype.beginRender=function(){this.graphics.clear(),this.graphics.beginStroke(Ln.a.primarySelectionHandleColor),this.graphics.beginFill("white")},e.prototype.render=function(){this.graphics.drawRoundRect(-4,-4,8,8,1),this.setBounds(-this.radius,-this.radius,2*this.radius,2*this.radius)},e.prototype.endRender=function(){this.graphics.endFill(),this.graphics.endStroke()},e.prototype.refresh=function(){this.beginRender(),this.render(),this.endRender()},e.prototype.getHitPoints=function(){var t=this;return Object(x.range)(0,360,22.5).map((function(e){return{x:t.radius*Math.sin(2*Math.PI*e/360),y:t.radius*Math.cos(2*Math.PI*e/360)}}))},e.prototype.getInteractionStart=function(){var t=this;return this.waitUntilAddedToCanvas().pipe(Object(f.a)((function(){return Object(X.a)(t,"mousedown")})),Object(m.a)((function(t){return t.preventDefault(),t})))},e.prototype.getImmediateInteraction=function(){return Object(M.b)()},e.prototype.getInteraction=function(){var t=this;return this.waitUntilAddedToCanvas().pipe(Object(f.a)((function(){return Object(X.a)(t,"mousedown")})),Object(f.a)((function(){return Object(X.a)(t.indicatorLayer,"stagemousemove").pipe(Object(m.a)((function(e){return e.target=t,e})),Object(vt.a)(Object(X.a)(t.indicatorLayer,"stagemouseup")))})))},e.prototype.getInteractionEnd=function(){var t=this;return this.waitUntilAddedToCanvas().pipe(Object(f.a)((function(){return Object(X.a)(t,"mousedown")})),Object(f.a)((function(){return Object(X.a)(t.indicatorLayer,"stagemouseup").pipe(Object(b.a)(1))})),Object(m.a)((function(e){return e.preventDefault(),e.target=t,e})))},e.prototype.waitUntilAddedToCanvas=function(){var t=this;return this.selection?this.indicatorLayer?Object(I.a)(null):Object(X.a)(this.selection,"added").pipe(Object(f.a)((function(){return t.waitUntilAddedToCanvas()}))):Object(X.a)(this,"added").pipe(Object(f.a)((function(){return t.waitUntilAddedToCanvas()})))},e.RADIOUS=5,e}(ht.Shape),Ii=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),e.getName=function(t,e){return"X"+t+"Y"+e},e.prototype.beginRender=function(){this.graphics.clear(),this.xPosition===i.xb.Middle||this.yPosition===i.xb.Middle?this.graphics.beginFill("rgba(0,0,0,0.01)"):t.prototype.beginRender.call(this)},e.prototype.render=function(){this.xPosition===i.xb.Middle||this.yPosition===i.xb.Middle?(this.graphics.drawRect(-this.radius,-this.radius,2*this.radius,2*this.radius),this.setBounds(-this.radius,-this.radius,2*this.radius,2*this.radius)):t.prototype.render.call(this)},e.prototype.getCursor=function(t){return this.getScaleHandleCursor()},e.prototype.configurePosition=function(t,n){this.xPosition=t,this.yPosition=n,this.name=e.getName(this.xPosition,this.yPosition),this.refresh()},e.prototype.position=function(t,e,n){var a=e.decompose(),r=this.xPosition?this.xPosition*t.width:t.x,o=this.yPosition?this.yPosition*t.height:t.y,s=e.transformPoint(r,o),c=s.x,l=s.y;this.x=c,this.y=l,this.xPosition===i.xb.Middle&&(this.scaleX=a.scaleX*t.width/(2*this.radius)),this.yPosition===i.xb.Middle&&(this.scaleY=a.scaleY*t.height/(2*this.radius)),this.rotation=n},e.prototype.getImmediateInteraction=function(){return Object(M.b)()},e.prototype.getScaleHandleCursor=function(){var t="nwse-resize",e="nesw-resize",n="ew-resize",i="ns-resize";return(this.rotation>=45&&this.rotation<=135||this.rotation>=-135&&this.rotation<=-45)&&(t="nesw-resize",e="nwse-resize",n="ns-resize",i="ew-resize"),0===this.xPosition&&0===this.yPosition||1===this.xPosition&&1===this.yPosition?{cursor:t,tail:null,type:"css"}:1===this.xPosition&&0===this.yPosition||0===this.xPosition&&1===this.yPosition?{cursor:e,tail:null,type:"css"}:0===this.xPosition&&.5===this.yPosition||1===this.xPosition&&.5===this.yPosition?{cursor:n,tail:null,type:"css"}:{cursor:i,tail:null,type:"css"}},e}(Mi),Ei=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"ScaleInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionContainer",{get:function(){return this.container},enumerable:!1,configurable:!0}),e.prototype.interactionStart=function(t){var e=t.target;this.setRegistration(e)},e.prototype.interactionEnd=function(t){i.Ob.track("canvas.selection.scale.change"),this.setScaleXState(Pt.d.Stopped),this.container.reg.reset()},e.prototype.interactionCancel=function(t){this.setScaleXState(Pt.d.Stopped),this.container.reg.reset()},e.prototype.interaction=function(t){var e,n,a=t.target,r=this.restriction.pointOnViewport({x:t.stageX,y:t.stageY},["GridService"]),o=this.getOpposingXHandle(a),s=this.getOpposingYHandle(a),c=t.nativeEvent.shiftKey||this.selectionContainer.transformSettings&&this.selectionContainer.transformSettings.fixAspectRatio,l={scaleX:this.container.scaleX,scaleY:this.container.scaleY,x:this.container.x,y:this.container.y,angle:this.container.rotation,skewX:this.container.skewX,skewY:this.container.skewY};if(a.yPosition===i.xb.Origin?a.y-=this.selectionContainer.outerBoundsSpacing.yStart:a.yPosition===i.xb.End&&(a.y-=this.selectionContainer.outerBoundsSpacing.yEnd),a.xPosition===i.xb.Origin?a.x-=this.selectionContainer.outerBoundsSpacing.xStart:a.xPosition===i.xb.End&&(a.x-=this.selectionContainer.outerBoundsSpacing.xEnd),a!==o&&(e=this.getScaleChangeToMouse(a,o,r)),a!==s&&(n=this.getScaleChangeToMouse(a,s,r)),this.selectionContainer.isSingleSelection||this.selectionContainer.isMultiSelection){var u=this.selectionContainer.selectedShape.defId;"creately.basic.rasterimage"!==u&&"creately.basic.vectorimage"!==u||(c=!c)}if(c){if(void 0!==e&&void 0===n)l.scaleX*=e,l.scaleY*=e;else if(void 0!==n&&void 0===e)l.scaleX*=n,l.scaleY*=n;else if(void 0!==e&&void 0!==n){var p=Math.max(e||0,n||0);l.scaleX=l.scaleX*p,l.scaleY=l.scaleY*p}}else void 0!==e&&(l.scaleX*=e),void 0!==n&&(l.scaleY*=n);if(this.selectionContainer.isSingleSelection){var d=this.restriction.shapeTransform(this.selectionContainer.selectedShape,l,["ShapeBounds"]);l.scaleX=d.scaleX,l.scaleY=d.scaleY}this.container.scaleX!==l.scaleX&&(this.setScaleXState(Pt.d.Started),this.container.scaleX=l.scaleX),this.container.scaleY!==l.scaleY&&(this.container.scaleY=l.scaleY)},e.prototype.setScaleXState=function(t){this.state.get("SelectionInteractionStateScaleX")!==t&&this.state.set("SelectionInteractionStateScaleX",t)},e.prototype.interactionImmediate=function(t){this.setScaleXState(Pt.d.Started);var e=ee.a.gridSize*this.state.get("DiagramZoomLevel"),n=this.container.getTransformedBounds(),i=this.container.getBounds();if(i&&n){var a=this.getDirectionByKeycode(t.keyCode),r=a.xDirection,o=a.yDirection,s=n.width+n.x+e*r,c=n.height+n.y+e*o,l=this.restriction.pointOnViewport({x:s,y:c},["GridService"]),u=l.x,p=l.y;r&&u!==n.x&&(this.container.scaleX=(u-n.x)/i.width,this.selectionContainer.transformSettings&&this.selectionContainer.transformSettings.fixAspectRatio&&(this.container.scaleY=this.container.scaleX)),o&&p!==n.y&&(this.container.scaleY=(p-n.y)/i.height,this.selectionContainer.transformSettings&&this.selectionContainer.transformSettings.fixAspectRatio&&(this.container.scaleX=this.container.scaleY)),this.interactionEnd(null),this.setScaleXState(Pt.d.Stopped)}},e.prototype.setRegistration=function(t){var e=this.getOpposingHandle(t),n=this.container.getBounds();this.container.reg.change(e.xPosition*n.width,e.yPosition*n.height)},e.prototype.getOpposingHandle=function(t){var e=Math.abs(t.xPosition-1),n=Math.abs(t.yPosition-1);return t.parent.getChildByName(Ii.getName(e,n))},e.prototype.getOpposingXHandle=function(t){var e=Math.abs(t.xPosition-1),n=t.yPosition;return t.parent.getChildByName(Ii.getName(e,n))},e.prototype.getOpposingYHandle=function(t){var e=t.xPosition,n=Math.abs(t.yPosition-1);return t.parent.getChildByName(Ii.getName(e,n))},e.prototype.getScaleChangeToMouse=function(t,e,n){var i=this.restriction.pointOnViewport({x:n.x,y:n.y},["SelectionScaleSnap"]),a=i.x,r=i.y,o=this.identifyThePointToScaleTo(t,e,{x:a,y:r});return this.getScaleChange(t,e,o)},e.prototype.identifyThePointToScaleTo=function(t,e,n){return new i.fb(new i.qb(e.x,e.y),new i.qb(t.x,t.y)).perpendicularTo(n)},e.prototype.getScaleChange=function(t,e,n){var a=new i.qb(e.x,e.y),r=new i.qb(t.x,t.y),o=0===a.distanceTo(r)?1:a.distanceTo(r),s=r.distanceTo(n),c=0===a.distanceTo(n)?1:a.distanceTo(n);return 2*s>o+c?-c/o:c/o},e}(ne),Di=n("5uDM"),ki=function(t){function e(e,n,i){var a=t.call(this,e,n,i)||this;return a.container=e,a.state=n,a.restriction=i,a}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"VisualVectorInteraction"},enumerable:!1,configurable:!0}),e.prototype.restrictWithInShapeBounds=function(t,e){var n=this.container.selectedShapeList.find((function(e){return e.id===t})),a=n.transform,r=n.defaultBounds,o=r.x,s=r.x+r.width,c=r.y,l=r.y+r.height;return(e=i.jb.fromTransform(a).invert().transformPoint(e.x,e.y)).x=e.x<o?o:e.x>s?s:e.x,e.y=e.y<c?c:e.y>l?l:e.y,{x:(e=i.jb.fromTransform(a).transform(e.x,e.y)).x,y:e.y}},e.prototype.interactionStart=function(t){},e.prototype.interaction=function(t){this.updatePreviewData(t)},e.prototype.interactionImmediate=function(t){},e.prototype.interactionEnd=function(t){this.updatePreviewData(t)},e.prototype.interactionCancel=function(t){},e.prototype.updatePreviewData=function(t){var e=this,n=t.target,i=this.container.selectedShape.id,a={vectorId:n.name,points:[]},r=this.restriction.pointOnViewport({x:t.stageX,y:t.stageY},["GridService"]),o=r.x,s=r.y,c=this.restriction.pointOnViewport({x:o,y:s},["SelectionMoveSnap"]),l={x:c.x,y:c.y};n.isWithInBounds()&&(l=this.restrictWithInShapeBounds(i,l)),a.points=n.points.map((function(t){return e.restrictMovement(i,n.getMovement(),{x:t.x,y:t.y},l)})),this.container.previewVectorData=a},e}(ne),Ai=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),e.prototype.beginRender=function(){this.graphics.beginStroke(Ln.a.primarySelectionHandleColor),this.graphics.beginFill("white")},e.prototype.render=function(){t.prototype.render.call(this),this.graphics.setStrokeDash(Ln.a.selectionBoundDashStyle),this.graphics.moveTo(this.radius,-this.radius),this.graphics.lineTo(e.LINE_END,-e.LINE_END)},e.prototype.getCursor=function(t){return{cursor:"default",tail:null,type:"css",viewingArea:"app"}},e.prototype.position=function(t,n){var a=i.jb.fromMatrix(n).toTransform(),r=n.transformPoint(t.x-e.DISTANCE/Math.abs(a.scaleX),t.height+e.DISTANCE/Math.abs(a.scaleY));this.x=r.x,this.y=r.y,this.rotation=a.angle+(a.scaleX<0?a.scaleY<0?0:-90:a.scaleY<0?90:0)},e.DISTANCE=25*Math.cos(Math.PI/4),e.LINE_END=e.DISTANCE-e.RADIOUS+1,e}(Mi),_i=function(t){function e(e,n,i){var a=t.call(this,e,n,i)||this;return a.container=e,a.state=n,a.restriction=i,a}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"RotationInteraction"},enumerable:!1,configurable:!0}),e.prototype.interactionStart=function(t){this.setRegistration()},e.prototype.interaction=function(t){var e=t.target,n=this.container.getBounds(),a=this.container.getMatrix().transformPoint(n.width/2,n.height/2),r=new i.fb(a,{x:e.x,y:e.y}).angle,o=new i.fb(a,{x:t.stageX,y:t.stageY}).angle,s=this.container.rotation+(o-r);this.container.rotation=this.snapToAngle(s,t.nativeEvent.shiftKey)},e.prototype.snapToAngle=function(t,n){if(n)return Math.round(t/e.SNAP_ON_SHIFT_ANGLE)*e.SNAP_ON_SHIFT_ANGLE;var i=Math.abs(t%90);return i<e.SNAP_REGULAR_ANGLE||i>90-e.SNAP_REGULAR_ANGLE?90*Math.round(t/90):t},e.prototype.interactionImmediate=function(t){},e.prototype.interactionEnd=function(t){i.Ob.track("canvas.selection.rotate.change"),this.container.reg.reset()},e.prototype.interactionCancel=function(t){this.container.reg.reset()},e.prototype.setRegistration=function(){var t=this.container.getBounds();this.container.reg.change(t.width/2,t.height/2)},e.SNAP_REGULAR_ANGLE=5,e.SNAP_ON_SHIFT_ANGLE=15,e}(ne),Li=function(t){function e(e){var n=t.call(this)||this;return n.name=e.id,n.movement=e.movement,n.withInBounds=e.withInBounds,n.updateHandle(e),n}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return[{x:this.x,y:this.y}]},enumerable:!1,configurable:!0}),e.prototype.updateHandle=function(t){this.name=t.id,this.movement=t.movement,this.withInBounds=t.withInBounds,this.setPosition(t.points[0].x,t.points[0].y)},e.prototype.isWithInBounds=function(){return this.withInBounds},e.prototype.beginRender=function(){this.graphics.beginStroke(Ln.a.secondarySelectionHandleColor),this.graphics.beginFill("white")},e.prototype.getCursor=function(t){switch(this.movement){case"vertical":return{cursor:"ns-resize",tail:null,type:"css"};case"horizontal":return{cursor:"ew-resize",tail:null,type:"css"};case"diagonal-nesw":return{cursor:"nesw-resize",tail:null,type:"css"};case"diagonal-nwse":return{cursor:"nwse-resize",tail:null,type:"css"};case"free":default:return{cursor:"default",tail:null,type:"css",viewingArea:"app"}}},e}(Mi),Ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return[{x:this.x,y:this.y},{x:this.x2,y:this.y2}]},enumerable:!1,configurable:!0}),e.prototype.updateHandle=function(e){t.prototype.updateHandle.call(this,e),this.x2=e.points[1].x,this.y2=e.points[1].y,this.graphics.clear(),this.beginRender(),this.render(),this.endRender()},e.prototype.render=function(){var t=this.x2-this.x,e=this.y2-this.y,n=this.getDelta();this.graphics.moveTo(-n.x,-n.y),this.graphics.lineTo(t-n.x,e-n.y),this.graphics.lineTo(t+n.x,e+n.y),this.graphics.lineTo(n.x,n.y),this.graphics.lineTo(-n.x,-n.y),this.setBounds(0,0,t+2*n.x,e+2*n.y),this.alpha=.01},e.prototype.getHitPoints=function(){var t=this.x2-this.x,e=this.y2-this.y,n=this.getDelta();return[{x:-n.x,y:-n.y},{x:t-n.x,y:e-n.y},{x:t+n.x,y:e+n.y},{x:n.x,y:n.y}]},e.prototype.getDelta=function(){return this.x2-this.x>this.y2-this.y?{x:0,y:e.HANDLE_WIDTH}:{x:e.HANDLE_WIDTH,y:0}},e.HANDLE_WIDTH=2,e}(Li),Bi=function(){function t(){}return t.create=function(t){if(1===t.points.length)return new Li(t);if(2===t.points.length)return new Ri(t);throw new Error("Invalid vector data.")},t}(),Hi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),e.prototype.position=function(t,e){var n=e.transformPoint(t.x,t.y),i=e.transformPoint(t.width,t.y),a=e.transformPoint(t.x,t.height),r=e.transformPoint(t.width,t.height);this.graphics.clear().beginStroke(Ln.a.primarySelectionLineColor).moveTo(n.x,n.y).lineTo(i.x,i.y).lineTo(r.x,r.y).lineTo(a.x,a.y).lineTo(n.x,n.y).closePath().endStroke()},e}(ht.Shape),Fi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Selection",e.vectorHandles={},e}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"interactionInProgress",{get:function(){return this.scaleInteraction.inProgress||this.move.inProgress||this.rotationInteraction.inProgress},enumerable:!1,configurable:!0}),e.prototype.outerBounds=function(){var t=this,e=this.container.getBounds(),n=this.state.get("DiagramZoomLevel");if(this.container.isSingleSelection){var i=this.container.selectedShape.style.lineThickness*n,a=(i/2+Ln.a.selectionLineSpacing)/Math.abs(this.container.selectedShape.scaleX),r=(i/2+Ln.a.selectionLineSpacing)/Math.abs(this.container.selectedShape.scaleY);e.x=e.x-a,e.y=e.y-r,e.width=e.width+a,e.height=e.height+r}else if(this.container.children.length){var o=[],s=[],c=[],l=[];this.container.children.forEach((function(e){var i=t.container.selectedShapes[e.name],a=e.getTransformedBounds(),r=i.style.lineThickness*n,u=r/2+Ln.a.selectionLineSpacing,p=r/2+Ln.a.selectionLineSpacing;o.push(a.x-u/Math.abs(t.container.scaleX)),s.push(a.y-p/Math.abs(t.container.scaleY)),c.push(a.x+a.width+u/Math.abs(t.container.scaleX)),l.push(a.y+a.height+p/Math.abs(t.container.scaleY))})),e.x=Math.min.apply(Math,Object(u.j)(o)),e.y=Math.min.apply(Math,Object(u.j)(s)),e.width=Math.max.apply(Math,Object(u.j)(c)),e.height=Math.max.apply(Math,Object(u.j)(l))}var p=this.container.getBounds();return this.container.outerBoundsSpacing={xStart:(e.x-p.x)*this.container.scaleX,yStart:(e.y-p.y)*this.container.scaleY,xEnd:(e.width-p.width)*this.container.scaleX,yEnd:(e.height-p.height)*this.container.scaleY},e},e.prototype.startShapeMovement=function(t){var e=this;void 0===t&&(t=!1);var n=Object(D.a)(Object(X.a)(this.parent.parent,"stagemousedown"),Object(I.a)(!0).pipe(Object(yt.a)(200),Object(Di.a)((function(){return Object(X.a)(e.parent.parent,"stagemouseup")})))).pipe(Object(b.a)(1));return Object(D.a)(Object(X.a)(this.parent.parent,"stagemousemove").pipe(Object(vt.a)(n)),n).pipe(Object(vt.a)(Object(X.a)(this,"removed")),Object(g.a)((function(n){if(t&&!e.move.inProgress){var i=e.container.getTransformedBounds();e.container.x=-i.width/2+n.stageX,e.container.y=-i.height/2+n.stageY}var a="stagemousemove"===n.type?"shapeDragMove":"shapeDragEnd",r=new be(a,n);r.relatedShape={name:e.container.selectedIds[0]},e.parent.parent.dispatchEvent(r)})))},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.scaleInteraction.destroy(),this.visualVector.destroy(),this.rotationInteraction.destroy()},e.prototype.setHandlesVisibility=function(t){for(var e in this.rotationHandle&&(this.rotationHandle.visible=t),this.scaleHandles||{})this.scaleHandles[e]&&(this.scaleHandles[e].visible=t);for(var n in this.vectorHandles||{})for(var e in this.vectorHandles[n]||{})this.vectorHandles[n][e]&&(this.vectorHandles[n][e].visible=t)},e.prototype.prepare=function(){t.prototype.prepare.call(this),this.border=new Hi,this.addChild(this.border),this.createVectorHandles(),this.prepareScaleInteraction(),this.createRotationHandle()},e.prototype.redraw=function(){t.prototype.redraw.call(this),this.container.isSingleSelection?this.border.graphics.clear():this.border.position(this.outerBounds(),this.container.getMatrix()),this.updateVectorHandles(),this.createScaleHandles(),this.positionScaleHandles(),this.updateRotationHandle()},e.prototype.prepareScaleInteraction=function(){this.scaleHandles={},this.scaleInteraction=new Ei(this.container,this.state,this.restriction)},e.prototype.createScaleHandles=function(){var t=this.container.isSingleSelection,e=t?this.container.selectedShape:null;!t||e.transformSettings.hScale?(this.createScaleHandle(i.xb.Origin,i.xb.Middle),this.createScaleHandle(i.xb.End,i.xb.Middle)):(this.removeScaleHandle(i.xb.Origin,i.xb.Middle),this.removeScaleHandle(i.xb.End,i.xb.Middle)),!t||e.transformSettings.vScale?(this.createScaleHandle(i.xb.Middle,i.xb.Origin),this.createScaleHandle(i.xb.Middle,i.xb.End)):(this.removeScaleHandle(i.xb.Middle,i.xb.Origin),this.removeScaleHandle(i.xb.Middle,i.xb.End)),!t||e.transformSettings.hScale||e.transformSettings.vScale?(this.createScaleHandle(i.xb.Origin,i.xb.Origin),this.createScaleHandle(i.xb.Origin,i.xb.End),this.createScaleHandle(i.xb.End,i.xb.Origin),this.createScaleHandle(i.xb.End,i.xb.End)):(this.removeScaleHandle(i.xb.Origin,i.xb.Origin),this.removeScaleHandle(i.xb.Origin,i.xb.End),this.removeScaleHandle(i.xb.End,i.xb.Origin),this.removeScaleHandle(i.xb.End,i.xb.End))},e.prototype.createScaleHandle=function(t,e){var n="X"+t+"Y"+e;if(!this.scaleHandles[n]){var i=new Ii;i.configurePosition(t,e),this.addChild(i),this.scaleHandles[n]=i,this.scaleInteraction.register(i)}},e.prototype.removeScaleHandle=function(t,e){var n="X"+t+"Y"+e,i=this.scaleHandles[n];i&&(this.removeChild(i),this.scaleInteraction.unregister(i),delete this.scaleHandles[n])},e.prototype.positionScaleHandles=function(){var t=this.outerBounds(),e=this.container.getMatrix(),n=this.container.rotation;for(var i in this.scaleHandles){var a=this.scaleHandles[i];a.position(t,e,n),a.refresh()}this.sortChildren((function(t,e){return t instanceof Ii&&!(e instanceof Ii)?1:!(t instanceof Ii)&&e instanceof Ii?-1:0}))},e.prototype.createAndRegisterVectorHandle=function(t){var e=Bi.create(t);return this.addChild(e),this.visualVector.register(e),e},e.prototype.createVectorHandles=function(){var t=this;this.visualVector=new ki(this.container,this.state,this.restriction);var e=this.container.getVisualVectorData();Object(x.keys)(e).forEach((function(n){t.vectorHandles[n]={},Object(x.values)(e[n]).forEach((function(e){t.vectorHandles[n][e.id]=t.createAndRegisterVectorHandle(e)}))}))},e.prototype.updateVectorHandles=function(){var t=this,e=this.container.getVisualVectorData();this.destroyRemovedVectorHandles(e),Object(x.keys)(e).forEach((function(n){t.vectorHandles[n]?Object(x.keys)(e[n]).forEach((function(i){var a=e[n][i];t.vectorHandles[n][i]?t.vectorHandles[n][i].updateHandle(a):t.vectorHandles[n][i]=t.createAndRegisterVectorHandle(a)})):(t.vectorHandles[n]={},Object(x.values)(e[n]).forEach((function(e){t.vectorHandles[n][e.id]=t.createAndRegisterVectorHandle(e)})))}))},e.prototype.destroyRemovedVectorHandles=function(t){var e=this;Object(x.keys)(this.vectorHandles).forEach((function(n){t[n]?Object(x.keys)(e.vectorHandles[n]).forEach((function(i){t[n][i]||(e.removeChild(e.vectorHandles[n][i]),delete e.vectorHandles[n][i])})):(Object(x.values)(e.vectorHandles[n]).forEach((function(t){return e.removeChild(t)})),delete e.vectorHandles[n])}))},e.prototype.createRotationHandle=function(){this.createRotationInteraction(),this.rotationHandle=new Ai,this.addChild(this.rotationHandle),this.rotationInteraction.register(this.rotationHandle)},e.prototype.createRotationInteraction=function(){this.rotationInteraction=new _i(this.container,this.state,this.restriction)},e.prototype.updateRotationHandle=function(){if(this.rotationHandle&&this.container.canRotate()){this.rotationHandle.visible=!0;var t=this.outerBounds(),e=this.container.getMatrix();this.rotationHandle.position(t,e)}else this.rotationHandle&&(this.rotationHandle.visible=!1)},e}(wi),Ni=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"selectionType",{get:function(){var t=this.selectionCount;return t>1?Lt.MultiShape:1===t?Lt.SingleShape:Lt.None},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSingleSelection",{get:function(){return this.selectionType===Lt.SingleShape},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMultiSelection",{get:function(){return this.selectionType===Lt.MultiShape},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedShape",{get:function(){if(this.isSingleSelection)return this.selectedShapes[this.selectedIds[0]];if(this.isMultiSelection)return this.selectedShapes[this.selectedIds[0]];throw Error("Single selected shape should not be used when there are multiple selected")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transformSettings",{get:function(){return this.selectedShapeList.reduce((function(t,e){return e instanceof Ut.a&&e.transformSettings&&(t?(t.fixAspectRatio=t.fixAspectRatio||e.transformSettings.fixAspectRatio,t.hScale=t.hScale&&e.transformSettings.hScale,t.vScale=t.vScale&&e.transformSettings.vScale,t.rotate=t.rotate&&e.transformSettings.rotate):t=Object(u.a)({},e.transformSettings)),t}),null)},enumerable:!1,configurable:!0}),e.prototype.position=function(){this.isSingleSelection?this.positionSingle():this.positionMultiple()},e.prototype.previewInteraction=function(t){return this.previewVectorData?this.fireVectorChange(!0):this.fireTransformCommand(!0,void 0,t)},e.prototype.completeInteraction=function(t,e){if(this.previewVectorData)return this.fireVectorChange(!1);var n=this.fireTransformCommand(!1,t,e);return this.resetCachedConnectorMatrices(),n},e.prototype.getVisualVectorData=function(){var t={};return this.isSingleSelection&&this.selectedShapes?(Object(x.values)(this.selectedShapes).forEach((function(e){e instanceof Ut.a&&e.vectors&&(t[e.id]={},Object(x.values)(e.vectors).forEach((function(n){if(n.getVectorData){var i=n.getVectorData(e.defaultBounds,e.transform);t[e.id][i.id]=i}})))})),t):t},e.prototype.canRotate=function(){return!this.selectedShapeList.find((function(t){return t instanceof Ut.a&&!t.transformSettings.rotate}))},e.prototype.positionSingle=function(){var t=this.selectedShape;this.setTranslation(t),this.setTransformation(t),this.updateChild(t,!1)},e.prototype.positionMultiple=function(){var t=this;this.resetTransformation();var e=this.selectedShapeList,n=e.map((function(t){return t.bounds}));this.setMinimumTranslation(n),e.forEach((function(e){t.updateChild(e,!0)}))},e.prototype.updateChild=function(t,e){var n=this.getChildByName(t.id);n.setDefaultBounds(t),e?(n.setTranslation(t),n.setTransformation(t)):n.resetTransformation()},e.prototype.setTranslation=function(t){if(t instanceof Ut.a&&this.setTranslationByValues(t.x,t.y,t.scaleX,t.scaleY,t.angle),t instanceof Xt.a){var e=t.bounds,n=e.x,i=e.y;this.setTranslationByValues(n,i)}},e.prototype.setTranslationByValues=function(t,e,n,a,r,o,s){void 0===n&&(n=1),void 0===a&&(a=1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0);var c=new i.jb;c.appendTransform(t,e,n,a,r,o,s,0,0);var l=c.transformPoint(this.regX,this.regY);this.x=l.x,this.y=l.y},e.prototype.setMinimumTranslation=function(t){var e=t[0].x,n=t[0].y;t.forEach((function(t){e=Math.min(t.x,e),n=Math.min(t.y,n)})),this.setTranslationByValues(e,n)},e.prototype.setTransformation=function(t){t instanceof Ut.a&&(this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.rotation=t.angle)},e.prototype.resetTransformation=function(){this.scaleX=1,this.scaleY=1,this.rotation=0},e.prototype.fireTransformCommand=function(t,e,n){var i=this,a=this.getShapeMatrices(),r=this.getConnectorMatrices(t,e);if(!Object.keys(a).length&&!Object.keys(r).length)return Object(M.b)();var o=Zt.a.transformShapesAndConnectors,s={shapes:a,connectors:r,handle:{name:n.name}};return t||Object.values(this.selectedShapes).forEach((function(t){t.type===C.u.Image&&t.hash&&i.commandService.dispatch(Q.a.uploadScaledImage,{shapeId:t.id})})),this.fireCommandEvent(o,s,t)},e.prototype.fireVectorChange=function(t){var e=Zt.a.moveVisualVector,n={shapeId:this.selectedShape.id,vectorId:this.previewVectorData.vectorId,points:this.previewVectorData.points};return this.previewVectorData=null,this.fireCommandEvent(e,n,t)},e.prototype.fireCommandEvent=function(t,e,n){var i=n?"preview":"dispatch";return this.commandService[i](t,e)},e}(Wt),Gi=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"pointId",{get:function(){return this.name},enumerable:!1,configurable:!0}),e.prototype.getCursor=function(t){return{cursor:"default",tail:null,type:"css",viewingArea:"app"}},e}(Mi),qi=function(t){function e(e){var n=t.call(this)||this;return n.name=e,n}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"pointId",{get:function(){return this.name},enumerable:!1,configurable:!0}),e.prototype.getCursor=function(t){return{cursor:"default",tail:null,type:"css",viewingArea:"app"}},e.prototype.getEndpointOver=function(){var t=this;return this.waitUntilAddedToCanvas().pipe(Object(f.a)((function(){return Object(X.a)(t.indicatorLayer,"endpoint-over")})))},e.prototype.getEndpointOut=function(){var t=this;return this.waitUntilAddedToCanvas().pipe(Object(f.a)((function(){return Object(X.a)(t.indicatorLayer,"endpoint-out")})))},e}(Mi),Vi=function(t){function e(e){var n=t.call(this)||this;return n.previousPointId=e,n.name="bp-"+e,n}return Object(u.e)(e,t),e.prototype.getCursor=function(t){return null},e}(Mi),Ui=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"PathPointMoveInteraction"},enumerable:!1,configurable:!0}),e.prototype.interaction=function(t){var e=t.target,n=this.restriction.pointOnViewport({x:t.stageX,y:t.stageY},["GridService"]),i=n.x,a=n.y,r=this.restriction.pointOnViewport({x:i,y:a},["SelectionMoveSnap"]);this.container.onPathPointMove(e.pointId,{x:r.x,y:r.y})},e.prototype.interactionEnd=function(e){t.prototype.interactionEnd.call(this,e);var n=e.target,i=this.restriction.pointOnViewport({x:e.stageX,y:e.stageY},["GridService"]),a=i.x,r=i.y,o=this.restriction.pointOnViewport({x:a,y:r},["SelectionMoveSnap"]);this.container.onPathPointDrop(n.pointId,{x:o.x,y:o.y})},e}(ae),zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"interactionInProgress",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.startEndpointMovement=function(t){var e=this.endPointHandles.get(t);if(!e)throw new Error("Unable to find endpoint handle with given id");var n=new ht.Event("mousedown",!1,!0);e.dispatchEvent(n),this.stage.dispatchEvent(new ht.MouseEvent("stagemousemove",!1,!0,this.stage.mouseX,this.stage.mouseY,null,null,!1,this.stage.mouseX,this.stage.mouseY))},e.prototype.setHandlesVisibility=function(t){var e=this.endPointHandles?this.endPointHandles.getAll():{};for(var n in e||{})e[n].visible=t;var i=this.pathPointHandles?this.pathPointHandles.getAll():{};for(var n in i||{})i[n].visible=t;var a=this.breakPointHandles?this.breakPointHandles.getAll():{};for(var n in a||{})a[n].visible=t},e.prototype.getTransformedBounds=function(){var e=this.container.selectedShape.bounds;return this.setBounds(e.x,e.y,e.width,e.height),t.prototype.getTransformedBounds.call(this)},e.prototype.prepare=function(){t.prototype.prepare.call(this),this.prepareInteractions(),this.prepareHandleMaps(),this.updateHandles()},e.prototype.redraw=function(){t.prototype.redraw.call(this),this.updateHandles()},e.prototype.prepareInteractions=function(){this.endPointMove=new se(this.container,this.state,this.restriction),this.pathPointMove=new Ui(this.container,this.state,this.restriction)},e.prototype.prepareHandleMaps=function(){this.endPointHandles=new i.ib,this.endPointHandles.onCreate=this.createEndPointHandle.bind(this),this.endPointHandles.onUpdate=this.updateEndPointHandle.bind(this),this.endPointHandles.onDelete=this.deleteEndPointHandle.bind(this),this.pathPointHandles=new i.ib,this.pathPointHandles.onCreate=this.createPathPointHandle.bind(this),this.pathPointHandles.onUpdate=this.updatePathPointHandle.bind(this),this.pathPointHandles.onDelete=this.deletePathPointHandle.bind(this),this.breakPointHandles=new i.ib,this.breakPointHandles.onCreate=this.createBreakPointHandle.bind(this),this.breakPointHandles.onUpdate=this.updateBreakPointHandle.bind(this),this.breakPointHandles.onDelete=this.deleteBreakPointHandle.bind(this)},e.prototype.updateHandles=function(){this.endPointHandles.reset(Object(x.keyBy)(this.container.getEndPoints(),"id")),this.pathPointHandles.reset(Object(x.keyBy)(this.container.getPathPoints(),"id")),this.breakPointHandles.reset(Object(x.keyBy)(this.container.getBreakPoints(),"id"))},e.prototype.createEndPointHandle=function(t,e){var n=new qi(t);return n.setPosition(e.position.x,e.position.y),this.addChild(n),this.endPointMove.register(n),n},e.prototype.updateEndPointHandle=function(t,e,n){return t.setPosition(n.position.x,n.position.y),t},e.prototype.deleteEndPointHandle=function(t,e){this.removeChild(t)},e.prototype.createPathPointHandle=function(t,e){var n=new Gi(t);return n.setPosition(e.position.x,e.position.y),n.setMovement(e.movement),this.addChild(n),this.pathPointMove.register(n),n},e.prototype.updatePathPointHandle=function(t,e,n){return t.setMovement(n.movement),t.setPosition(n.position.x,n.position.y),t},e.prototype.deletePathPointHandle=function(t,e){this.removeChild(t)},e.prototype.createBreakPointHandle=function(t,e){var n=new Vi(t);return n.setPosition(e.position.x,e.position.y),this.addChild(n),n},e.prototype.updateBreakPointHandle=function(t,e,n){return t.setPosition(n.position.x,n.position.y),t},e.prototype.deleteBreakPointHandle=function(t,e){this.removeChild(t)},e}(wi),Yi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),e}(Jt),Xi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),e}(Jt),Ki=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(u.e)(e,t),e}(Jt);!function(t){t.added="selection-added",t.removed="selection-removed",t.changed="selection-changed"}(Pi||(Pi={}));var Qi=function(t){function e(e,n){var i=t.call(this,e,!0,!0)||this;return i.type=e,i.selection=n,i}return Object(u.e)(e,t),e}(ht.Event),Wi=function(t){function e(e,n,i,a,r){var o=t.call(this,e)||this;return o.ll=n,o.viewport=i,o.commandService=a,o.restriction=r,o.shapeIds=[],o.addSource=new Se.a,o.removeSource=new Se.a,o}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"indicators",{get:function(){return[this.selection]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shapeCount",{get:function(){return this.shapeIds.length},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){var t=this;this.subs.push(Object(D.a)(this.state.changes("Selected").pipe(Object(m.a)((function(e){return t.state.get("EditingText").open?[]:e}))),this.state.changes("EditingText").pipe(Object(m.a)((function(e){return e.open?[]:t.state.get("Selected")})))).pipe(Object(bt.a)(x.isEqual),Object(f.a)((function(e){var n=t.selection;return t.resetSelection(e).pipe(Object(f.a)((function(){if(!t.selection)return Object(M.b)();var i=t.viewport.getShapeModels(e),a=i.pipe(Object(K.a)(1),Object(g.a)((function(n){e.forEach((function(e){n[e]&&t.shapeChanged(n[e])}))}))),r=i.pipe(Object(b.a)(1),Object(g.a)((function(n){e.filter((function(e){return!t.shapeIds.includes(e)&&n[e]})).forEach((function(e){return t.shapeAdded(n[e])}))})));return Object(D.a)(r,a).pipe(Object(g.a)((function(){t.removeShapes(e),t.updateChanges(),t.emitSelectionEvent(n)})))})))}))).subscribe(),this.duringSelectionInteraction(!0,!1).pipe(Object(g.a)((function(e){return t.handleVisibility(e)}))).subscribe(),this.duringPanMouseControlState(!0,!1).pipe(Object(g.a)((function(e){return t.handleVisibility(e)}))).subscribe())},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.destroySelection(),this.changesObserver.complete(),this.changesObserver=void 0,this.addSource.complete(),this.addSource=void 0,this.removeSource.complete(),this.removeSource=void 0},e.prototype.createAddSource=function(){var t=this;return Object(Ci.a)((function(){var e=t.addSource;return t.selection&&(e=Object($t.a)(Object(I.a)(t.selection),e)),e}))},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){var t=this;return E.a.create((function(e){return t.changesObserver=e}))},e.prototype.removeShapes=function(t){var e=this;this.shapeIds.forEach((function(n){t.includes(n)||e.selectionContainer.removeShape(n)})),this.shapeIds=Object(u.j)(t)},e.prototype.shapeAdded=function(t){this.shapeIds.push(t.id),this.selectionContainer.addShape(t)},e.prototype.shapeChanged=function(t){this.selectionContainer.changeShape(t)},e.prototype.updateChanges=function(){this.selection.refresh(),this.changesObserver.next(this.selection)},e.prototype.resetSelection=function(t){var e=this;return this.selectionTypeFor(t).pipe(Object(m.a)((function(t){var n=t.selectionType,i=t.containerType;return n?!(e.selection instanceof n&&e.selectionContainer instanceof i)&&(e.selection&&e.removeSelection(),e.createSelection(n,i),!0):!!e.selection&&(e.removeSelection(),!0)})))},e.prototype.selectionTypeFor=function(t){var e=this;return t.length?t.length>1?Object(I.a)({selectionType:Fi,containerType:Ni}):this.ll.forCurrent(!1).getShapeOnce(t[0]).pipe(Object(m.a)((function(t){return t instanceof Ut.a?{selectionType:Fi,containerType:e.containerTypeForShape(t)}:t instanceof Xt.a?{selectionType:zi,containerType:e.containerTypeForConnector(t)}:{selectionType:null,containerType:null}}))):Object(I.a)({selectionType:null,containerType:null})},e.prototype.containerTypeForShape=function(t){return Ni},e.prototype.containerTypeForConnector=function(t){var e=t.entryClassName;return"ConnectorStraight"===e||"ConnectorDouble"===e||"ConnectorTriple"===e||"ConnectorDivided"===e?Yi:"ConnectorCurved"===e?Xi:"ConnectorAngled"===e||"ConnectorSmoothAngled"===e||"ConnectorWavy"===e||"ConnectorDoubleWavy"===e||"ConnectorIndented"===e||"ConnectorAngledDivided"===e?Ki:Jt},e.prototype.removeSelection=function(){this.removeSource.next(this.selection),this.destroySelection()},e.prototype.createSelection=function(t,e){this.selectionContainer=new e(this.commandService),this.selection=new t(this.selectionContainer,this.state,this.restriction),this.addSource.next(this.selection)},e.prototype.emitSelectionEvent=function(t){var e;t?e=this.selection?Pi.changed:Pi.removed:this.selection&&(e=Pi.added);var n=new Qi(e,this.selection);this.indicatorLayer.dispatchEvent(n),this.state.set("CurrentSelection",this.selection||{})},e.prototype.handleVisibility=function(t){this.selection&&this.selection.setHandlesVisibility(t)},e.prototype.destroySelection=function(){var t=this;this.selectionContainer&&(this.shapeIds.forEach((function(e){return t.selectionContainer.removeShape(e)})),this.shapeIds=[],this.selectionContainer.destroy(),this.selectionContainer=void 0),this.selection&&(this.selection.destroy(),this.selection=void 0)},e.removeForPanZoom=!0,e.\u0275fac=function(t){return new(t||e)(r.qc(i.Mb),r.qc(q.a),r.qc(V.a),r.qc(i.B),r.qc(oe.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)(),Object(u.g)("design:paramtypes",[i.Mb,q.a,V.a,i.B,oe.a])],e)}(pn.b);Object.defineProperty(Wi,"name",{value:"SelectionHandler"});var Zi=n("jDMA"),Ji=n("OOUj"),$i=n("SBjo"),ta=function(t){function e(e){var n=t.call(this)||this;n.dToVcoordinate=e,n.color="#AAAAAA",n.thickness=1;var i=new Image;return i.src="data:image/svg+xml;base64,"+btoa('<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="28.25" height="28.25" viewBox="0 0 28.25 28.25"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#d1d1e6;}.cls-3{fill:#04263d;}</style></defs><circle class="cls-1" cx="14.12" cy="14.13" r="13.63"/><path class="cls-2" d="M15,29.12A14.12,14.12,0,1,1,29.12,15,14.13,14.13,0,0,1,15,29.12ZM15,1.88A13.12,13.12,0,1,0,28.12,15,13.13,13.13,0,0,0,15,1.88Z" transform="translate(-0.88 -0.88)"/><path class="cls-3" d="M20.43,12.36H19V10.08a3.86,3.86,0,0,0-3.86-3.86H14.7a3.84,3.84,0,0,0-3.85,3.86v2.28H9.48a1.26,1.26,0,0,0-1.25,1.26v7.61a1.26,1.26,0,0,0,1.25,1.26h11a1.26,1.26,0,0,0,1.25-1.26V13.62A1.26,1.26,0,0,0,20.43,12.36Zm-8.35-2.28a2.45,2.45,0,0,1,2.63-2.69h.43a2.58,2.58,0,0,1,1.93.73,2.68,2.68,0,0,1,.7,2v2.28H12.08ZM16,16.75a1.08,1.08,0,0,1-.4.52.18.18,0,0,0-.08.17c0,.55,0,1.11,0,1.67a.45.45,0,0,1-.49.46.47.47,0,0,1-.5-.46c0-.28,0-.56,0-.84h0v-.85a.15.15,0,0,0-.06-.14l-.24-.21A1.13,1.13,0,0,1,14,16a1.06,1.06,0,0,1,2,.8Z" transform="translate(-0.88 -0.88)"/><path class="cls-3" d="M20.43,22.73H9.48A1.5,1.5,0,0,1,8,21.23V13.62a1.51,1.51,0,0,1,1.5-1.51H10.6v-2A4.08,4.08,0,0,1,14.7,6h.44a4.12,4.12,0,0,1,4.11,4.11v2h1.18a1.51,1.51,0,0,1,1.5,1.51v7.61A1.5,1.5,0,0,1,20.43,22.73ZM9.48,12.61a1,1,0,0,0-1,1v7.61a1,1,0,0,0,1,1h11a1,1,0,0,0,1-1V13.62a1,1,0,0,0-1-1H18.75V10.08a3.61,3.61,0,0,0-3.61-3.61H14.7a3.59,3.59,0,0,0-3.6,3.61v2.53ZM15,19.82a.72.72,0,0,1-.75-.7c0-.28,0-.57,0-.85v-.82a2.29,2.29,0,0,1-.23-.21,1.39,1.39,0,0,1-.19-1.4,1.3,1.3,0,0,1,1.27-.74,1.34,1.34,0,0,1,1,.59,1.31,1.31,0,0,1,.13,1.14h0a1.39,1.39,0,0,1-.48.64V18c0,.38,0,.75,0,1.13A.7.7,0,0,1,15,19.82Zm0-4.23a.84.84,0,0,0-.72.47.9.9,0,0,0,.11.84,1.12,1.12,0,0,0,.2.18.44.44,0,0,1,.16.34v.85c0,.27,0,.55,0,.83a.23.23,0,0,0,.25.22c.09,0,.24,0,.24-.21,0-.38,0-.75,0-1.12v-.55a.43.43,0,0,1,.19-.37.89.89,0,0,0,.31-.4h0a.81.81,0,0,0-.08-.7.85.85,0,0,0-.65-.38Zm3.07-3H11.83V10.08A2.71,2.71,0,0,1,14.7,7.14h.44A2.85,2.85,0,0,1,17.25,8,3,3,0,0,1,18,10.08Zm-5.69-.5h5.19v-2a2.5,2.5,0,0,0-.62-1.79,2.4,2.4,0,0,0-1.76-.65h-.43a2.2,2.2,0,0,0-2.38,2.44Z" transform="translate(-0.88 -0.88)"/><path class="cls-1" d="M16,16.71a1.3,1.3,0,0,1-.42.56.17.17,0,0,0-.09.17c0,.58,0,1.17,0,1.76a.48.48,0,0,1-.52.48.48.48,0,0,1-.52-.48c0-.3,0-.6,0-.89h0v-.89a.18.18,0,0,0-.07-.15l-.25-.22A1.19,1.19,0,0,1,14,15.87a1.11,1.11,0,0,1,2.06.84Z" transform="translate(-0.88 -0.88)"/></svg>'),n.icon=new ht.Bitmap(i),n.icon.regX=14.25,n.icon.regY=28.5,n.addChild(n.icon),n.shapeView=new ht.Shape,n.addChild(n.shapeView),n}return Object(u.e)(e,t),e.prototype.destroy=function(){},e.prototype.update=function(){var t=i.sb.onRect({x:{type:"relative",value:.5},y:{type:"fixed-start",value:0}},this.shape.defaultBounds,this.shape.transform);this.icon.x=this.dToVcoordinate.x(t.x),this.icon.y=this.dToVcoordinate.y(t.y),this.icon.rotation=this.shape.transform.angle||0,this.isShapeSelected&&this.drawRectHighLight()},e.prototype.add=function(t,e){this.name=t.id,this.shape=t,this.isShapeSelected=e},e.prototype.drawRectHighLight=function(){var t=this.shape.defaultBounds,e=this.shape.transform,n=i.zb.from(t).getTransformedPoints(e),a=n.topLeft,r=n.topRight,o=n.bottomLeft,s=n.bottomRight;this.shapeView.graphics.clear().setStrokeStyle(this.thickness).beginStroke(this.color).moveTo(this.dToVcoordinate.x(a.x),this.dToVcoordinate.y(a.y)).lineTo(this.dToVcoordinate.x(r.x),this.dToVcoordinate.y(r.y)).lineTo(this.dToVcoordinate.x(s.x),this.dToVcoordinate.y(s.y)).lineTo(this.dToVcoordinate.x(o.x),this.dToVcoordinate.y(o.y)).lineTo(this.dToVcoordinate.x(a.x),this.dToVcoordinate.y(a.y)).endStroke()},e}(ht.Container),ea=function(t){function e(e,n,i,a,r){var o=t.call(this,i)||this;return o.dToVcoordinate=e,o.vtod=n,o.state=i,o.ll=a,o.commandService=r,o._indicators=[],o.addSource=new Se.a,o.removeSource=new Se.a,o.changeSource=new Se.a,o}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"locator",{get:function(){return this.ll.forCurrent(!1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"indicators",{get:function(){return this._indicators},enumerable:!1,configurable:!0}),e.prototype.initialize=function(){var t=this,e=this.state.changes("InterfaceControlState").pipe(Object(f.a)((function(e){return t.removeIndicators(),"edit"===e?t.initForEditor():Object(M.b)()})));this.subs.push(e.subscribe(),this.listenToViewportChanges().subscribe())},e.prototype.duringSelectionChange=function(){var t=this;return this.state.changes("Selected").pipe(Object(f.a)((function(e){return t.removeIndicatorsBySelectedState(!0),e&&e.length>0?t.locator.getDiagramOnce().pipe(Object(m.a)((function(t){var n,i,a=t.filterShapeIdsByLockedState(e,!0),r=[];try{for(var o=Object(u.k)(a),s=o.next();!s.done;s=o.next()){var c=s.value;t.shapes[c].isConnector()||r.push(t.shapes[c])}}catch(l){n={error:l}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return r.length>0?r:null}))):Object(I.a)(null)})))},e.prototype.createAddSource=function(){return this.addSource},e.prototype.createRemoveSource=function(){return this.removeSource},e.prototype.createChangeSource=function(){return this.changeSource},e.prototype.initForEditor=function(){var t=this;return Object(D.a)(this.duringSelectionChange(),this.getShapeUnderPointer()).pipe(Object(g.a)((function(e){t.removeIndicatorsBySelectedState(!1),e&&(e.forEach((function(e){var n=new ta(t.dToVcoordinate);n.add(e,t.state.get("Selected").includes(e.id)),t.handleClick(n),t._indicators.push(n),t.addSource.next(n)})),t.updateIndicators())})))},e.prototype.listenToViewportChanges=function(){var t=this;return Object(D.a)(this.state.changes("DiagramPan"),this.state.changes("DiagramZoomLevel")).pipe(Object(g.a)((function(){t.updateIndicators()})))},e.prototype.updateIndicators=function(){var t=this;this._indicators.forEach((function(e){e.update(),t.changeSource.next(e)}))},e.prototype.removeIndicators=function(){for(;this._indicators.length>0;)this.removeSource.next(this._indicators.pop())},e.prototype.removeIndicatorsBySelectedState=function(t){var e=this;this._indicators.forEach((function(n){n.isShapeSelected===t&&e.removeSource.next(n)}))},e.prototype.getShapeUnderPointer=function(){var t=this;return Object(X.a)(this.indicatorLayer.canvas,"mousemove").pipe(Object(f.a)((function(e){var n,i=t.indicatorLayer.getObjectUnderPoint(e.x,e.y,0);i&&i.parent instanceof ta&&(n=i.parent.name);var a=t.state.get("DiagramCanvas");if(a){var r=a.getObjectUnderPoint(t.vtod.x(e.x),t.vtod.y(e.y),0);r&&r.parent&&(n=r.parent.name)}return n&&!t.state.get("Selected").includes(n)?t.locator.getShapeOnce(n).pipe(Object(m.a)((function(t){return t&&t.isLocked?[t]:null}))):Object(I.a)(null)})))},e.prototype.handleClick=function(t){var e=this;Object(X.a)(t,"click").subscribe((function(){e.removeIndicators(),e.commandService.dispatch(Q.a.toggleShapeLock,{shouldLock:!1,shapeIds:[t.name]})}))},e.\u0275fac=function(t){return new(t||e)(r.qc(G.a),r.qc(wt.a),r.qc(i.Mb),r.qc(q.a),r.qc(i.B))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e=Object(u.d)([Object(pn.a)(),Object(u.g)("design:paramtypes",[G.a,wt.a,i.Mb,q.a,i.B])],e)}(pn.b),na=n("53e4"),ia=n("wuOO"),aa=n("J8oI"),ra=n("AM7v"),oa=n("u7ZA"),sa=n("6qzS"),ca=n("TQyE"),la=n("UCH/"),ua=n("6ppF"),pa=function(t){function e(e,n,i,a,r,o){var s=t.call(this,e,a,i)||this;return s.commandService=e,s.random=n,s.state=i,s.vToDcoordinate=a,s.dToVcoordinate=r,s.shapeManage=o,s.basicCardDef={defId:"creately.datasource.lib.basic",version:"1"},s.stickyNotesDef={defId:"creately.datasource.lib.sticky",version:"1"},s.rectDef={defId:"creately.basic.rectangle",version:"4"},s}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"defaultCursor",{get:function(){switch(this.state.get("MouseControlState")){case Pt.b.BasicCard:return{cursor:"card",tail:null,type:"svg",viewingArea:"canvas"};case Pt.b.Rectangle:return{cursor:"rectangle",tail:null,type:"svg",viewingArea:"canvas"};case Pt.b.StickyNote:return{cursor:"stickynote",tail:null,type:"svg",viewingArea:"canvas"};default:return{cursor:"default",tail:null,type:"css",viewingArea:"app"}}},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,n,i){var a=this,r=t.prototype.initialize.call(this,e,n,i),o=this.getAllCanvasMouseCapture().pipe(Object(g.a)((function(t){return t.stopPropagation()})),Object(d.a)((function(t){return"pressup"===t.type})),Object(g.a)((function(t){var e=a.state.get("MouseControlState");return a.commandService.dispatch(O.a.changeMouseControlState,{state:Pt.b.Normal}),a.addShape(t,e)})));return Object(D.a)(r,o)},e.prototype.addShape=function(t,e){switch(e){case Pt.b.BasicCard:return this.dispatchAddShapeCmd(t,this.basicCardDef);case Pt.b.Rectangle:return this.dispatchAddShapeCmd(t,this.rectDef);case Pt.b.StickyNote:return this.dispatchAddShapeCmd(t,this.stickyNotesDef)}},e.prototype.dispatchAddShapeCmd=function(t,e){var n=this.vToDcoordinate.x(t.nativeEvent.offsetX)-C.z,i=this.vToDcoordinate.y(t.nativeEvent.offsetY)-20;this.shapeManage.addShape(e,this.dToVcoordinate.x(n),this.dToVcoordinate.y(i)).subscribe()},e.\u0275fac=function(t){return new(t||e)(r.qc(i.B),r.qc(i.wb),r.qc(i.Mb),r.qc(wt.a),r.qc(G.a),r.qc(_t.a))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e}(Mt.a);Object.defineProperty(pa,"name",{value:"QuickToolsInteractionHandler"});var da,ha=n("uiwn"),ga=n("qp/C");!function(t){t.exportSVG="exportSVG",t.exportPNG="exportPNG",t.addCollaborator="addCollaborator",t.removeCollaborator="removeCollaborator",t.addShape="addShape",t.duplicateShapes="duplicateShapes",t.addConnector="addConnector",t.setText="setText"}(da||(da={}));var fa=function(){function t(){}return t.executeCommand=function(t,e,n){switch(e){case da.exportSVG:return t.execute("ExportAsSvgAPI",n.documentId,n);case da.exportPNG:return t.execute("ExportAsPngAPI",n.documentId,n);default:return Object(I.a)(null)}},t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.cc({token:t,factory:t.\u0275fac}),t}(),ba=n("bI8T"),ma=n("LFZc"),va=function(){function t(t,e,n,i){this.state=t,this.commands=e,this.elkService=n,this.ll=i}return t.prototype.initialize=function(){var t=this;this.ll.forCurrentObserver(!1).pipe(Object(f.a)((function(e){return t.state.changes("TemplateContext").pipe(Object(d.a)((function(t){return t&&!Object(x.isEmpty)(t)})),Object(g.a)((function(e){return t.updateContextStateMap(e)})),Object(f.a)((function(e){return t.fetchContext(e)})),Object(f.a)((function(t){return e.getDiagramOnce().pipe(Object(m.a)((function(e){return{diagram:e,content:t}})))})),Object(f.a)((function(e){return Object(bi.a)(t.renderContextInTable(e.content,e.diagram))})),Object(g.a)((function(){return t.state.set("TemplateContext",{})})))}))).subscribe()},t.prototype.fetchContext=function(t){return this.commands.dispatch(Q.a.getTemplateContext,t).pipe(Object(v.a)(),Object(m.a)((function(e){var n;return(null===(n=null==e?void 0:e.resultData)||void 0===n?void 0:n[0])?{id:t.id,content:e.resultData[0].Content,diagramName:t.renameDiagram?e.resultData[0].Name:null,mainContainerId:t.containerId,appendShapes:t.appendShapes,type:t.type}:{}})))},t.prototype.fetchContextDummy=function(t){return Object(I.a)({id:t.id,content:JSON.parse({contextid1:'{ "Business Problem": [ { "Title": "Manual Translation ernekjrnkwj nrwke jrnekrj newkrj nwekrj kerj nekwrjnwekrj newkrjnewkrjnew rkjwenrkewjn r", "Description": "The process of manually translating every piece of text in an app is time-consuming and prone to errors." }, { "Title": "Cultural Nuances", "Description": "There\'s also the risk of misinterpretations due to cultural nuances that are not taken into consideration." } ], "Business Outcomes": [ { "Title": "Efficiency and Cost-Effectiveness", "Description": "Reducing the time and cost involved in translating apps, while increasing the accuracy of translations." }, { "Title": "Improved User Experience", "Description": "Improving user experience globally by providing more culturally accurate translations." } ], "Users & Customers": [ { "Title": "Primary Users", "Description": "App developers who want to localize their products for global markets." }, { "Title": "Secondary Users", "Description": "Project managers, UX designers, and localization teams working with developers." } ], "User Outcomes": [ { "Title": "Efficient Translation", "Description": "App developers can seamlessly and accurately translate their app into multiple languages without the need for professional translators or extensive linguistic knowledge." }, { "Title": "Expanded User Base", "Description": "They can cater to a more diverse audience, ultimately improving the user experience." } ], "Solution Ideas": [ { "Title": "AI-Powered Translation", "Description": "A language translation app that uses AI and machine learning to provide accurate translations in real-time, with the ability to understand contextual nuances." }, { "Title": "API Integration", "Description": "The app could also include an API for easy integration into the app development process." }, { "Title": "Community-Driven Improvement", "Description": "A feature that allows community-driven translations or corrections to continuously improve the quality of translations." } ], "Hypothesis": [ { "Title": "Improved Localization Process", "Description": "We believe that by providing an AI-powered language translation app for app developers, we will reduce the time and cost associated with localization. We will know this to be true when we see a reduction in the time it takes for apps to be localized, an increase in the number of apps being localized, and positive feedback from developers regarding the accuracy of translations." } ], "What\'s the biggest risk?": [ { "Title": "Inaccurate Translations", "Description": "The most significant risk is providing inaccurate translations that can lead to misunderstandings or offend users." }, { "Title": "Integration Resistance", "Description": "Another risk is developers\' resistance to integrating a new tool into their workflow." }, { "Title": "AI Model Performance", "Description": "The AI model\'s training and continuous learning are critical, and poor performance could hurt the reputation of the product." } ], "What will we learn?": [ { "Title": "Understanding Developers\' Needs", "Description": "We will learn more about the specific needs and pain points of app developers in the localization process." }, { "Title": "AI for Translation", "Description": "We will also gain insights into how AI can be leveraged for language translation, including its limitations and strengths." }, { "Title": "Community Feedback", "Description": "Feedback from the community will help improve our translation model and the overall product." } ] } ',contextid2:'{ "Strengths": [ { "Title": "Experienced Production Team", "Description": "Our production team is well-versed in the soap making process, with years of experience in the field. They understand the intricate details of soap manufacturing, from sourcing quality raw materials to the final stages of packaging and distribution. This wealth of knowledge and experience allows for a smooth operation, eliminating unnecessary delays, and maintaining high product quality. The team\'s adaptability and dedication to continuous learning make it well-positioned to overcome new challenges and changes in the soap production industry. Their mastery of current manufacturing technologies contributes to optimizing production efficiency, ultimately reducing costs and increasing profitability." }, { "Title": "Strong Brand Reputation", "Description": "Our soap company is known for its quality products, ethical sourcing, and commitment to sustainability. We\'ve earned the trust of consumers in our existing markets, resulting in a strong brand reputation. Our products are known for their consistency, effectiveness, and eco-friendly properties. This established brand image will serve as an important asset as we venture into the Argentinian market, as it will lend credibility to our new division and its products. Our reputation for prioritizing customer satisfaction and ethical practices is likely to resonate well with Argentinian consumers, contributing to the overall success of our expansion." }, // Include the rest of the Strengths here... ], "Opportunities": [ { "Title": "Expanding Market for Natural Soaps", "Description": "The global shift toward healthier, more sustainable lifestyles presents a significant opportunity for our company. There\'s a growing consumer trend in Argentina favoring organic and natural products, including soaps. As our company already prioritizes natural ingredients and sustainable practices, we\'re well positioned to meet this demand. Launching our new division here will allow us to tap into this market, reaching a larger customer base and creating opportunities for increased sales and revenue growth. Furthermore, our commitment to sustainability will help differentiate us in a competitive market, further driving consumer interest and loyalty." }, { "Title": "Underserved Rural Markets", "Description": "Many rural areas in Argentina are underserved by existing soap brands, presenting an untapped market with potential for growth. Our company could extend its distribution network to reach these areas, providing access to quality soap products where they may currently be lacking. We have experience in successfully navigating logistics and distribution challenges in diverse geographic settings, making us well-equipped to handle this expansion. Successfully reaching these rural markets could significantly increase our customer base and drive sales, while also aligning with our company\'s mission to promote health and hygiene in underserved communities." }, // Include the rest of the Opportunities here... ], "Aspirations": [ { "Title": "Become a Market Leader in Argentina", "Description": "Our ultimate aspiration is to become a market leader in the Argentinian soap industry. We aim to achieve this by offering high-quality, natural, and sustainable soap products that cater to the evolving needs of the Argentinian consumer. To accomplish this, we will continually invest in research and development to innovate and improve our products, ensuring they remain relevant and competitive. We also aspire to maintain a strong brand presence and build lasting relationships with our customers through excellent customer service, engaging marketing initiatives, and community outreach programs. We believe that this commitment to our customers and to the quality of our products will ultimately propel us to a leading position in the market." }, { "Title": "Promote Sustainable Living and Well-being", "Description": "In line with our company\'s values, we aspire to promote sustainable living and well-being in Argentina through our products. We aim to do this by educating consumers about the benefits of using natural, eco-friendly soaps, and the positive impacts these choices can have on their health and the environment. By extending our reach in Argentina, we hope to influence more consumers to make environmentally conscious decisions, contributing to broader sustainability efforts in the country. Our commitment to this cause goes beyond our products; we also aspire to implement sustainable business practices in all aspects of our operations, further reinforcing our role as a socially responsible company." }, // Include the rest of the Aspirations here... ], "Results": [ { "Title": "Increased Market Share", "Description": "The launch of our new division in Argentina should ultimately result in an increased market share for our company. By offering high-quality, natural soap products that align with consumer trends, and by extending our distribution to underserved areas, we expect to attract a substantial customer base and drive sales. Our strong brand reputation, coupled with our commitment to sustainability and customer satisfaction, should set us apart from competitors and contribute to our market share growth. Regular monitoring and analysis of sales and market data will be essential to measure our progress and make necessary adjustments to our strategies." }, { "Title": "Positive Brand Perception", "Description": "A key result we aim to achieve is positive brand perception among Argentinian consumers. Through our high-quality products, sustainable practices, and commitment to customer satisfaction, we aim to build a strong, positive reputation for our brand in the Argentinian market. We believe that focusing on these areas will not only result in customer loyalty but also lead to positive word-of-mouth marketing, further strengthening our brand image. Regular customer surveys and social media analysis will help us gauge our brand perception and provide insights into areas for improvement." }] }',kanban:'{  "Review": [{"Title":"One", "Description":"d"}],  "Todo": [{"Title":"One", "Description":"d"}], "In progress": [{"Title":"Two", "Description":"mm"},{"Title":"Three","Description":"v"}] }',flow1:'{ "id": "userSignUpFlow", "layoutOptions": { "org.eclipse.elk.algorithm": "layered" },\n                "children": [\n                    { "id": "start", "labels": [{"text": "Start"}], "shape": "roundedRectangle", "width": 100, "height": 50 },\n                    { "id": "userInput", "labels": [{"text": "Collect User Data"}], "shape": "rectangle", "width": 150, "height": 60 }\n                ],\n                "edges": [\n                    { "id": "startToUserInput", "sources": ["start"], "targets": ["userInput"] }\n                ]}',flow:'{ "id": "userSignUpFlow", "layoutOptions": { "org.eclipse.elk.algorithm": "layered" }, "children": [ { "id": "start", "labels": [{"text": "Start"}], "shape": "roundedRectangle", "width": 100, "height": 50 }, { "id": "userInput", "labels": [{"text": "Collect User Data"}], "shape": "rectangle", "width": 150, "height": 60 }, { "id": "validateData", "labels": [{"text": "Validate Data"}], "shape": "rectangle", "width": 130, "height": 60 }, { "id": "createAccount", "labels": [{"text": "Create Account"}], "shape": "rectangle", "width": 140, "height": 60 }, { "id": "sendVerification", "labels": [{"text": "Send Verification"}], "shape": "rectangle", "width": 140, "height": 60 }, { "id": "branchOptions", "labels": [{"text": "Branch Options"}], "shape": "diamond", "width": 120, "height": 70 }, { "id": "option1", "labels": [{"text": "Option 1"}], "shape": "roundedRectangle", "width": 100, "height": 50 }, { "id": "option2", "labels": [{"text": "Option 2"}], "shape": "roundedRectangle", "width": 100, "height": 50 }, { "id": "end", "labels": [{"text": "End"}], "shape": "roundedRectangle", "width": 100, "height": 50 } ], "edges": [ { "id": "startToUserInput", "sources": ["start"], "targets": ["userInput"] }, { "id": "userInputToValidateData", "sources": ["userInput"], "targets": ["validateData"] }, { "id": "validateDataToCreateAccount", "sources": ["validateData"], "targets": ["createAccount"] }, { "id": "createAccountToSendVerification", "sources": ["createAccount"], "targets": ["sendVerification"] }, { "id": "sendVerificationToBranchOptions", "sources": ["sendVerification"], "targets": ["branchOptions"] }, { "id": "branchOptionsToOption1", "sources": ["branchOptions"], "targets": ["option1"] }, { "id": "branchOptionsToOption2", "sources": ["branchOptions"], "targets": ["option2"] }, { "id": "option1ToEnd", "sources": ["option1"], "targets": ["end"] }, { "id": "option2ToEnd", "sources": ["option2"], "targets": ["end"] } ] }',flow2:'{ "id": "CRM_Tool_Development_Plan", "Name": "CRM Tool Development Plan", "Type": "flowchart", "containerId": "flowchart", "layoutOptions": { "org.eclipse.elk.algorithm": "layered" }, "children": [ { "id": "Start", "labels": [{ "text": "Start" }], "shape": "startend", "width": 100, "height": 50 }, { "id": "Outline_Functionalities", "labels": [{ "text": "Outline Functionalities" }], "shape": "process", "width": 150, "height": 50 }, { "id": "Breakdown_Functionalities", "labels": [{ "text": "Breakdown Functionalities" }], "shape": "process", "width": 150, "height": 50 }, { "id": "Customer_Data_Management", "labels": [{ "text": "Customer Data Management" }], "shape": "process", "width": 200, "height": 50 }, { "id": "Sales_Tracking", "labels": [{ "text": "Sales Tracking" }], "shape": "process", "width": 150, "height": 50 }, { "id": "Service_Request_Handling", "labels": [{ "text": "Service Request Handling" }], "shape": "process", "width": 200, "height": 50 }, { "id": "Customer_Interaction_Optimization", "labels": [{ "text": "Customer Interaction Optimization" }], "shape": "process", "width": 250, "height": 50 }, { "id": "Data_Security_Plan", "labels": [{ "text": "Data Security Plan" }], "shape": "process", "width": 200, "height": 50 }, { "id": "Encryption_Methods", "labels": [{ "text": "Encryption Methods" }], "shape": "process", "width": 150, "height": 50 }, { "id": "Microservices_Architecture", "labels": [{ "text": "Microservices Architecture" }], "shape": "process", "width": 200, "height": 50 }, { "id": "Performance_Testing", "labels": [{ "text": "Performance Testing" }], "shape": "process", "width": 150, "height": 50 }, { "id": "Load_Stress_Compatibility_Testing", "labels": [{ "text": "Load, Stress, Compatibility Testing" }], "shape": "process", "width": 250, "height": 50 }, { "id": "API_Integrations", "labels": [{ "text": "API Integrations" }], "shape": "process", "width": 150, "height": 50 }, { "id": "API_Functionality_Testing", "labels": [{ "text": "API Functionality Testing" }], "shape": "process", "width": 200, "height": 50 }, { "id": "Integration_Testing", "labels": [{ "text": "Integration Testing" }], "shape": "process", "width": 150, "height": 50 }, { "id": "Project_Timeline", "labels": [{ "text": "Project Timeline" }], "shape": "process", "width": 150, "height": 50 }, { "id": "Development_Estimate", "labels": [{ "text": "Development Estimate" }], "shape": "process", "width": 200, "height": 50 }, { "id": "Testing_Plan", "labels": [{ "text": "Testing Plan" }], "shape": "process", "width": 150, "height": 50 }, { "id": "Working_Prototype", "labels": [{ "text": "Working Prototype" }], "shape": "process", "width": 150, "height": 50 }, { "id": "Finalization", "labels": [{ "text": "Finalization" }], "shape": "process", "width": 150, "height": 50 }, { "id": "Project_Check-ins", "labels": [{ "text": "Project Check-ins" }], "shape": "process", "width": 150, "height": 50 }, { "id": "User_Feedback_Focus_Group", "labels": [{ "text": "User Feedback Focus Group" }], "shape": "process", "width": 250, "height": 50 }, { "id": "End", "labels": [{ "text": "End" }], "shape": "startend", "width": 100, "height": 50 } ], "edges": [ { "id": "Start_Outline_Functionalities", "sources": ["Start"], "targets": ["Outline_Functionalities"] }, { "id": "Outline_Functionalities_Breakdown_Functionalities", "sources": ["Outline_Functionalities"], "targets": ["Breakdown_Functionalities"] }, { "id": "Breakdown_Functionalities_Customer_Data_Management", "sources": ["Breakdown_Functionalities"], "targets": ["Customer_Data_Management"] }, { "id": "Breakdown_Functionalities_Sales_Tracking", "sources": ["Breakdown_Functionalities"], "targets": ["Sales_Tracking"] }, { "id": "Breakdown_Functionalities_Service_Request_Handling", "sources": ["Breakdown_Functionalities"], "targets": ["Service_Request_Handling"] }, { "id": "Breakdown_Functionalities_Customer_Interaction_Optimization", "sources": ["Breakdown_Functionalities"], "targets": ["Customer_Interaction_Optimization"] }, { "id": "Customer_Interaction_Optimization_Data_Security_Plan", "sources": ["Customer_Interaction_Optimization"], "targets": ["Data_Security_Plan"] }, { "id": "Data_Security_Plan_Encryption_Methods", "sources": ["Data_Security_Plan"], "targets": ["Encryption_Methods"] }, { "id": "Data_Security_Plan_Microservices_Architecture", "sources": ["Data_Security_Plan"], "targets": ["Microservices_Architecture"] }, { "id": "Customer_Interaction_Optimization_Performance_Testing", "sources": ["Customer_Interaction_Optimization"], "targets": ["Performance_Testing"] }, { "id": "Performance_Testing_Load_Stress_Compatibility_Testing", "sources": ["Performance_Testing"], "targets": ["Load_Stress_Compatibility_Testing"] }, { "id": "Customer_Data_Management_API_Integrations", "sources": ["Customer_Data_Management"], "targets": ["API_Integrations"] }, { "id": "API_Integrations_API_Functionality_Testing", "sources": ["API_Integrations"], "targets": ["API_Functionality_Testing"] }, { "id": "API_Functionality_Testing_Integration_Testing", "sources": ["API_Functionality_Testing"], "targets": ["Integration_Testing"] }, { "id": "Integration_Testing_Project_Timeline", "sources": ["Integration_Testing"], "targets": ["Project_Timeline"] }, { "id": "Project_Timeline_Development_Estimate", "sources": ["Project_Timeline"], "targets": ["Development_Estimate"] }, { "id": "Project_Timeline_Testing_Plan", "sources": ["Project_Timeline"], "targets": ["Testing_Plan"] }, { "id": "Development_Estimate_Working_Prototype", "sources": ["Development_Estimate"], "targets": ["Working_Prototype"] }, { "id": "Testing_Plan_Working_Prototype", "sources": ["Testing_Plan"], "targets": ["Working_Prototype"] }, { "id": "Working_Prototype_Finalization", "sources": ["Working_Prototype"], "targets": ["Finalization"] }, { "id": "Finalization_Project_Check-ins", "sources": ["Finalization"], "targets": ["Project_Check-ins"] }, { "id": "Project_Check-ins_User_Feedback_Focus_Group", "sources": ["Project_Check-ins"], "targets": ["User_Feedback_Focus_Group"] }, { "id": "User_Feedback_Focus_Group_End", "sources": ["User_Feedback_Focus_Group"], "targets": ["End"] } ] }',mindmap1:'{ "id": "CRMToolPlan", "Name": "CRM Tool Plan", "Type": "SWOT", "containerId": "mindmap", "layoutOptions": { "org.eclipse.elk.algorithm": "mrtree", "org.eclipse.elk.direction": "RIGHT" }, "children": [ { "id": "Functionalities", "labels": [{ "text": "Functionalities" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "DataManagement", "labels": [{ "text": "Customer Data Management" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "SalesTracking", "labels": [{ "text": "Sales Tracking" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "ServiceRequests", "labels": [{ "text": "Service Requests" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "CustomerInteractions", "labels": [{ "text": "Customer Interactions" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "Security", "labels": [{ "text": "Security" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "DataEncryption", "labels": [{ "text": "Data Encryption" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "MicroservicesArchitecture", "labels": [{ "text": "Microservices Architecture" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "PerformanceTesting", "labels": [{ "text": "Performance Testing" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "CompatibilityTesting", "labels": [{ "text": "Compatibility Testing" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "APIIntegration", "labels": [{ "text": "API Integration" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "APIFunctionalityTesting", "labels": [{ "text": "API Functionality Testing" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "IntegrationTesting", "labels": [{ "text": "Integration Testing" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "ProjectTimeline", "labels": [{ "text": "Project Timeline" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "RegularMeetings", "labels": [{ "text": "Regular Meetings" }], "shape": "ellipse", "width": 100, "height": 50 }, { "id": "UserFeedback", "labels": [{ "text": "User Feedback" }], "shape": "ellipse", "width": 100, "height": 50 } ], "edges": [ { "id": "FuncToDataMgmt", "sources": ["Functionalities"], "targets": ["DataManagement"] }, { "id": "FuncToSalesTracking", "sources": ["Functionalities"], "targets": ["SalesTracking"] }, { "id": "FuncToServiceRequests", "sources": ["Functionalities"], "targets": ["ServiceRequests"] }, { "id": "FuncToCustomerInteractions", "sources": ["Functionalities"], "targets": ["CustomerInteractions"] }, { "id": "DataMgmtToDataEncryption", "sources": ["DataManagement"], "targets": ["DataEncryption"] }, { "id": "DataMgmtToMicroservices", "sources": ["DataManagement"], "targets": ["MicroservicesArchitecture"] }, { "id": "SalesTrackingToPerformanceTesting", "sources": ["SalesTracking"], "targets": ["PerformanceTesting"] }, { "id": "SalesTrackingToCompatibilityTesting", "sources": ["SalesTracking"], "targets": ["CompatibilityTesting"] }, { "id": "ServiceRequestsToSecurity", "sources": ["ServiceRequests"], "targets": ["Security"] }, { "id": "ServiceRequestsToAPIIntegration", "sources": ["ServiceRequests"], "targets": ["APIIntegration"] }, { "id": "APIIntegrationToAPIFunctionalityTesting", "sources": ["APIIntegration"], "targets": ["APIFunctionalityTesting"] }, { "id": "APIIntegrationToIntegrationTesting", "sources": ["APIIntegration"], "targets": ["IntegrationTesting"] }, { "id": "ProjectTimelineToRegularMeetings", "sources": ["ProjectTimeline"], "targets": ["RegularMeetings"] }, { "id": "RegularMeetingsToUserFeedback", "sources": ["RegularMeetings"], "targets": ["UserFeedback"] } ] }',bmc:'{ "Customer Segments": [ { "Title": "Hobbyists", "Description": "Individuals interested in creating miniatures for their hobbies", "appendShapes": false }, { "Title": "Gamers", "Description": "People who play tabletop games and need miniatures for their game pieces", "appendShapes": false }, { "Title": "Designers", "Description": "Professionals who need prototypes or models for their designs", "appendShapes": false } ], "Value Propositions": [ { "Title": "Customization", "Description": "Offering customers the ability to create unique miniatures with different materials and colors", "appendShapes": false }, { "Title": "Quality", "Description": "Providing high-quality prints with attention to detail", "appendShapes": false }, { "Title": "Speed", "Description": "Fast turnaround times for orders", "appendShapes": false } ], "Channels": [ { "Title": "Online Store", "Description": "A website where customers can place orders and view available options", "appendShapes": false }, { "Title": "Social Media", "Description": "Using platforms like Instagram and Facebook to showcase products and reach potential customers", "appendShapes": false }, { "Title": "Local Events", "Description": "Attending conventions and fairs to showcase products and network with potential customers", "appendShapes": false } ], "Customer Relationships": [ { "Title": "Personal Assistance", "Description": "Providing one-on-one assistance to customers with their printing needs", "appendShapes": false }, { "Title": "Communication", "Description": "Maintaining open lines of communication with customers throughout the printing process", "appendShapes": false }, { "Title": "Feedback", "Description": "Soliciting feedback from customers to improve the quality of service", "appendShapes": false } ], "Revenue Streams": [ { "Title": "Product Sales", "Description": "Revenue generated from selling 3D printed miniatures", "appendShapes": false }, { "Title": "Service Fees", "Description": "Charging customers for 3D printing services", "appendShapes": false }, { "Title": "Shipping Fees", "Description": "Charging customers for shipping and handling", "appendShapes": false } ], "Key Resources": [ { "Title": "3D Printers", "Description": "The primary tool used to create the miniatures", "appendShapes": false }, { "Title": "Materials", "Description": "The raw materials used to create the miniatures", "appendShapes": false }, { "Title": "Software", "Description": "The software used to design and prepare the files for printing", "appendShapes": false } ], "Key Activities": [ { "Title": "Printing", "Description": "The primary activity of the business - creating 3D printed miniatures", "appendShapes": false }, { "Title": "Design", "Description": "Assisting customers with designing their miniatures", "appendShapes": false }, { "Title": "Maintenance", "Description": "Regularly maintaining and repairing the 3D printers", "appendShapes": false } ], "Key Partnerships": [ { "Title": "Suppliers", "Description": "Partnering with suppliers to obtain high-quality materials at a reasonable cost", "appendShapes": false }, { "Title": "Shipping Providers", "Description": "Partnering with shipping providers to ensure timely and reliable delivery of orders", "appendShapes": false }, { "Title": "Local Businesses", "Description": "Partnering with local businesses to promote each other\'s services", "appendShapes": false } ], "Cost Structure": [ { "Title": "Electricity Cost", "Description": "The cost of electricity required to power the 3D printers", "appendShapes": false }, { "Title": "Material Cost", "Description": "The cost of raw materials used to create the miniatures", "appendShapes": false }, { "Title": "Maintenance Cost", "Description": "The cost of maintaining and repairing the 3D printers", "appendShapes": false } ] } '}[t.id]),diagramName:"Diagram name",mainContainerId:t.containerId,appendShapes:t.appendShapes,type:t.type})},t.prototype.renderContext=function(t,e){return Object(u.c)(this,void 0,void 0,(function(){var n,i,a,r,o,s,c,l,p,d,h,g=this;return Object(u.f)(this,(function(f){switch(f.label){case 0:return"elk"===t.type?[2,this.renderElkData(t,e)]:(n=t.mainContainerId,a=t.appendShapes,r={},o={},Object.keys(t.content).forEach((function(a){var s,c=t.content[a],l=[];if(n){if(i=Object.keys(e.shapes).map((function(t){return e.shapes[t]})).find((function(t){return e.getIdentifier(t.id)===n})),Object(x.isEmpty)(i.containerRegions||{}))i.isContainer&&!Object(x.isEmpty)(i.children)&&(l=Object.keys(i.children));else if(s=i.getContainerRegionByName(a)){var u=c.map((function(t,e){var n=t.Title;return{id:e+t.Title,data:{label:n,description:t.Description},width:100,height:100,position:{x:200,y:100}}})).filter((function(t){return t}));o[s.id]={children:u}}}else l=Object.keys(e.shapes);var p=l.map((function(t){return e.shapes[t]})).find((function(t){return e.getIdentifier(t.id)===a}));if(p){u=c.map((function(t,e){var n=t.Title;return{id:e+t.Title,data:{label:n,description:t.Description},width:100,height:100,position:{x:200,y:100}}}));r[p.id]={children:u}}})),s=[],c=[],Object(x.isEmpty)(r)?i&&!Object(x.isEmpty)(o)&&(a?(h=e.getStyleRefShape(i.id))&&c.push(h.id):(d=e.getChildShapesInLayoutArea(i.id),c.push.apply(c,Object(u.j)(d.map((function(t){return t.id}))))),p=Object.keys(o).map((function(t){return Object(u.c)(g,void 0,void 0,(function(){return Object(u.f)(this,(function(e){switch(e.label){case 0:return[4,this.elkService.insertIntoRegion(i.id,t,o[t])];case 1:return[2,e.sent()]}}))}))}))):p=Object.keys(r).map((function(t){return Object(u.c)(g,void 0,void 0,(function(){var n,i;return Object(u.f)(this,(function(o){switch(o.label){case 0:return a?(i=e.getStyleRefShape(t))&&c.push(i.id):(n=e.getChildShapesInLayoutArea(t),c.push.apply(c,Object(u.j)(n.map((function(t){return t.id}))))),[4,this.elkService.inserIntoContainer(t,r[t])];case 1:return[2,o.sent()]}}))}))})),[4,Promise.all(p)]);case 1:return l=f.sent(),0===(s=[].concat.apply([],Object(u.j)(l.map((function(t){return t.shapes}))))).length?[2,Promise.resolve()]:[2,this.generateShapes(s,c,t,e)]}}))}))},t.prototype.renderContextInTable=function(t,e){return Object(u.c)(this,void 0,void 0,(function(){var n,i,a,r,o,s,c,l,p=this;return Object(u.f)(this,(function(d){switch(d.label){case 0:return"elk"===t.type?[2,this.renderElkData(t,e)]:(n=t.mainContainerId,a=t.appendShapes,r={},Object.keys(t.content).forEach((function(a){var o,s=t.content[a];if(n&&(i=Object.keys(e.shapes).map((function(t){return e.shapes[t]})).find((function(t){return e.getIdentifier(t.id)===n})),!Object(x.isEmpty)(i.containerRegions||{})&&(o=e.getRegionIdByIdentifier(i.id,a)))){var c=i.containerRegions[o],l=s.map((function(t,e){var n=t.Title;return{id:e+t.Title,data:{label:n,description:t.Description},width:100,height:100,position:{x:200,y:100}}})).filter((function(t){return t}));r[c.id]={children:l}}})),o=[],s=[],i&&!Object(x.isEmpty)(r)&&(l=Object.keys(r).map((function(t){return Object(u.c)(p,void 0,void 0,(function(){var n,o;return Object(u.f)(this,(function(c){switch(c.label){case 0:return a?(o=e.getStyleRefShapeInRegion(i.id,t))&&s.push(o.id):(n=e.getLayoutingShapesInRegion(i.id,t),s.push.apply(s,Object(u.j)(n.map((function(t){return t.id}))))),[4,this.elkService.insertIntoRegion(i.id,t,r[t])];case 1:return[2,c.sent()]}}))}))}))),[4,Promise.all(l)]);case 1:return c=d.sent(),0===(o=[].concat.apply([],Object(u.j)(c.map((function(t){return t.shapes}))))).length?[2,Promise.resolve()]:[2,this.generateShapes(o,s,t,e)]}}))}))},t.prototype.renderElkData=function(t,e){return Object(u.c)(this,void 0,void 0,(function(){var n,a,r,o,s,c,l,p,d=this;return Object(u.f)(this,(function(u){switch(u.label){case 0:return n={x:0,y:0,width:1e3,height:100},a=i.zb.from(n),r=t.content,o=r.layoutOptions,s=function(t,e){for(var n in t)if(!(n in e)||t[n]!==e[n])return!1;return!0},c=Object.values(ma.b).find((function(t){return"elk"===t.layoutingData.source&&s(o,t.layoutingData.options)})),[4,this.elkService.convertToCreately(a,r)];case 1:return l=u.sent(),p={shapeIds:Object.values(l).map((function(t){return t.data.id})),selected:!0,copyEdata:!1,shapesToCopy:l,dataDefs:{}},[2,this.commands.dispatch(Q.a.generateShapes,{shapesData:p,shapeIdsToRemove:[],diagramName:t.diagramName||e.name}).pipe(Object(v.a)(),Object(f.a)((function(t){var e=t.resultData[2].shapesToBeClone.map((function(t){return t.id}));return d.commands.dispatch(Zt.a.layoutShapesAndFitToScreen,{bounds:n,shapeIds:e,layoutingId:c.id})})),Object(v.a)(),Object(f.a)((function(t){return d.commands.dispatch(Q.a.changeContainerDataAndUpdateBounds,t.data[1])})),Object(v.a)()).toPromise()]}}))}))},t.prototype.generateShapes=function(t,e,n,i){var a=this,r={shapeIds:t.map((function(t){return t.data.id})),selected:!0,copyEdata:!1,shapesToCopy:t,dataDefs:{}};return this.commands.dispatch(Q.a.generateShapes,{shapesData:r,shapeIdsToRemove:e,diagramName:n.diagramName||i.name}).pipe(Object(v.a)(),Object(f.a)((function(t){return a.commands.dispatch(Q.a.changeContainerDataAndUpdateBounds,t.data[6])})),Object(v.a)()).toPromise()},t.prototype.updateContextStateMap=function(t){var e=this.state.get("TemplateContextMap")||this.state.set("TemplateContextMap",{})||{};e[t.id]=t,this.state.set("TemplateContextMap",e)},t.\u0275fac=function(e){return new(e||t)(r.qc(i.Mb),r.qc(i.B),r.qc(ba.a),r.qc(q.a))},t.\u0275prov=r.cc({token:t,factory:t.\u0275fac}),t}(),ya=function(t){function e(e,n,i,a,r,o,s,c,l,u,p,d,h,g,f,b,m,v,y,S,O){var x=t.call(this,e)||this;return x.state=e,x.gridService=n,x.featureList=i,x.injector=a,x.cursorGen=r,x.keyBoardController=o,x.ll=s,x.translate=c,x.env=l,x.postmessage=u,x.commandService=p,x.planPermManager=d,x.alignmentNodeLocator=h,x.shapeBoundsLocator=g,x.authService=f,x.libraryList=b,x.location=m,x.userLocator=v,x.modalController=y,x.diagramInfoLocator=S,x.templateContextHandler=O,x.subscribedPostMessages=[],x}return Object(u.e)(e,t),e.prototype.resolve=function(t,e){return this.updateInterfaceControlState(),this.setEditorStatus("opening"),this.state.initialize("Highlighted",[]),this.state.initialize("SelectionBlocked",[]),this.state.set("EditingText",{open:!1}),this.state.set("TextContent",{}),this.state.set("EditorSuggestions",{suggestions:[],searchTerm:""}),this.state.set("PlusCreateState",{inProgress:!1}),this.state.set("TextToolbarState-notes",{styles:{},takeFocus:!1}),this.state.set("TextEditorState-notes",{styles:{}}),this.state.set("TextToolbarState-shapeText",{styles:{},takeFocus:!1}),this.state.set("TextEditorState-shapeText",{styles:{}}),this.state.set("HyperlinkEditState",{open:!1,origin:null}),this.state.set("ShapelinkEditState",{open:!1,origin:null}),this.state.set("AppStatusIndicatorState",{open:!1}),this.state.set("GoogleTokenInfo",{}),this.state.set("TiptapDocument",{}),this.state.set("MultiSelectionInteractionState",Pt.c.Stopped),this.state.set("SelectionInteractionState",Pt.d.Stopped),this.state.set("SelectionInteractionStateScaleX","init"),this.state.set("FreeHandLastUsedItem",{state:Pt.b.Pen,styles:{"stroke-width":2,"stroke-dasharray":"0, 0",stroke:"#000000"}}),this.state.set("CurrentFreeHandShape",!1),this.state.set("LastAddedShape",""),this.hideLoadingScreen(),this.cursorGen.addCursors(gi),this.updateIndicatorHandlers(),this.updateInteractionHandler(),this.setCurrentProject(),this.setCurrentLibraries(),this.setSideBarPanels(),this.setDataSources(),this.registerFeatures(),this.startSelectionToURLSync(),this.keyBoardController.registerFeatures(),this.state.set("MouseControlState",Pt.b.Normal),this.gridService.showGrid.next(!0),this.handlePostMessagesRecv(),this.subs.push(this.alignmentNodeLocator.initialize().subscribe()),this.subs.push(this.shapeBoundsLocator.initialize().subscribe()),this.templateContextHandler.initialize(),Object(I.a)(!0)},e.prototype.canDeactivate=function(t,e,n,i){return this.destroy(),this.state.set("Selected",[]),this.setEditorStatus("closing"),Object(I.a)(!0)},e.prototype.canActivate=function(t,e){return!0},e.prototype.getProjectDiagramsIfNotAvailable=function(t){t&&!this.diagramInfoLocator.hasProjectDiagrams(t)&&this.commandService.dispatch(N.s.getProjectDiagrams,t,null)},e.prototype.showMedia=function(){var t=this;return this.userLocator.getUserDataAfterUserSubscriptionStarted().pipe(Object(d.a)((function(t){return!!t})),Object(b.a)(1),Object(yt.a)(5e3),Object(f.a)((function(e){var n=Object.keys(e.seenMedia).find((function(t){return t.includes("video")}))||"in_app_video",a=e.seenMedia[n]||[],r=i.Wb.filter((function(t){return t.mediaType===n&&!a.includes(t.id)}));return 0===r.length?Object(I.a)():(t.filterMediaByTag(r).subscribe((function(e){i.Ob.track("helpWidget.videos.compactVid.load",{value1Type:"mediaTitle",value1:e.name}),t.state.set("FloatingMedia",Object(u.a)({open:!0},e))})),Object(I.a)(r[0]))})))},e.prototype.filterMediaByTag=function(t){return this.ll.forCurrentObserver(!1).pipe(Object(f.a)((function(t){return t.getDiagramOnce()})),Object(b.a)(1),Object(d.a)((function(t){return!!t})),Object(m.a)((function(e){return t.forEach((function(t){return t.tagCount=Object(x.intersection)([e.tags],t.tags)})),Object(x.orderBy)(t,["tagCount","priority"],["desc","asc"])[0]})))},e.prototype.setDataSources=function(){this.state.set("DataSources",this.planPermManager.check([C.s.GITHUB_INTEGRATION])?[{id:"git",name:"GitHub",type:nn,status:"opened",secondaryMenu:!0}]:[])},e.prototype.handlePostMessagesRecv=function(){var t=this;if(this.state.get("ApplicationIsEmbedded")){var e=this.postmessage.recv().pipe(Object(g.a)((function(e){return t.handleIncomingMessages(e)}))).subscribe();this.subs.push(e)}},e.prototype.handleIncomingMessages=function(t){if(!t||"object"!=typeof t)return Object(I.a)();var e=t,n=e.event,i=e.data;this.subscribedPostMessages.includes(n)||("document:modify"===n&&this.commandService.dispatch(O.a.documentChange,i),"document:data:subscribe"===n&&this.handleDocumentDatatPostMessageSubscribe(),"shape:select:subscribe"===n&&this.handleShapeSelectPostMessageSubscribe(),"creately:command:execute"===n&&this.handleCommandExecute(i))},e.prototype.setEditorStatus=function(t){this.state.set("EditorStatus",{status:t})},e.prototype.updateInterfaceControlState=function(){this.commandService.dispatch(O.a.changeInterfaceControlState,{state:Pt.a.Edit})},e.prototype.updateIndicatorHandlers=function(){this.state.set("IndicatorHandlerList",new Set([ea,Zi.a,ji,Cn.a,yi,hi.a,pt.a,ua.a,Nn,Sn,En.a,Vn,zn,rn.a,cn.a,sn.a,fn,hn,Wi,Oi]))},e.prototype.updateInteractionHandler=function(){var t=this,e=this.state;this.subs.push(this.state.changes("MouseControlState").subscribe((function(n){return e.set("CurrentInteractionHandler",{injector:t.injector,type:t.getEditorInteractionHandler(n)})})))},e.prototype.setCurrentProject=function(){var t=this;this.subs.push(this.ll.forCurrentObserver(!1).pipe(Object(f.a)((function(t){return t.getDiagramOnce()})),Object(f.a)((function(e){return t.diagramInfoLocator.getDiagram(e.id)})),Object(d.a)((function(t){return!!t})),Object(g.a)((function(e){t.state.set("FolderPanelDataChangeEvent",{id:e.id,type:"diagram",action:"create",payload:e})})),Object(b.a)(1)).subscribe())},e.prototype.startSelectionToURLSync=function(){var t=this;this.subs.push(this.state.changes("Selected").pipe(Object(g.a)((function(e){if(t.location){var n=t.location.path(),i=n.indexOf("/edit"),a=n.indexOf("?")>-1?n.substring(n.indexOf("?")):"",r=n.substring(0,i)+"/edit";i>-1&&(e.length>0?(r=r+"/s/"+e[0]+a,t.location.replaceState(r)):t.location.replaceState(r+a))}}))).subscribe())},e.prototype.setCurrentLibraries=function(){var t=this;this.state.has("CurrentLibraries")||this.state.initialize("CurrentLibraries",[]),this.state.has("CurrentLibraryGroup")||this.state.initialize("CurrentLibraryGroup",""),this.subs.push(this.state.changes("SelectedFloatingPanel").pipe(Object(d.a)((function(t){return"shapes"===t})),Object(b.a)(1),Object(f.a)((function(){return t.getLibrariesForCurrentDoc()}))).subscribe())},e.prototype.setSideBarPanels=function(){var t=this.state,e={diagraminfo:Kn.a,shapePanel:la.a,shapeData:an.a};("plugin"===i.m.get("APP_MODE")||t.get("ApplicationIsEmbedded")||(e.diagramcomments=Tn.a,e.historyPanel=na.a),t.get("ApplicationIsEmbedded"))&&("msteams"===t.get("PluginApp")&&(e.diagramcomments=Tn.a,e.historyPanel=na.a));t.set("AvailableSideBarPanels",e)},e.prototype.registerFeatures=function(){this.featureList.register({id:"selectAll",commandEvent:Zt.a.selectAll,label:this.translate.instant("COMMANDS.SELECT_ALL"),shortcuts:[{keySequence:[C.l.Meta,C.l.A]}],data:{},shortcutText:"",icon:"nu-ic-select-all",context:wn.a.Canvas}),this.featureList.register({id:"remove",commandEvent:Q.a.removeShape,label:this.translate.instant("COMMANDS.DELETE"),shortcuts:[{keySequence:[C.l.Backspace]},{keySequence:[C.l.Delete]}],data:{},shortcutText:"",icon:"nu-ic-delete",context:wn.a.Canvas,transformer:$i.a}),this.featureList.register({id:"copyShapes",commandEvent:Q.a.copyShapes,label:this.translate.instant("COMMANDS.COPY"),shortcuts:[{keySequence:[C.l.Meta,C.l.C]}],data:{copyEdata:!0},shortcutText:"",icon:"nu-ic-copy",context:wn.a.Canvas,transformer:$i.a}),this.featureList.register({id:"cutShapes",commandEvent:Q.a.cutShapes,label:this.translate.instant("COMMANDS.CUT"),shortcuts:[{keySequence:[C.l.Meta,C.l.X]}],data:{},shortcutText:"",icon:"nu-ic-cut",context:wn.a.Canvas,transformer:$i.a}),this.featureList.register({id:"pasteShapes",commandEvent:Q.a.pasteShapes,label:this.translate.instant("COMMANDS.PASTE"),shortcuts:[{keySequence:[C.l.Meta,C.l.V],repeatOnKeyPress:300}],data:{},shortcutText:"",icon:"nu-ic-paste",context:wn.a.Canvas}),this.featureList.register({id:"duplicateShapes",commandEvent:Q.a.duplicateShapes,label:this.translate.instant("COMMANDS.DUPLICATE"),shortcuts:[{keySequence:[C.l.Meta,C.l.D],repeatOnKeyPress:300}],data:{},shortcutText:"",icon:"nu-ic-duplicate",context:wn.a.Canvas,transformer:$i.a}),this.featureList.register({id:"editText",commandEvent:Q.a.openTextEditor,label:this.translate.instant("COMMANDS.EDIT_TEXT"),shortcuts:[{keySequence:[C.l.T]}],data:{},shortcutText:"",context:wn.a.CanvasSelected,attachKeyEventToData:!0,icon:"nu-ic-text",tooltip:this.translate.instant("TOOLTIPS.EDIT_TEXT"),transformer:ga.a}),this.featureList.register({id:"switchReplaceText",commandEvent:Q.a.replaceTextShape,label:this.translate.instant("COMMANDS.EDIT_TEXT"),shortcuts:[{keySequence:[C.l.T]}],data:{},shortcutText:"",context:wn.a.CanvasSelected,attachKeyEventToData:!0,icon:"nu-ic-text",tooltip:this.translate.instant("TOOLTIPS.EDIT_TEXT"),transformer:ga.a}),this.featureList.register({id:"createConnector",commandEvent:Q.a.addConnector,label:this.translate.instant("COMMANDS.CREATE_CONNECTION"),shortcuts:[],data:{},shortcutText:"",context:wn.a.Canvas,icon:"nu-ic-line",transformer:Zn.a,tooltip:this.translate.instant("TOOLTIPS.CREATE_CONNECTOR")}),this.featureList.register({id:"styleShape",dataType:C.d.CUSTOM_STYLE_PALETTES,commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.STYLE_SHAPE"),shortcuts:[],data:{},shortcutText:"",context:wn.a.Canvas,icon:"styles",transformer:di.a,tooltip:this.translate.instant("TOOLTIPS.STYLE_SHAPE")}),this.featureList.register({id:"flipConnector",commandEvent:Zt.a.flipConnector,label:this.translate.instant("COMMANDS.FLIP"),shortcuts:[],data:{},shortcutText:"",context:wn.a.Canvas,icon:"nu-ic-flip",transformer:ii.a,tooltip:this.translate.instant("TOOLTIPS.FLIP_CONNECTOR")}),this.featureList.register({id:"uploadShapeImage",commandEvent:Q.a.uploadShapeImage,label:this.translate.instant("COMMANDS.UPLOAD_SHAPE_IMAGE"),shortcuts:[],data:{},shortcutText:"",context:wn.a.Canvas,icon:"nu-ic-image",tooltip:this.translate.instant("TOOLTIPS.UPLOAD_SHAPE_IMAGE")}),this.featureList.register({id:"changeLeftArrowHead",dataType:C.d.OPTION_IMAGES,commandEvent:Q.a.changeArrowHeads,label:"",shortcuts:[],data:{},shortcutText:"",context:wn.a.Canvas,transformer:$n.a,tooltip:this.translate.instant("TOOLTIPS.CHANGE_LEFT_ARROWHEAD")}),this.featureList.register({id:"changeRightArrowHead",dataType:C.d.OPTION_IMAGES,commandEvent:Q.a.changeArrowHeads,label:"",shortcuts:[],data:{},shortcutText:"",context:wn.a.Canvas,transformer:$n.a,tooltip:this.translate.instant("TOOLTIPS.CHANGE_RIGHT_ARROWHEAD")}),this.featureList.register({id:"changeDrawStyle",dataType:C.d.OPTION_IMAGES,commandEvent:Q.a.changeDrawStyle,label:"",shortcuts:[],data:{},shortcutText:"",context:wn.a.Canvas,transformer:ti.a,tooltip:this.translate.instant("TOOLTIPS.CHANGE_DRAW_STYLE")}),this.featureList.register({id:"changeConnectorType",dataType:C.d.OPTION_IMAGES,commandEvent:Q.a.setConnectorConnection,label:"",shortcuts:[],data:{},shortcutText:"",context:wn.a.Canvas,transformer:ei.a,tooltip:this.translate.instant("TOOLTIPS.CHANGE_CONNECTOR_TYPE")}),this.featureList.register({id:"keyboardSelectionNavigation",commandEvent:Q.a.keyboardSelectionInteraction,label:this.translate.instant("COMMANDS.MOVE"),shortcuts:[{keySequence:[C.l.ArrowUp],repeatOnKeyPress:50},{keySequence:[C.l.ArrowDown],repeatOnKeyPress:50},{keySequence:[C.l.ArrowLeft],repeatOnKeyPress:50},{keySequence:[C.l.ArrowRight],repeatOnKeyPress:50}],data:{},attachKeyEventToData:!0,shortcutText:"\u2190 \u2192 \u2191 \u2193",context:wn.a.CanvasSelected}),this.featureList.register({id:"keyboardPlusCreate",commandEvent:Q.a.keyboardPlusCreateInteraction,label:this.translate.instant("COMMANDS.PLUSCREATE"),shortcuts:[{keySequence:[C.l.Tab]},{keySequence:[C.l.Shift,C.l.Enter]}],data:{},attachKeyEventToData:!0,shortcutText:"Tab | Enter",context:wn.a.CanvasSelected}),this.featureList.register({id:"keyboardSelectionMove",commandEvent:Q.a.keyboardSelectionInteraction,label:this.translate.instant("COMMANDS.MOVE"),shortcuts:[{keySequence:[C.l.Shift,C.l.ArrowUp],repeatOnKeyPress:50},{keySequence:[C.l.Shift,C.l.ArrowDown],repeatOnKeyPress:50},{keySequence:[C.l.Shift,C.l.ArrowLeft],repeatOnKeyPress:50},{keySequence:[C.l.Shift,C.l.ArrowRight],repeatOnKeyPress:50}],data:{},attachKeyEventToData:!0,shortcutText:"Shift + \u2190  \u2192  \u2191  \u2193",context:wn.a.CanvasSelected}),this.featureList.register({id:"undo",commandEvent:Q.a.undoAction,label:this.translate.instant("COMMANDS.UNDO"),shortcuts:[{keySequence:[C.l.Meta,C.l.Z]}],data:{},shortcutText:"",context:wn.a.Canvas}),this.featureList.register({id:"redo",commandEvent:Q.a.redoAction,label:this.translate.instant("COMMANDS.REDO"),shortcuts:[{keySequence:[C.l.Meta,C.l.Shift,C.l.Z]}],data:{},shortcutText:"",context:wn.a.Canvas}),this.featureList.register({id:"switchToPanMouseControlState",commandEvent:O.a.changeMouseControlState,label:this.translate.instant("COMMANDS.PAN"),shortcuts:[{keySequence:[C.l.Space],action:"keyup"},{keySequence:[C.l.Space],action:"keydown"}],data:{},shortcutText:"Space + Drag",attachKeyEventToData:!0,context:wn.a.Canvas}),this.featureList.register({id:"boldModelText",commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.BOLD"),shortcuts:[{keySequence:[C.l.Meta,C.l.B]}],data:{style:"bold",value:null},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a,icon:"nu-ic-bold"}),this.featureList.register({id:"italicModelText",commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.ITALIC"),shortcuts:[{keySequence:[C.l.Meta,C.l.I]}],data:{style:"italic",value:null},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a,icon:"nu-ic-italic"}),this.featureList.register({id:"underlineModelText",commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.UNDERLINE"),shortcuts:[{keySequence:[C.l.Meta,C.l.U]}],data:{style:"underline",value:null},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a,icon:"nu-ic-underline"}),this.featureList.register({id:"strikeoutModelText",commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.STRIKE_OUT"),shortcuts:[],data:{style:"strikeout",value:null},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a,icon:"nu-ic-strikethrough"}),this.featureList.register({id:"leftAlignModelText",commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.LEFT_ALIGN"),shortcuts:[],data:{style:"align",value:"left"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a,icon:"nu-ic-text-align-left"}),this.featureList.register({id:"centerAlignModelText",commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.CENTER_ALIGN"),shortcuts:[],data:{style:"align",value:"center"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a,icon:"nu-ic-text-align-center"}),this.featureList.register({id:"rightAlignModelText",commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.RIGHT_ALIGN"),shortcuts:[],data:{style:"align",value:"right"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a,icon:"nu-ic-text-align-right"}),this.featureList.register({id:"justifyModelText",commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.JUSTIFY"),shortcuts:[],data:{style:"align",value:"justify"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a,icon:"nu-ic-text-align-justify"}),this.featureList.register({id:"sizeModelText",dataType:C.d.OPTION_LIST_COMBO,commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.SIZE"),shortcuts:[],data:{style:"size",validation:{type:C.d.NUMBER,rules:{max:500,min:1,decimal:!1}}},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a,icon:"nu-ic-size"}),this.featureList.register({id:"fontModelText",dataType:C.d.OPTION_LIST_COMBO,commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.FONT"),shortcuts:[],data:{style:"font",readOnly:!0,validation:{type:C.d.STRING,rules:{}}},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a}),this.featureList.register({id:"colorModelText",dataType:C.d.COLOR,commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.TEXT_COLOR"),shortcuts:[],data:{style:"color"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ci.a}),this.featureList.register({id:"colorFill",dataType:C.d.COLOR,commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.FILL_COLOR"),shortcuts:[],data:{style:"fillColor",type:ca.b.Fill},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ri.a}),this.featureList.register({id:"colorLine",dataType:C.d.COLOR,commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.LINE_COLOR"),shortcuts:[],data:{style:"lineColor",type:ca.b.Border},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ri.a}),this.featureList.register({id:"styleLine",dataType:C.d.OPTION_LIST,commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.LINE_STYLE"),dropdownDirection:"down",shortcuts:[],data:{style:"lineStyle"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ri.a}),this.featureList.register({id:"lineThickness",dataType:C.d.NUMBER,commandEvent:Q.a.applyShapeStyle,label:this.translate.instant("COMMANDS.LINE_THICKNESS"),labelPosition:"top",shortcuts:[],data:{style:"lineThickness"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ri.a}),this.featureList.register({id:"alignText",dataType:C.d.OPTION_LIST,commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.ALIGN"),shortcuts:[],data:{validation:{type:C.d.STRING,rules:{}},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"nu-ic-italic",tooltip:this.translate.instant("TOOLTIPS.ALIGN_TEXT"),transformer:On.a}),this.featureList.register({id:"leftAlignText",commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.LEFT_ALIGN"),shortcuts:[],data:{styles:{align:"left"},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"nu-ic-text-align-left"}),this.featureList.register({id:"rightAlignText",commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.RIGHT_ALIGN"),shortcuts:[],data:{styles:{align:"right"},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"nu-ic-text-align-right"}),this.featureList.register({id:"centerAlignText",commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.CENTER_ALIGN"),shortcuts:[],data:{styles:{align:"center"},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"nu-ic-text-align-center"}),this.featureList.register({id:"justifyText",commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.JUSTIFY"),shortcuts:[],data:{styles:{align:"justify"},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"nu-ic-text-align-justify"}),this.featureList.register({id:"boldText",commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.BOLD"),shortcuts:[],data:{styles:{bold:null},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"nu-ic-bold",tooltip:this.translate.instant("TOOLTIPS.BOLD_TEXT")}),this.featureList.register({id:"italicText",commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.ITALIC"),shortcuts:[],data:{styles:{italic:null},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"nu-ic-italic",tooltip:this.translate.instant("TOOLTIPS.ITALIC_TEXT")}),this.featureList.register({id:"underlineText",commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.UNDERLINE"),shortcuts:[],data:{styles:{underline:null},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"nu-ic-underline",tooltip:this.translate.instant("TOOLTIPS.UNDERLINE_TEXT")}),this.featureList.register({id:"strikeoutText",commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.STRIKE_OUT"),shortcuts:[],data:{styles:{strikeout:null},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"nu-ic-strikethrough",tooltip:this.translate.instant("TOOLTIPS.STRIKEOUT_TEXT")}),this.featureList.register({id:"bringToFront",commandEvent:Q.a.bringToFront,label:this.translate.instant("COMMANDS.BRING_TO_FRONT"),shortcuts:[{keySequence:[C.l.Meta,C.l.Alt,C.l.BracketRight]}],data:{},shortcutText:"",icon:"nu-ic-bring-to-front",context:wn.a.Canvas}),this.featureList.register({id:"copyShapeLink",commandEvent:Q.a.copyShapeLink,label:this.translate.instant("COMMANDS.COPY_SHAPE_LINK"),shortcuts:[],data:{},shortcutText:"",icon:"nu-ic-copy-link",transformer:ln.a,context:wn.a.CanvasSelected}),this.featureList.register({id:"sendToBack",commandEvent:Q.a.sendToBack,label:this.translate.instant("COMMANDS.SEND_TO_BACK"),shortcuts:[{keySequence:[C.l.Meta,C.l.Alt,C.l.BracketLeft]}],data:{},shortcutText:"",icon:"nu-ic-send-to-back",context:wn.a.Canvas}),this.featureList.register({id:"sendBackward",commandEvent:Q.a.sendBackward,label:this.translate.instant("COMMANDS.SEND_BACKWARDS"),shortcuts:[{keySequence:[C.l.Meta,C.l.BracketLeft]}],data:{},shortcutText:"",icon:"nu-ic-send-backwards",context:wn.a.Canvas}),this.featureList.register({id:"bringForward",commandEvent:Q.a.bringForward,label:this.translate.instant("COMMANDS.BRING_FORWARD"),shortcuts:[{keySequence:[C.l.Meta,C.l.BracketRight]}],data:{},shortcutText:"",icon:"nu-ic-bring-forward",context:wn.a.Canvas}),this.featureList.register({id:"alignShapes",dataType:C.d.OPTION_IMAGES,commandEvent:Zt.a.alignShapes,label:"",icon:"align-v-center",shortcuts:[],data:{},shortcutText:"",context:wn.a.Canvas,transformer:Jn.a,tooltip:this.translate.instant("TOOLTIPS.ALIGN_SHAPES")}),this.featureList.register({id:"layoutShapes",dataType:C.d.GRID_IMAGES,commandEvent:Zt.a.layoutShapes,label:"",icon:"",shortcuts:[],data:{},shortcutText:"",context:wn.a.Canvas,transformer:ha.a,tooltip:this.translate.instant("TOOLTIPS.LAYOUT_SHAPES")}),this.featureList.register({id:"sizeText",dataType:C.d.OPTION_LIST_COMBO,commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.SIZE"),shortcuts:[],data:{validation:{type:C.d.NUMBER,rules:{max:500,min:1,decimal:!1}},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"",transformer:Wn.a,tooltip:this.translate.instant("TOOLTIPS.SIZE_TEXT")}),this.featureList.register({id:"colorText",dataType:C.d.OPTION_IMAGES,commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.COLOR"),shortcuts:[],data:{stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"",transformer:Qn.a,tooltip:this.translate.instant("TOOLTIPS.COLOR_TEXT")}),this.featureList.register({id:"colorTextAlt",dataType:C.d.COLOR,commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.TEXT_COLOR"),shortcuts:[],data:{style:"color",stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Text,icon:"",transformer:aa.a,tooltip:this.translate.instant("TOOLTIPS.COLOR_TEXT")}),this.featureList.register({id:"fontText",dataType:C.d.OPTION_LIST_COMBO,commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.FONT"),shortcuts:[],data:{style:"font",validation:{type:C.d.STRING,rules:{}},stateContext:"shapeText"},shortcutText:"",attachKeyEventToData:!1,icon:"",context:wn.a.Text,transformer:ia.a}),this.featureList.register({id:"openHyperlinkEditor",commandEvent:Q.a.openHyperlinkEditor,label:this.translate.instant("COMMANDS.ADD_HYPERLINK"),shortcuts:[{keySequence:[C.l.Meta,C.l.K]}],data:{open:!0,state:"edit",origin:"toolbar"},shortcutText:"",context:wn.a.Text,icon:"nu-ic-link",tooltip:this.translate.instant("TOOLTIPS.ADD_HYPERLINK")}),this.featureList.register({id:"unlinkHyperlink",commandEvent:Q.a.applyTextEditorStyles,label:this.translate.instant("COMMANDS.REMOVE_HYPERLINK"),shortcuts:[],data:{styles:{link:void 0,color:C.c.color,underline:!1,stateContext:"shapeText"}},shortcutText:"",context:wn.a.Text,icon:"nu-ic-unlink",tooltip:this.translate.instant("TOOLTIPS.UNLINK_HYPERLINK")}),this.featureList.register({id:"openShapelinkEditor",commandEvent:Q.a.openShapelinkEditor,label:this.translate.instant("COMMANDS.ADD_HYPERLINK"),shortcuts:[{keySequence:[C.l.Meta,C.l.K]}],data:{open:!0,state:"edit",origin:"toolbar"},shortcutText:"",context:wn.a.CanvasSelected,icon:"nu-ic-link",transformer:ln.a,tooltip:this.translate.instant("TOOLTIPS.ADD_HYPERLINK")}),this.featureList.register({id:"textPosition",dataType:C.d.TEXT_POSITION,commandEvent:Q.a.positionText,label:"Position Text",shortcuts:[],data:{},shortcutText:"",attachKeyEventToData:!1,context:wn.a.Canvas,icon:"",transformer:si.a}),this.featureList.register({id:"selectionPositionX",dataType:C.d.NUMBER,commandEvent:Zt.a.transformShapesAndConnectors,label:"X",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:oi.a}),this.featureList.register({id:"selectionPositionY",dataType:C.d.NUMBER,commandEvent:Zt.a.transformShapesAndConnectors,label:"Y",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:oi.a}),this.featureList.register({id:"selectionWidth",dataType:C.d.NUMBER,commandEvent:Zt.a.transformShapesAndConnectors,label:"W",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:oi.a}),this.featureList.register({id:"selectionHeight",dataType:C.d.NUMBER,commandEvent:Zt.a.transformShapesAndConnectors,label:"H",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:oi.a}),this.featureList.register({id:"selectionAngle",dataType:C.d.NUMBER,commandEvent:Zt.a.transformShapesAndConnectors,label:"A",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:oi.a}),this.featureList.register({id:"connectorStartX",dataType:C.d.NUMBER,commandEvent:Zt.a.transformShapesAndConnectors,label:"X1",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:oi.a}),this.featureList.register({id:"connectorStartY",dataType:C.d.NUMBER,commandEvent:Zt.a.transformShapesAndConnectors,label:"Y1",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:oi.a}),this.featureList.register({id:"connectorEndX",dataType:C.d.NUMBER,commandEvent:Zt.a.transformShapesAndConnectors,label:"X2",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:oi.a}),this.featureList.register({id:"connectorEndY",dataType:C.d.NUMBER,commandEvent:Zt.a.transformShapesAndConnectors,label:"Y2",labelPosition:"left",shortcuts:[],data:{readOnly:!0},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:oi.a}),this.featureList.register({id:"customShapeStyles",dataType:C.d.CUSTOM_SHAPE_STYLE,commandEvent:Q.a.applyShapeStyle,label:"Custom Styles",labelPosition:"top",shortcuts:[],data:{},shortcutText:"",attachKeyEventToData:!1,context:wn.a.All,transformer:ni.a}),this.featureList.register({id:"groupShapes",dataType:C.d.BINARY,commandEvent:Zt.a.groupShapes,label:this.translate.instant("COMMANDS.GROUP"),shortcuts:[{keySequence:[C.l.Meta,C.l.G]}],data:{},icon:"nu-ic-group",shortcutText:"",context:wn.a.Canvas,transformer:ai.a,tooltip:this.translate.instant("TOOLTIPS.GROUP_SHAPES")}),this.featureList.register({id:"ungroupShapes",dataType:C.d.BINARY,commandEvent:Zt.a.unGroupShapes,label:this.translate.instant("COMMANDS.UNGROUP"),shortcuts:[{keySequence:[C.l.Meta,C.l.Shift,C.l.G]}],data:{},icon:"nu-ic-ungroup",shortcutText:"",context:wn.a.Canvas,transformer:ai.a,tooltip:this.translate.instant("TOOLTIPS.UNGROUP_SHAPES")}),this.featureList.register({id:"showConnectorBumps",commandEvent:Q.a.toggleConnectorLineBumps,label:this.translate.instant("COMMANDS.SHOW_LINE_BUMPS"),shortcuts:[],data:{showLineBumps:!0,selection:!0},shortcutText:"",icon:"nu-ic-linebump",context:wn.a.Canvas,transformer:li.a}),this.featureList.register({id:"hideConnectorBumps",commandEvent:Q.a.toggleConnectorLineBumps,label:this.translate.instant("COMMANDS.HIDE_LINE_BUMPS"),shortcuts:[],data:{showLineBumps:!1,selection:!0},shortcutText:"",icon:"nu-ic-linebump",context:wn.a.Canvas,transformer:li.a}),this.featureList.register({id:"pasteItems",commandEvent:Q.a.pasteItems,label:this.translate.instant("COMMANDS.PASTE"),shortcuts:[{keySequence:[C.l.Meta,C.l.V],repeatOnKeyPress:300}],data:{},shortcutText:"",context:wn.a.Canvas}),this.featureList.register({id:"changeSnapState",commandEvent:Q.a.changeSnapState,label:this.translate.instant("LABELS.SNAP_TO_GUIDES"),shortcuts:[{keySequence:[C.l.Control],action:"keyup"},{keySequence:[C.l.Control],action:"keydown"}],data:{},attachKeyEventToData:!0,shortcutText:"Ctrl + Drag",context:wn.a.Canvas}),this.featureList.register({id:"openAppStatusToolTip",commandEvent:Q.a.openAppStatusToolTip,label:"",shortcuts:[{keySequence:[C.l.Meta,C.l.S]}],data:{open:!0},shortcutText:"",attachKeyEventToData:!0,context:wn.a.Canvas}),this.featureList.register({id:"drawLine",commandEvent:O.a.changeMouseControlState,label:this.translate.instant("COMMANDS.DRAW_LINE"),shortcuts:[{keySequence:[C.l.L]}],data:{state:Pt.b.Connector},shortcutText:"L",attachKeyEventToData:!1,context:wn.a.Canvas}),this.featureList.register({id:"addText",commandEvent:O.a.changeMouseControlState,label:this.translate.instant("COMMANDS.ADD_TEXT"),shortcuts:[{keySequence:[C.l.T]}],data:{state:Pt.b.Text},shortcutText:"T",attachKeyEventToData:!1,context:wn.a.Canvas}),this.featureList.register({id:"lockShape",commandEvent:Q.a.toggleShapeLock,label:this.translate.instant("COMMANDS.LOCK_SHAPE"),shortcuts:[],data:{shouldLock:!0},shortcutText:"",icon:"nu-ic-lock",context:wn.a.Canvas,transformer:Ji.a}),this.featureList.register({id:"unlockShape",commandEvent:Q.a.toggleShapeLock,label:this.translate.instant("COMMANDS.UNLOCK_SHAPE"),shortcuts:[],data:{shouldLock:!1},shortcutText:"",icon:"nu-ic-lock",context:wn.a.Canvas,transformer:Ji.a}),this.featureList.register({id:"containerize",commandEvent:Q.a.changeContainerData,label:this.translate.instant("COMMANDS.USE_AS_FRAME"),shortcuts:[],data:{},shortcutText:"",transformer:on.a,attachKeyEventToData:!1,context:wn.a.Canvas,icon:"nu-ic-frame"}),this.featureList.register({id:"switchShape",commandEvent:Q.a.switchShape,dataType:C.d.GRID_IMAGES,label:this.translate.instant("COMMANDS.SWITCHSHAPE"),shortcuts:[],data:{},icon:"",attachKeyEventToData:!1,context:wn.a.CanvasSelected,tooltip:this.translate.instant("COMMANDS.SWITCHSHAPE"),transformer:oa.a}),this.featureList.register({id:"showConnector",commandEvent:Q.a.toggleConnectorVisibility,label:this.translate.instant("COMMANDS.SHOW_CONNECTOR"),shortcuts:[],data:{hideConnector:!0,selection:!0},shortcutText:"",icon:"nu-ic-line",context:wn.a.Canvas,transformer:ui.a}),this.featureList.register({id:"hideConnector",commandEvent:Q.a.toggleConnectorVisibility,label:this.translate.instant("COMMANDS.HIDE_CONNECTOR"),shortcuts:[],data:{hideConnector:!1,selection:!0},shortcutText:"",icon:"nu-ic-line",context:wn.a.Canvas,transformer:ui.a})},e.prototype.handleDocumentDatatPostMessageSubscribe=function(){var t=this,e=Object(D.a)(this.ll.forCurrent(!0).getDiagramOnce().pipe(Object(m.a)((function(t){return{data:t}}))),this.ll.forCurrent(!0).getDiagramChanges().pipe(Object(m.a)((function(t){return{modifier:t}})))).pipe(Object(g.a)((function(e){return t.postmessage.sendToParent("document:data",e)}))).subscribe();this.subs.push(e),this.subscribedPostMessages.push("document:data:subscribe")},e.prototype.handleShapeSelectPostMessageSubscribe=function(){var t=this,e=this.state.changes("Selected").pipe(Object(g.a)((function(e){return t.postmessage.sendToParent("shape:select",{shapeIds:e})}))).subscribe();this.subs.push(e),this.subscribedPostMessages.push("shape:select:subscribe")},e.prototype.handleCommandExecute=function(t){t&&t.commandName&&t.payload&&this.subs.push(fa.executeCommand(this.commandService,t.commandName,t.payload).subscribe())},e.prototype.getEditorInteractionHandler=function(t){return t===Pt.b.Normal?ve:t===Pt.b.Pan?Xn.a:t===Pt.b.Text?ye.b:t===Pt.b.Comment?pi.a:t===Pt.b.Pen?(this.updateFreeHandLastUsedItemState(t),ra.a):t===Pt.b.Highlighter?void this.updateFreeHandLastUsedItemState(t):t===Pt.b.Rectangle||t===Pt.b.StickyNote||t===Pt.b.BasicCard?pa:xe},e.prototype.updateFreeHandLastUsedItemState=function(t){var e=this.state.get("FreeHandLastUsedItem");this.state.set("FreeHandLastUsedItem",{state:t,styles:e.styles})},e.prototype.getLibrariesForCurrentDoc=function(){var t=this,e=this.state;return this.ll.forCurrentObserver(!1).pipe(Object(f.a)((function(n){return n.getDiagramModel().pipe(Object(d.a)((function(t){return!!t&&!!t.name})),Object(b.a)(1),Object(g.a)((function(n){var i,a=n.getLibraries(t.authService.currentUserId);a&&a.length>0?(i=a.map((function(e){return{id:e[0],type:fi.c.Static,libGroup:t.libraryList.getMainGroupForLibrary(e[0]),status:"loading",isCollapsed:e[1]===C.p.Collapsed}})),t.state.set("CurrentLibraryGroup",i[0].libGroup)):(t.state.set("CurrentLibraryGroup","Shapes"),i=[{id:"general",type:fi.c.Static,libGroup:t.libraryList.getMainGroupForLibrary("general"),status:"loading",isCollapsed:!1},{id:"core",type:fi.c.Static,libGroup:t.libraryList.getMainGroupForLibrary("core"),status:"loading",isCollapsed:!1},{id:"block",type:fi.c.Static,libGroup:t.libraryList.getMainGroupForLibrary("block"),status:"loading",isCollapsed:!1},{id:"flowchart",type:fi.c.Static,libGroup:t.libraryList.getMainGroupForLibrary("flowchart"),status:"loading",isCollapsed:!1},{id:"org-chart",type:fi.c.Static,libGroup:t.libraryList.getMainGroupForLibrary("org-chart"),status:"loading",isCollapsed:!1},{id:"mindmap",type:fi.c.Static,libGroup:t.libraryList.getMainGroupForLibrary("mindmap"),status:"loading",isCollapsed:!1}]),e.set("CurrentLibraries",i)})))})))},e.\u0275fac=function(t){return new(t||e)(r.qc(i.Mb),r.qc("GridService"),r.qc(Pn.a),r.qc(r.C),r.qc(In.a),r.qc(Mn.a),r.qc(q.a),r.qc(o.e),r.qc(i.F),r.qc(i.tb),r.qc(i.B),r.qc(xn.l),r.qc(un.a),r.qc(pe.a),r.qc(xn.a),r.qc(sa.a),r.qc(Z.n),r.qc(xn.y),r.qc(i.kb),r.qc(N.g),r.qc(va))},e.\u0275prov=r.cc({token:e,factory:e.\u0275fac}),e}(jn.a),Sa=n("sEIs"),Oa=n("xcrX"),xa=n("z3tU"),Ca=n("5Jpj"),Ta=n("6T0K"),ja=n("Kz6v"),Pa=n("lP4r"),wa=n("B82N"),Ma=n("fRR/"),Ia=n("yZNT"),Ea=n("A7ZO"),Da=n("8EYK"),ka=n("Sf0Q"),Aa=n("YIQW"),_a=n("jHi0"),La=n("1OUs"),Ra=n("K0+f"),Ba=function(){return["MouseControlState","pen","active"]},Ha=function(t){return{value1:"pen",value2:t}},Fa=function(t){return{event:"fab.button.quick.click",data:t}};function Na(t,e){if(1&t){var n=r.nc();r.mc(0,"button",2),r.uc("click",(function(){return r.Qc(n),r.yc().setMouseControlState("pen")})),r.xc(),r.mc(1,"svg",13),r.hc(2,"use",14),r.lc(),r.lc()}if(2&t){var i=r.yc();r.Dc("ifStateClass",r.Hc(2,Ba))("trackAction",r.Ic(5,Fa,r.Ic(3,Ha,i.freeHandStatus)))}}var Ga=function(){return["MouseControlState","highlighter","active"]},qa=function(t){return{value1:"highlighter",value2:t}};function Va(t,e){if(1&t){var n=r.nc();r.mc(0,"button",2),r.uc("click",(function(){return r.Qc(n),r.yc().setMouseControlState("highlighter")})),r.xc(),r.mc(1,"svg",15),r.hc(2,"use",16),r.lc(),r.lc()}if(2&t){var i=r.yc();r.Dc("ifStateClass",r.Hc(2,Ga))("trackAction",r.Ic(5,Fa,r.Ic(3,qa,i.freeHandStatus)))}}var Ua=function(){return["MouseControlState","rectangle","active"]},za=function(){return{value1:"rectangle"}},Ya=function(){return["MouseControlState","basic-card","active"]},Xa=function(){return{value1:"card"}},Ka=function(){return["MouseControlState","sticky-note","active"]},Qa=function(){return{value1:"sticky-note"}},Wa=function(){return["MouseControlState","text","active"]},Za=function(){return{value1:"text"}},Ja=function(){return["MouseControlState","line","active","connector"]},$a=function(){return{value1:"line"}},tr=function(){function t(t,e,n){this.state=t,this.defLocator=e,this.commandService=n}return Object.defineProperty(t.prototype,"lastUsedFreeHandItem",{get:function(){return this.state.changes("FreeHandLastUsedItem").pipe(Object(m.a)((function(t){return t.state})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"freeHandStatus",{get:function(){var t=[Pt.b.Pen,Pt.b.Highlighter];return i.Ob.track("toolbar.freehand.click"),t.includes(this.state.get("MouseControlState"))?"close":"open"},enumerable:!1,configurable:!0}),t.prototype.setMouseControlState=function(t){t!==this.state.get("MouseControlState")?this.commandService.dispatch(O.a.changeMouseControlState,{state:t}):this.commandService.dispatch(O.a.changeMouseControlState,{state:Pt.b.Normal})},t.prototype.handleDragStart=function(t,e){var n=this;return this.defLocator.getDefinition(e).pipe(Object(b.a)(1),Object(g.a)((function(e){n.commandService.dispatch(O.a.changeMouseControlState,{state:Pt.b.Normal});var i=t.target.querySelector(".thumbnail-drag");t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("Text",JSON.stringify(e)),t.dataTransfer.setData("TrackingInfo",JSON.stringify({location:"FAB.QuickTool",library:"QuickTool"})),i&&t.dataTransfer.setDragImage(i,i.width/2,i.height/2)}))).subscribe()},t.\u0275fac=function(e){return new(e||t)(r.gc(i.Mb),r.gc(R.a),r.gc(i.B))},t.\u0275cmp=r.ac({type:t,selectors:[["insert-buttons-container"]],decls:38,vars:36,consts:[[1,"fx-justify-space-between","fx-center-all"],["placement","top","tooltip",""],[1,"btn-medium","btn-icon","fx-center-all","fx-padding-8",3,"ifStateClass","trackAction","click"],[1,"nu-icon","nu-icon-med"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-rectangle"],["translate","",1,"tooltip-content"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-datasource-simple-card-thick"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-note-thick"],[1,"nu-icon","nu-icon-med","nu-ic-text"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-text-thick"],[1,"nu-icon","nu-icon-med","icon-quick-tool-line"],[0,"xlink","href","./assets/icons/symbol-defs.svg#icon-quick-tool-line"],["class","btn-medium btn-icon fx-center-all fx-padding-8",3,"ifStateClass","trackAction","click",4,"ngIf"],[1,"nu-icon","nu-icon-med","nu-ic-pen"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-pen"],[1,"nu-icon","nu-ic-highlighter"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-highlighter"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"button",2),r.uc("click",(function(){return e.setMouseControlState("rectangle")})),r.xc(),r.mc(3,"svg",3),r.hc(4,"use",4),r.lc(),r.lc(),r.wc(),r.mc(5,"span",5),r.fd(6,"Rectangle"),r.lc(),r.lc(),r.mc(7,"div",1),r.mc(8,"button",2),r.uc("click",(function(){return e.setMouseControlState("basic-card")})),r.xc(),r.mc(9,"svg",3),r.hc(10,"use",6),r.lc(),r.lc(),r.wc(),r.mc(11,"span",5),r.fd(12,"Simple Card"),r.lc(),r.lc(),r.mc(13,"div",1),r.mc(14,"button",2),r.uc("click",(function(){return e.setMouseControlState("sticky-note")})),r.xc(),r.mc(15,"svg",3),r.hc(16,"use",7),r.lc(),r.lc(),r.wc(),r.mc(17,"span",5),r.fd(18,"Sticky Notes"),r.lc(),r.lc(),r.mc(19,"div",1),r.mc(20,"button",2),r.uc("click",(function(){return e.setMouseControlState("text")})),r.xc(),r.mc(21,"svg",8),r.hc(22,"use",9),r.lc(),r.lc(),r.wc(),r.mc(23,"span",5),r.fd(24,"TOOLTIPS.ADD_TEXT"),r.lc(),r.lc(),r.mc(25,"div",1),r.mc(26,"button",2),r.uc("click",(function(){return e.setMouseControlState("line")})),r.xc(),r.mc(27,"svg",10),r.hc(28,"use",11),r.lc(),r.lc(),r.wc(),r.mc(29,"span",5),r.fd(30,"TOOLTIPS.LINE"),r.lc(),r.lc(),r.mc(31,"div",1),r.dd(32,Na,3,7,"button",12),r.zc(33,"async"),r.dd(34,Va,3,7,"button",12),r.zc(35,"async"),r.mc(36,"span",5),r.fd(37,"TOOLTIPS.FREEHANDTOOL"),r.lc(),r.lc(),r.lc()),2&t&&(r.Sb(2),r.Dc("ifStateClass",r.Hc(16,Ua))("trackAction",r.Ic(18,Fa,r.Hc(17,za))),r.Sb(6),r.Dc("ifStateClass",r.Hc(20,Ya))("trackAction",r.Ic(22,Fa,r.Hc(21,Xa))),r.Sb(6),r.Dc("ifStateClass",r.Hc(24,Ka))("trackAction",r.Ic(26,Fa,r.Hc(25,Qa))),r.Sb(6),r.Dc("ifStateClass",r.Hc(28,Wa))("trackAction",r.Ic(30,Fa,r.Hc(29,Za))),r.Sb(6),r.Dc("ifStateClass",r.Hc(32,Ja))("trackAction",r.Ic(34,Fa,r.Hc(33,$a))),r.Sb(6),r.Dc("ngIf","pen"===r.Ac(33,12,e.lastUsedFreeHandItem)),r.Sb(2),r.Dc("ngIf","highlighter"===r.Ac(35,14,e.lastUsedFreeHandItem)))},directives:[_a.a,La.a,Ra.a,o.a,Z.t],pipes:[Z.b],encapsulation:2,changeDetection:0}),t}(),er=n("1IJ2"),nr=function(t){function e(e,n,i,a){var r=t.call(this,e)||this;return r.state=e,r.loader=n,r.planPermManager=i,r.libraryList=a,r}return Object(u.e)(e,t),e.prototype.openLibrary=function(t){var e=this;i.Ob.track("left.shapes.search.library.click",{value1Type:"libName",value1:t.title}),this.loader.load(t.id,0,-1).pipe(Object(b.a)(1)).subscribe((function(n){var i=e.state.get("CurrentLibraries");if(!i.map((function(t){return t.id})).includes(t.id)){var a=e.libraryList.getMainGroupForLibrary(t.id);e.state.set("CurrentLibraries",Object(u.j)(i,[{id:t.id,type:n.type,libGroup:a,status:"loading"}])),e.state.set("CurrentLibraryGroup",a)}}))},e.\u0275fac=function(t){return new(t||e)(r.gc(i.Mb),r.gc(Oa.a),r.gc(xn.l),r.gc(sa.a))},e.\u0275cmp=r.ac({type:e,selectors:[["library-search-item"]],inputs:{item:"item"},features:[r.Pb],decls:10,vars:1,consts:[[1,"library-search-item-container","search-result-item","fx-ellipsis",3,"click"],[1,"library-search-item-icon"],[1,"nu-icon"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-library"],[1,"library-search-item-label","caption","fx-ellipsis"],[1,"caption","grey","fx-margin-top-5"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.uc("click",(function(){return e.openLibrary(e.item)})),r.mc(1,"div",1),r.xc(),r.mc(2,"svg",2),r.hc(3,"use",3),r.lc(),r.lc(),r.wc(),r.mc(4,"label",4),r.fd(5),r.hc(6,"br"),r.mc(7,"span",5),r.fd(8,"Open Library"),r.lc(),r.lc(),r.hc(9,"div"),r.lc()),2&t&&(r.Sb(5),r.hd(" ",e.item.title," "))},styles:[".search-result-item[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.search-result-item[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:#04263d;cursor:pointer}.library-search-item-icon[_ngcontent-%COMP%]{width:40px}.library-search-item-label[_ngcontent-%COMP%]{padding-left:.375rem;flex:1}.library-search-item-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}"],changeDetection:0}),e}(er.a),ir=n("pYIu"),ar=n("TdEb"),rr=n("pVzg"),or=["searchDDBtn"];function sr(t,e){if(1&t){var n=r.nc();r.xc(),r.wc(),r.mc(0,"simple-dropdown-item",10),r.uc("click",(function(){r.Qc(n);var t=e.$implicit;return r.yc().emitChange(t)})),r.mc(1,"div",11),r.xc(),r.mc(2,"svg",12),r.hc(3,"use"),r.lc(),r.wc(),r.mc(4,"a",13),r.fd(5),r.lc(),r.lc(),r.lc()}if(2&t){var i=e.$implicit;r.Dc("item",i),r.Sb(3),r.Tb("href","./assets/icons/symbol-defs.svg#nu-ic-"+i.icon,null,"xlink"),r.Sb(2),r.gd(i.label)}}var cr=function(){return{closeOnItemClicked:!0,openOnHover:!1,closeOnBlur:!1,multiselectable:!1}},lr=function(){function t(){this.change=new Y.a("search")}return Object.defineProperty(t.prototype,"icon",{get:function(){var t=this.items.find((function(t){return t.selected}));if(t)return t.icon},enumerable:!1,configurable:!0}),t.prototype.emitChange=function(t){this.change.next(t.id),this.onClick()},t.prototype.onClick=function(){var t=this.searchBtn.nativeElement;t.classList.contains("open-search")?t.classList.remove("open-search"):t.classList.add("open-search")},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.ac({type:t,selectors:[["search-type-dropdown"]],viewQuery:function(t,e){var n;(1&t&&r.kd(or,!0),2&t)&&(r.Mc(n=r.vc())&&(e.searchBtn=n.first))},inputs:{items:"items"},outputs:{change:"change"},decls:11,vars:4,consts:[[1,"dd-container"],["direction","top",3,"settings"],["dropdown",""],["ddbutton","",3,"clicked"],[1,"dd-button","btn-icon"],["searchDDBtn",""],[1,"nu-icon","nu-icon-small"],[1,"nu-icon","dd-arrow"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-collapse-fill"],["class","dd-items-container","dditem","",3,"item","click",4,"ngFor","ngForOf"],["dditem","",1,"dd-items-container",3,"item","click"],[1,"search-type-item","btn-small","fx-no-margin","no-border"],[1,"nu-icon","nu-icon-small","nu-icon-primary-fill"],[1,"body"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"abs-dropdown",1,2),r.mc(3,"simple-dropdown-button",3),r.uc("clicked",(function(){return e.onClick()})),r.mc(4,"div",4,5),r.xc(),r.mc(6,"svg",6),r.hc(7,"use"),r.lc(),r.mc(8,"svg",7),r.hc(9,"use",8),r.lc(),r.lc(),r.lc(),r.dd(10,sr,6,3,"simple-dropdown-item",9),r.lc(),r.lc()),2&t&&(r.Sb(1),r.Dc("settings",r.Hc(3,cr)),r.Sb(6),r.Tb("href","./assets/icons/symbol-defs.svg#nu-ic-"+e.icon,null,"xlink"),r.Sb(3),r.Dc("ngForOf",e.items))},directives:[ir.a,ar.a,Z.s,rr.a],styles:[".dd-button[_ngcontent-%COMP%]{margin-left:.75rem;padding:.25rem;display:flex;align-items:center;border-radius:6px}.dd-button[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{fill:#64767d}.dd-arrow[_ngcontent-%COMP%]{transform:rotate(90deg);width:10px}.open-search[_ngcontent-%COMP%]{background:#e1f1fb}.open-search[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{fill:#08436b}.dd-container[_ngcontent-%COMP%]  .abs-dropdown-items-container{margin-top:.375rem;min-width:313px;min-height:72px;border:none;box-shadow:0 4px 9px -2px rgba(39,41,50,.12)}.dd-container[_ngcontent-%COMP%]  .abs-dropdown-inner-wrapper{margin-left:.375rem}.dd-items-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-radius:6px}.search-type-item[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;height:28px;width:100%}.search-type-item[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{margin-right:.625rem}"],changeDetection:0}),t}(),ur=n("hX56"),pr=n("55zG"),dr=n("ZC55"),hr=["textInput"];function gr(t,e){1&t&&(r.mc(0,"div",4),r.hc(1,"panel-search-results"),r.lc())}var fr=function(t){function e(e,n,i,a,r,o,s,c,l,u,p){var d=t.call(this,n)||this;return d.modalController=e,d.state=n,d.searchService=i,d.defLocator=a,d.elementRef=r,d.loader=o,d.commandService=s,d.vToDcoordinate=c,d.datastore=l,d.translateService=u,d.libraryList=p,d.isOpen=new Y.a(!1),d.searchResults=new Y.a([]),d.allLibWithShapeDefs=[],d.placeholder="PLACEHOLDERS.SEARCH",d.childItems=[],d.subs=[],d.lastSearchTime=0,d.onSearchQueryChange=new Y.a(""),d}return Object(u.e)(e,t),e.prototype.focus=function(){this.textInput.focus()},e.prototype.clear=function(){this.textInput.clear()},e.prototype.ngOnInit=function(){var t=this;this.subs.push(this.getMouseDownEventOnDocument().subscribe(),this.loadAllLibrariesWithShapes().pipe(Object(f.a)((function(){return t.onSearchQueryChange})),Object(f.a)((function(e){return e.length>2?t.isOpen.next(!0):t.isOpen.next(!1),M.a}))).subscribe(),this.libraryStatusChange().subscribe())},e.prototype.libraryStatusChange=function(){var t=this;return this.state.changes("CurrentLibraries").pipe(Object(g.a)((function(){t.onSearchQueryChange.next("")})))},e.prototype.clickOut=function(t){this.elementRef.nativeElement.contains(t.target)&&("text"===t.target.type&&this.onSearchQueryChange.getValue().length>2||"text"!==t.target.type)?this.isOpen.next(!0):this.isOpen.next(!1)},e.prototype.handleKeydown=function(t){t.keyCode===C.l.Enter&&Date.now()-this.lastSearchTime>1500&&(this.lastSearchTime=Date.now(),this.filterShapesAndSetState())},e.prototype.createShapeTemplateItem=function(t){return{id:t.defId,title:t.name,type:"shape",data:t,thumbnailType:"image",thumbnailUrl:t.thumbnail}},e.prototype.ngOnDestroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},e.prototype.openLibBrowser=function(){i.Ob.track("left.shapes.search.browseShapes"),this.modalController.show(dr.a)},e.prototype.openGoogleSearch=function(){i.Ob.track("left.shapes.search.google"),this.state.set("ShapeSearchQuery",this.textInput.value),this.state.set("SelectedFloatingPanel","asset")},e.prototype.filterShapesAndSetState=function(){var t=this.searchResults.getValue().filter((function(t){return"shape"===t.type}));this.setState(t,this.onSearchQueryChange.getValue())},e.prototype.getDataForTracking=function(t){if(t)return{shapesCount:t.filter((function(t){return"shape"===t.type})).length,libsCount:t.filter((function(t){return"libs"===t.type})).length}},e.prototype.search=function(t){return Object(we.a)([this.searchAllByName(t),this.searchShapesByTags(t)]).pipe(Object(m.a)((function(t){var e=Object(u.h)(t,2),n=e[0],i=e[1],a=n.concat(i);return Object(x.uniqBy)(a,"id")})))},e.prototype.searchShapesByTags=function(t){var e=this;return this.searchShapes(t,["tags"]).pipe(Object(f.a)((function(t){var n=t.map((function(t){return t.id})),i=e.getLibrariesAndNonMatchingDefs(n),a=t.filter((function(t){return i.defIds.includes(t.id)})).map((function(t){return e.defLocator.getDefinition(t.id,t.version).pipe(Object(m.a)((function(t){return e.createLibraryItem(t)})))}));return a.length>0?Object(we.a)(a).pipe(Object(m.a)((function(t){return i.libs.concat(t)}))):i.libs.length>0?Object(I.a)(i.libs):Object(I.a)([])})))},e.prototype.searchAllByName=function(t){var e=this;return Object(we.a)(this.searchShapes(t,["name"]),this.searchLibs(t,["label"])).pipe(Object(f.a)((function(t){var n=Object(u.h)(t,2),i=n[0],a=n[1],r=e.sortResultsByScore(i.concat(a));return e.updateSearchResults(r)})))},e.prototype.createLibraryItem=function(t){return"template"===t.type?this.createShapeTemplateItem(t):this.createShapeCanvasItem(t)},e.prototype.addShape=function(t,e,n){var a,r={id:i.wb.shapeId(),defId:t.defId,version:t.version,x:this.vToDcoordinate.x(e-t.defaultBounds.width/2),y:this.vToDcoordinate.y(n-t.defaultBounds.height/2)};this.commandService.dispatch(Q.a.addDiagramShape,{shapes:(a={},a[r.id]=r,a)})},e.prototype.addTemplate=function(t,e,n){var i=this,a=t.defId+":"+t.version;Object($t.a)(this.commandService.dispatch(Q.a.getTemplate,t.diagram,{templateId:a}),Object(Ci.a)((function(){return i.datastore.findOneLatest(pr.a,{id:a}).pipe(Object(f.a)((function(t){var a=t.clone({x:i.vToDcoordinate.x(e),y:i.vToDcoordinate.y(n)});return i.commandService.dispatch(Q.a.addDiagramShape,{cloned:!0,shapes:a.shapes,groups:a.groups,connections:a.connections})})))}))).subscribe()},e.prototype.translate=function(t,e){return this.translateService.get(t,e).pipe(Object(b.a)(1))},e.prototype.doSearch=function(t){var e=this;return this.search(t).pipe(Object(b.a)(1),Object(m.a)((function(t){return e.searchResults.next(t),M.a})))},e.prototype.loadAllLibrariesWithShapes=function(){var t=this,e=[];return this.libraryList.getAllGroups().forEach((function(n){return t.libraryList.getLibrariesInGroup(n).map((function(n){return e.push(t.loader.getLibrary(n.id).pipe(Object(m.a)((function(e){return{shapeIds:t.removeVersionFromDefIds(e.defs),libTitle:n.label,libId:n.id,groups:t.libraryList.getGroupsForLibrary(n.id),libGroup:t.libraryList.getMainGroupForLibrary(n.id)}})),Object(ft.a)((function(){return Object(I.a)(void 0)}))))}))})),we.a.apply(void 0,Object(u.j)(e)).pipe(Object(g.a)((function(e){e=e.filter((function(t){return!!t})),t.allLibWithShapeDefs=e})))},e.prototype.removeVersionFromDefIds=function(t){return t.map((function(t){var e=t.lastIndexOf(".");return t.substring(0,e)}))},e.prototype.getMouseDownEventOnDocument=function(){var t=this;return Object(X.a)(document,"mousedown").pipe(Object(g.a)((function(e){return t.clickOut(e)})))},e.prototype.getRespectiveLibs=function(t){switch(t){case"icons":return this.libraryList.getAllIconsGroups();case"frames":return this.libraryList.getAllFramesGroups();case"embeds":return this.libraryList.getAllEmbedsGroups();default:return[]}},e.prototype.getLibrariesAndNonMatchingDefs=function(t){var e=this,n=[],i=[];return this.allLibWithShapeDefs.filter((function(t){var n=e.state.get("SelectedFloatingPanel"),i=e.getRespectiveLibs(n);if(!i.length)return!0;var a=!1;return i.forEach((function(e){t.groups.includes(e)&&(a=!0)})),a})).forEach((function(e){var a=e.shapeIds.filter((function(e){return t.includes(e)})),r=(a.length/e.shapeIds.length*100).toFixed(2);parseFloat(r)>80&&(-1===i.findIndex((function(t){return t.id===e.libId}))&&i.push({id:e.libId,title:e.libTitle,type:"libs"}),n=n.concat(a),n=Object(x.uniq)(n))})),{libs:i,defIds:t.filter((function(t){return!n.includes(t)}))}},e.prototype.updateSearchResults=function(t){var e=this;if(t&&t.length>0){var n=t.map((function(t){return"shape"===t.type?e.defLocator.getDefinition(t.id,t.version).pipe(Object(m.a)((function(t){return e.createLibraryItem(t)}))):Object(I.a)(t)}));return Object(we.a)(n)}return Object(I.a)([])},e.prototype.sortResultsByScore=function(t){return t.sort((function(t,e){return t.score<e.score?1:t.score>e.score?-1:0}))},e.prototype.searchShapes=function(t,e){return this.searchService.search(t,["shape"],{keys:e,threshold:-1e4})},e.prototype.searchLibs=function(t,e){return this.searchService.search(t,["libs"],{keys:e,threshold:-1e4})},e.prototype.createShapeCanvasItem=function(t){return{id:t.defId,title:t.name,type:"shape",data:t,thumbnailType:"canvas",canvasIdPrefix:"thumb-search-drop"}},e.\u0275fac=function(t){return new(t||e)(r.gc(i.kb),r.gc(i.Mb),r.gc(Ia.a),r.gc(R.a),r.gc(r.r),r.gc(Oa.a),r.gc(i.B),r.gc(wt.a),r.gc(ur.b),r.gc(o.e),r.gc(sa.a))},e.\u0275cmp=r.ac({type:e,selectors:[["panel-search"]],viewQuery:function(t,e){var n;(1&t&&r.kd(hr,!0),2&t)&&(r.Mc(n=r.vc())&&(e.textInput=n.first))},inputs:{placeholder:"placeholder"},features:[r.Pb],decls:6,vars:9,consts:[["tooltip-tour-step","fab-1.4.3",1,"search-input-field"],["icon","search-larger","autoFocus","true",3,"showClearButton","emitForInputChange","placeholder","debounce","updateText","keydown"],["textInput",""],["class","search-result-dropdown",4,"ngIf"],[1,"search-result-dropdown"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"text-input",1,2),r.uc("updateText",(function(t){return e.onSearchQueryChange.next(t)}))("keydown",(function(t){return e.handleKeydown(t)})),r.zc(3,"translate"),r.lc(),r.lc(),r.dd(4,gr,2,0,"div",3),r.zc(5,"async")),2&t&&(r.Sb(1),r.Ec("placeholder",r.Ac(3,5,e.placeholder)),r.Dc("showClearButton",!0)("emitForInputChange",!0)("debounce",100),r.Sb(3),r.Dc("ngIf",r.Ac(5,7,e.isOpen)))},styles:[".search-result-dropdown[_ngcontent-%COMP%]{border-radius:0 0 4px 4px;bottom:68px;left:0;background-color:#fff;width:270px;z-index:3}.search-input-field[_ngcontent-%COMP%]  .text-input-inner{height:40px;position:static;display:flex;flex-flow:row-reverse;align-items:center}.search-input-field[_ngcontent-%COMP%]  .text-input{border:0;border-radius:0;margin-top:0;font-size:16px}.search-input-field[_ngcontent-%COMP%]  .text-input-item.has-icon .text-input{padding:0}.search-input-field[_ngcontent-%COMP%]  .text-input-item.has-icon .text-input-icon{margin:10px}.search-input-field[_ngcontent-%COMP%]  .text-input-icon{position:static;color:#899092;width:24px;height:24px}"],changeDetection:0}),e}(er.a),br=n("SKds"),mr=n("crdX"),vr=n("H+7l");function yr(t,e){if(1&t){var n=r.nc();r.mc(0,"div",6),r.uc("click",(function(){return r.Qc(n),r.yc(2).filterShapesAndSetState()})),r.mc(1,"label",7),r.fd(2),r.zc(3,"async"),r.lc(),r.lc()}if(2&t){var i=r.yc(2);r.Sb(2),r.gd(r.Ac(3,1,i.getSearchResultsLabel()))}}function Sr(t,e){if(1&t&&(r.mc(0,"div"),r.mc(1,"p",8),r.fd(2,"LABELS.NO_SEARCH_RESULTS "),r.lc(),r.hc(3,"message-card",9),r.lc()),2&t){var n=r.yc(2);r.Sb(3),r.Dc("title",n.suggestionsTitle)("body",n.suggestionsBody)("titleIcon",n.emptyStateIcon)}}function Or(t,e){if(1&t){var n=r.nc();r.mc(0,"shape-search-item",14,15),r.uc("click",(function(){r.Qc(n);var t=r.yc().$implicit;return r.yc(3).handleShapeClick(t.data)}))("dragstart",(function(t){r.Qc(n);var e=r.yc().$implicit;return r.yc(3).handleDragStart(t,e.data)})),r.lc()}if(2&t){var i=r.yc().$implicit;r.Dc("item",i)}}function xr(t,e){if(1&t&&r.hc(0,"library-search-item",16),2&t){var n=r.yc().$implicit;r.Dc("item",n)}}function Cr(t,e){if(1&t&&(r.mc(0,"div"),r.dd(1,Or,2,1,"shape-search-item",12),r.dd(2,xr,1,1,"library-search-item",13),r.lc()),2&t){var n=e.$implicit;r.Sb(1),r.Dc("ngIf","shape"===n.type),r.Sb(1),r.Dc("ngIf","libs"===n.type)}}var Tr=function(){return{scrollYMarginOffset:1}};function jr(t,e){if(1&t&&(r.mc(0,"perfect-scrollbar",10),r.mc(1,"div"),r.dd(2,Cr,3,2,"div",11),r.lc(),r.lc()),2&t){var n=r.yc().ngIf;r.Dc("config",r.Hc(2,Tr)),r.Sb(2),r.Dc("ngForOf",n)}}function Pr(t,e){if(1&t&&(r.mc(0,"div",1),r.mc(1,"div",2),r.dd(2,yr,4,3,"div",3),r.dd(3,Sr,4,3,"div",4),r.lc(),r.dd(4,jr,3,3,"perfect-scrollbar",5),r.lc()),2&t){var n=e.ngIf;r.Sb(2),r.Dc("ngIf",n.length>0),r.Sb(1),r.Dc("ngIf",0===n.length),r.Sb(1),r.Dc("ngIf",n.length>0)}}var wr=function(t){function e(e,n,i,a,r,o,s,c,l,u,p){var d=t.call(this,e,n,i,a,r,o,s,c,l,u,p)||this;return d.modalController=e,d.state=n,d.searchService=i,d.defLocator=a,d.elementRef=r,d.loader=o,d.commandService=s,d.vToDcoordinate=c,d.datastore=l,d.translateService=u,d.libraryList=p,d.searchResults=new Y.a([]),d.placeholder="PLACEHOLDERS.SEARCH",d.childItems=[],d.subs=[],d.lastSearchTime=0,d.onSearchQueryChange=new Y.a(""),d}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"suggestionsTitle",{get:function(){return"LABELS.SUGGESTIONS"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"suggestionsBody",{get:function(){return["LABELS.TRY_DIFF_KEYWORD","LABELS.SWITCH_SEARCH"]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyStateIcon",{get:function(){return"./assets/images/shape-search-result.svg"},enumerable:!1,configurable:!0}),e.prototype.getSearchResultsLabel=function(){return this.translate("LABELS.FOUND_RESULTS",{noOfResults:this.searchResults.getValue().length})},e.prototype.ngOnInit=function(){var t=this;this.subs.push(this.state.changes("ShapeSearchQuery").pipe(Object(bt.a)(),Object(g.a)((function(e){return t.onSearchQueryChange.next(e)}))).subscribe(),this.loadAllLibrariesWithShapes().pipe(Object(f.a)((function(){return t.onSearchQueryChange})),Object(f.a)((function(e){return t.doSearch(e)}))).subscribe())},e.prototype.ngOnDestroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},e.prototype.handleDragStart=function(t,e){i.Ob.track("left.shapes.search.shape.drag",{value1Type:"shapeDefId",value1:e.defId});var n=t.target.querySelector(".shape-thumbnail-image");t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("Text",JSON.stringify(e)),t.dataTransfer.setData("TrackingInfo",JSON.stringify({location:"FAB"})),t.dataTransfer.setDragImage(n,n.width/2,n.height/2)},e.prototype.handleShapeClick=function(t){i.Ob.track("left.shapes.search.shape.click",{value1Type:"shapeDefId",value1:t.defId});var e=this.state.get("DiagramViewPort");"template"===t.type?this.addTemplate(t,e.centerX,e.centerY):this.addShape(t,e.centerX,e.centerY)},e.\u0275fac=function(t){return new(t||e)(r.gc(i.kb),r.gc(i.Mb),r.gc(Ia.a),r.gc(R.a),r.gc(r.r),r.gc(Oa.a),r.gc(i.B),r.gc(wt.a),r.gc(ur.b),r.gc(o.e),r.gc(sa.a))},e.\u0275cmp=r.ac({type:e,selectors:[["panel-search-results"]],inputs:{placeholder:"placeholder"},features:[r.Pb],decls:2,vars:3,consts:[["class","search-results-dropdown-results",4,"ngIf"],[1,"search-results-dropdown-results"],[1,"fx-margin-top-15","fx-margin-left-10","fx-margin-right-10"],["class","fx-margin-bottom-5",3,"click",4,"ngIf"],[4,"ngIf"],["class","search-result-scrollbar",3,"config",4,"ngIf"],[1,"fx-margin-bottom-5",3,"click"],[1,"grey","body"],["translate","",1,"body","fx-margin-bottom-15","search-result-text"],[3,"title","body","titleIcon"],[1,"search-result-scrollbar",3,"config"],[4,"ngFor","ngForOf"],[3,"item","click","dragstart",4,"ngIf"],[3,"item",4,"ngIf"],[3,"item","click","dragstart"],["tile",""],[3,"item"]],template:function(t,e){1&t&&(r.dd(0,Pr,5,3,"div",0),r.zc(1,"async")),2&t&&r.Dc("ngIf",r.Ac(1,1,e.searchResults))},directives:[Z.t,o.a,br.a,mr.b,Z.s,vr.a,nr],pipes:[Z.b],styles:[".search-results-dropdown-results[_ngcontent-%COMP%]{background-color:#fff;height:100%;bottom:68px;left:0;z-index:3}[_nghost-%COMP%]   .search-result-scrollbar[_ngcontent-%COMP%] {height:calc(100% - 15px)}[_nghost-%COMP%]   .search-result-scrollbar[_ngcontent-%COMP%]  .ps-content{padding-left:.625rem;padding-right:.625rem;padding-top:.5rem}.search-result-text[_ngcontent-%COMP%]{color:#64767d}"],changeDetection:0}),e}(fr),Mr=n("C5+t"),Ir=n("gg05"),Er=n("fRBV"),Dr=["textInput"];function kr(t,e){1&t&&r.hc(0,"loading-bubbles",10)}function Ar(t,e){1&t&&(r.mc(0,"div",11),r.mc(1,"span",12),r.fd(2,"GOOGLE_SEARCH_IMPORT.NO_RESULTS"),r.lc(),r.lc())}var _r=function(){return{event:"left.googleSearch.pd.searchTerm.click"}};function Lr(t,e){if(1&t){var n=r.nc();r.mc(0,"a",15),r.uc("click",(function(){r.Qc(n);var t=e.$implicit;return r.yc(2).searchImages(t)})),r.fd(1),r.lc()}if(2&t){var i=e.$implicit;r.Dc("trackAction",r.Hc(2,_r)),r.Sb(1),r.gd(i)}}function Rr(t,e){if(1&t&&(r.kc(0),r.mc(1,"div",13),r.dd(2,Lr,2,3,"a",14),r.zc(3,"async"),r.lc(),r.jc()),2&t){var n=r.yc();r.Sb(2),r.Dc("ngForOf",r.Ac(3,1,n.tags))}}function Br(t,e){if(1&t){var n=r.nc();r.mc(0,"div",16),r.mc(1,"div",17),r.xc(),r.mc(2,"svg",18),r.hc(3,"use",19),r.lc(),r.lc(),r.wc(),r.mc(4,"div",20),r.mc(5,"p",21),r.fd(6,"GOOGLE_SEARCH_IMPORT.UPGRADE_TITLE"),r.lc(),r.mc(7,"p",22),r.fd(8,"GOOGLE_SEARCH_IMPORT.UPGRADE_DESC"),r.lc(),r.lc(),r.mc(9,"button",23),r.uc("click",(function(){return r.Qc(n),r.yc().goToPlans()})),r.fd(10," LABELS.UPGRADE "),r.lc(),r.lc()}}function Hr(t,e){1&t&&(r.mc(0,"div",24),r.mc(1,"div",25),r.mc(2,"p",26),r.fd(3,"OFFLINE.PANEL.HEADING"),r.lc(),r.mc(4,"p",27),r.fd(5,"OFFLINE.PANEL.GOOGLE_SEARCH_PANEL"),r.lc(),r.lc(),r.lc())}function Fr(t,e){1&t&&(r.mc(0,"div",24),r.mc(1,"div",25),r.mc(2,"div",28),r.xc(),r.mc(3,"svg",29),r.hc(4,"use",30),r.lc(),r.lc(),r.wc(),r.mc(5,"p",26),r.fd(6,"GOOGLE_SEARCH_IMPORT.SERVICE_UNAVAILABLE.HEADING"),r.lc(),r.mc(7,"p",27),r.fd(8,"GOOGLE_SEARCH_IMPORT.SERVICE_UNAVAILABLE.DESCRIPTION"),r.lc(),r.lc(),r.lc())}function Nr(t,e){if(1&t){var n=r.nc();r.mc(0,"library-tile",33,34),r.uc("dragstart",(function(t){r.Qc(n);var i=e.$implicit;return r.yc(2).handleDragStart(t,i.data)}))("mouseenter",(function(t){r.Qc(n);var i=e.$implicit;return r.yc(2).handleMouseEnter(i,t)}))("clicked",(function(t){r.Qc(n);var i=e.$implicit;return r.yc(2).handleClick(t,i.data)}))("mouseleave",(function(t){return r.Qc(n),r.yc(2).handleMouseLeave(t)})),r.lc()}if(2&t){var i=e.$implicit;r.Dc("item",i)}}function Gr(t,e){if(1&t&&(r.mc(0,"perfect-scrollbar",31),r.dd(1,Nr,2,1,"library-tile",32),r.zc(2,"async"),r.lc()),2&t){var n=r.yc();r.Sb(1),r.Dc("ngForOf",r.Ac(2,1,n.items))}}var qr=function(){return["Enter"]},Vr=function(t){function e(e,n,i,a,r,o,s){var c=t.call(this,a,i,s)||this;return c.modalController=e,c.translate=n,c.commandService=i,c.state=a,c.ll=r,c.planPermManager=o,c.shapeManageService=s,c.items=new E.a,c.searchTags=[],c.tags=new Se.a,c.showResultsNotFound=new Y.a(!1),c.showUpgradeDialog=new Y.a(!1),c.serviceUnavailable=new Y.a(!1),c.showLoadingIndicator=new Y.a(!1),c.id="google-search-import",c.subs=[],c.trackingInfo={location:"FAB.GoogleSearch"},c}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"appConnectionStatus",{get:function(){var t=this;return this.state.changes(Mr.c).pipe(Object(g.a)((function(e){"asset"===t.state.get("SelectedFloatingPanel")&&(e===Mr.c.ONLINE?t.tags.next(t.searchTags):e===Mr.c.OFFLINE&&(t.items=null))})))},enumerable:!1,configurable:!0}),e.prototype.onOpen=function(){this.isMaxSearchReached()&&this.showUpgradeDialog.next(!0),this.setSearchTags(),this.state.get("ShapeSearchQuery")?(i.Ob.track("left.googleSearch.click",{value1Type:"location",value1:"generalSearch"}),this.searchImages(this.state.get("ShapeSearchQuery")),this.state.set("ShapeSearchQuery","")):i.Ob.track("left.googleSearch.click",{value1Type:"location",value1:"direct"})},e.prototype.searchImages=function(t){var e=this;t.trim().length>0&&!this.showUpgradeDialog.value&&(this.showLoadingIndicator.next(!0),this.items=this.fetchResultsFromAPI(t).pipe(Object(m.a)((function(n){return n?(e.serviceUnavailable.next(!1),n.length>0?(e.onSearchResultsFound(t),n.map((function(t){return e.createImageLibraryItem(t)}))):void e.onNoSearchResultsFound(t)):void e.serviceUnavailable.next(!0)})),Object(g.a)((function(){e.updateMaxSearch(),e.showLoadingIndicator.next(!1)})),Object(mi.a)(1)))},e.prototype.handleDragStart=function(t,e){i.Ob.track("left.googleSearch.shape.drag",{value1Type:"imageName",value1:e.name,value2Type:"imageSource",value2:e.url}),this.hidePopoverPreview();var n=t.target.querySelector(".shape-thumbnail-image");t.dataTransfer.effectAllowed="move",e.upload=!0,t.dataTransfer.setData("URLData",JSON.stringify(e)),t.dataTransfer.setDragImage(n,n.width/2,n.height/2)},e.prototype.handleClick=function(t,e){var n=this.state.get("DiagramViewPort");i.Ob.track("left.googleSearch.shape.click",{value1Type:"imageName",value1:e.name,value2Type:"imageSource",value2:e.url});var a={x:n.centerX,y:n.centerY},r=this.shapeManageService.addURLData(e,a.x,a.y).subscribe();this.subs.push(r)},e.prototype.onSearchQueryChange=function(t){0===t.length&&this.showResultsNotFound.next(!1)},e.prototype.goToPlans=function(){i.Ob.track("left.googleSearch.upgrade.click"),window.open(i.m.get("PLAN_PAGE_URL"),"_blank")},e.prototype.setSearchTags=function(){var t=this;this.ll.forCurrent(!1).getDiagramModel().pipe(Object(b.a)(1),Object(g.a)((function(e){t.searchTags=e.searchTags||[],t.tags.next(t.searchTags)}))).subscribe()},e.prototype.fetchResultsFromAPI=function(t){var e=this;return this.doSearch(t,0).pipe(Object(f.a)((function(n){return n?n.length>=10?e.doSearch(t,11).pipe(Object(m.a)((function(t){return n.concat(t)}))):Object(I.a)(n):Object(I.a)(void 0)})))},e.prototype.doSearch=function(t,e){return this.commandService.dispatch(Q.a.getGoogleImages,{query:t,startIndex:e}).pipe(Object(v.a)(),Object(m.a)((function(t){return t&&t.resultData[1]&&t.resultData[1].items?t.resultData[1].items:[]})),Object(ft.a)((function(){return Object(I.a)(void 0)})))},e.prototype.onSearchResultsFound=function(t){i.Ob.track("left.googleSearch.searchTerm",{value1Type:"searchedTerm",value1:t,value2Type:"resultsFound",value2:"true"}),this.updateSearchTags(t),this.showResultsNotFound.next(!1)},e.prototype.onNoSearchResultsFound=function(t){i.Ob.track("left.googleSearch.searchTerm",{value1Type:"searchedTerm",value1:t,value2Type:"resultsFound",value2:"false"}),this.tags.next(this.searchTags),this.showResultsNotFound.next(!0)},e.prototype.updateSearchTags=function(t){this.searchTags.includes(t)||(this.searchTags.push(t),this.tags.next(this.searchTags))},e.prototype.createImageLibraryItem=function(t){return{id:t.image.contextLink,text:{line1:t.title,line2:t.displayLink,line3:t.mime,line4:t.image.width+" x "+t.image.height},popoverCssClass:"google-img-preview-container",type:"image",data:{name:t.title,url:t.link},thumbnailType:"image",thumbnailUrl:t.image.thumbnailLink}},e.prototype.updateMaxSearch=function(){this.updateSearchCount(),this.isMaxSearchReached()&&(this.showUpgradeDialog.next(!0),this.showUpgradeDialogWindow())},e.prototype.isMaxSearchReached=function(){return!this.planPermManager.check([C.s.CREATELY_GOOGLE_SEARCH])&&!this.isNewDay()},e.prototype.updateSearchCount=function(){this.isNewDay()&&(localStorage.googleSearchedDate=(new Date).getTime().toString(),localStorage.googleSearchedCount=0);var t=parseInt(localStorage.googleSearchedCount,10)||0;t++,localStorage.googleSearchedCount=t},e.prototype.isNewDay=function(){var t=new Date(parseFloat(localStorage.googleSearchedDate)),e=new Date;return!i.J.isSameDay(t,e)},e.prototype.hidePopoverPreview=function(){this.state.has("CurrentLibraryPreview")&&this.state.is("CurrentLibraryPreview",{})||this.state.set("CurrentLibraryPreview",{})},e.prototype.showUpgradeDialogWindow=function(){var t={id:C.s.CREATELY_GOOGLE_SEARCH,buttons:[{type:"upgrade",clickHandler:function(){}}],integrationContext:{embedded:this.state.get("ApplicationIsEmbedded"),environment:this.state.get("PluginApp")}};this.modalController.show(xn.u,{inputs:{dialogData:t}})},e.\u0275fac=function(t){return new(t||e)(r.gc(i.kb),r.gc(o.e),r.gc(i.B),r.gc(i.Mb),r.gc(q.a),r.gc(xn.l),r.gc(_t.a))},e.\u0275cmp=r.ac({type:e,selectors:[["google-search-import-panel"]],viewQuery:function(t,e){var n;(1&t&&r.kd(Dr,!0),2&t)&&(r.Mc(n=r.vc())&&(e.textInput=n.first))},features:[r.Pb],decls:26,vars:42,consts:[[1,"google-search-import-panel","left-sidebar-panel"],[1,"left-sidebar-panel-padding"],["testId","google-search-input","icon","search-thin",3,"disabled","showClearButton","submitOnCode","placeholder","updateText","submit"],["textInput",""],["class","fx-margin-top-10","color","secondary",4,"ngIf"],["class","fx-margin-top-10 fx-center",4,"ngIf"],[4,"ngIf"],["class","google-search-upgrade-dialog fx-margin-top-20 fx-margin-bottom-20 fx-center-column left-sidebar-panel-padding",4,"ngIf"],["class","fx-margin-top-20 fx-center-column left-sidebar-panel-padding",4,"ngIf"],["class","fx-margin-top-10 left-sidebar-panel-padding",4,"ngIf"],["color","secondary",1,"fx-margin-top-10"],[1,"fx-margin-top-10","fx-center"],["translate","",1,"grey"],[1,"google-search-term-tag-container","fx-margin-top-10","left-sidebar-panel-padding"],["class","google-search-term-tag",3,"trackAction","click",4,"ngFor","ngForOf"],[1,"google-search-term-tag",3,"trackAction","click"],[1,"google-search-upgrade-dialog","fx-margin-top-20","fx-margin-bottom-20","fx-center-column","left-sidebar-panel-padding"],[1,"google-search-upgrade-dialog-icon-container","fx-center-all"],[1,"nu-icon","white"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-star"],[1,"google-search-upgrade-dialog-message"],["translate","",1,"google-search-upgrade-dialog-message-heading"],["data-testid","google-search-limit-message","translate","",1,"grey","nu-text-small"],["data-testid","google-search-upgrade-limit-button","translate","",1,"google-search-upgrade-dialog-button","nu-btn-small","primary",3,"click"],[1,"fx-margin-top-20","fx-center-column","left-sidebar-panel-padding"],[1,"google-search-offline-message","fx-margin-bottom-10"],["translate","",1,"navy-blue","nu-text-small","fx-margin-bottom-5","fx-center-all"],["translate","",1,"grey","nu-text-small"],[1,"service-unavailable-icon-container","fx-margin-bottom-10","fx-center-all"],[1,"nu-icon","nu-icon-med","light-nv-blue"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-warning"],[1,"fx-margin-top-10","left-sidebar-panel-padding"],[3,"item","dragstart","mouseenter","clicked","mouseleave",4,"ngFor","ngForOf"],[3,"item","dragstart","mouseenter","clicked","mouseleave"],["tile",""]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"text-input",2,3),r.uc("updateText",(function(t){return e.onSearchQueryChange(t)}))("submit",(function(t){return e.searchImages(t)})),r.zc(4,"async"),r.zc(5,"async"),r.zc(6,"translate"),r.lc(),r.lc(),r.dd(7,kr,1,0,"loading-bubbles",4),r.zc(8,"async"),r.dd(9,Ar,3,0,"div",5),r.zc(10,"async"),r.dd(11,Rr,4,3,"ng-container",6),r.zc(12,"async"),r.zc(13,"async"),r.zc(14,"async"),r.zc(15,"async"),r.dd(16,Br,11,0,"div",7),r.zc(17,"async"),r.zc(18,"async"),r.dd(19,Hr,6,0,"div",8),r.zc(20,"async"),r.dd(21,Fr,9,0,"div",8),r.zc(22,"async"),r.zc(23,"async"),r.dd(24,Gr,3,3,"perfect-scrollbar",9),r.zc(25,"async"),r.lc()),2&t&&(r.Sb(2),r.Ec("placeholder",r.Ac(6,15,"PLACEHOLDERS.GOOGLE_SEARCH")),r.Dc("disabled",r.Ac(4,11,e.showUpgradeDialog)||0===r.Ac(5,13,e.appConnectionStatus))("showClearButton",!0)("submitOnCode",r.Hc(41,qr)),r.Sb(5),r.Dc("ngIf",r.Ac(8,17,e.showLoadingIndicator)),r.Sb(2),r.Dc("ngIf",r.Ac(10,19,e.showResultsNotFound)),r.Sb(2),r.Dc("ngIf",!(r.Ac(12,21,e.items)||r.Ac(13,23,e.showUpgradeDialog)||0===r.Ac(14,25,e.appConnectionStatus)||r.Ac(15,27,e.serviceUnavailable))),r.Sb(5),r.Dc("ngIf",r.Ac(17,29,e.showUpgradeDialog)&&!(0===r.Ac(18,31,e.appConnectionStatus))),r.Sb(3),r.Dc("ngIf",0===r.Ac(20,33,e.appConnectionStatus)),r.Sb(2),r.Dc("ngIf",r.Ac(22,35,e.serviceUnavailable)&&!(0===r.Ac(23,37,e.appConnectionStatus))),r.Sb(3),r.Dc("ngIf",!(0===r.Ac(25,39,e.appConnectionStatus))))},directives:[J.a,Z.t,_e.a,o.a,Z.s,Ra.a,mr.b,Er.a],pipes:[Z.b,o.d],styles:[".nu-beta-tag[_ngcontent-%COMP%]{padding:2px 3px;background-color:#ffc648;color:#04263d;border-radius:2px;font-size:11px;display:inline-block}.left-sidebar-panel[_ngcontent-%COMP%]{padding-bottom:.5rem;height:100vh;box-sizing:border-box}.left-sidebar-panel.expanded[_ngcontent-%COMP%], .left-sidebar-panel.fullscreen[_ngcontent-%COMP%]{width:100%;background-color:#fff;z-index:4}.left-sidebar-panel.closed[_ngcontent-%COMP%]{transform:translateX(-215px);width:0}.left-sidebar-panel-container[_ngcontent-%COMP%]{width:280px;padding-top:1.375rem;padding-bottom:1.375rem}.left-sidebar-add-btn[_ngcontent-%COMP%]{margin:1rem 0}.left-sidebar-heading[_ngcontent-%COMP%]{font-family:Inter,Arial,sans-serif,ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Noto Sans,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-size:1rem;font-weight:500;line-height:1.5rem;padding-bottom:.875rem;color:#04263d}.col-menu-scrollbar[_ngcontent-%COMP%]{height:calc(100vh - calc(calc(140px) + calc(22px + 24px + 14px)))}library-tile[_ngcontent-%COMP%]{display:inline-block;margin-right:2px;background:#fff}.google-search-import-panel[_ngcontent-%COMP%]  .lib-tile-container{border-radius:4px;padding:2px;height:60px;border:1px solid #d3d3e7;overflow:hidden;width:60px;margin-right:1px;margin-left:1px}.google-search-import-panel[_ngcontent-%COMP%]  .thumb-img-container{height:100%}.google-search-term-tag[_ngcontent-%COMP%]{height:20px;line-height:20px;background:#ececec;margin:5px 10px 0 0;padding:0 5px;border-radius:2px;display:inline-flex;overflow:hidden}  .google-img-preview-container{padding:50px}  .google-img-preview-container .lib-preview-text>p{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.google-search-upgrade-dialog-icon[_ngcontent-%COMP%]{width:110px}.google-search-upgrade-dialog-buttons[_ngcontent-%COMP%]{padding:10px;text-align:right;height:60px;display:flex;align-items:center;justify-content:flex-end}.google-search-upgrade-dialog-icon-container[_ngcontent-%COMP%]{background-color:#f5ab1c;width:46px;height:46px;border-radius:100%;margin-bottom:16px}.google-search-upgrade-dialog-icon-container[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{width:30px;height:30px}.google-search-upgrade-dialog-message[_ngcontent-%COMP%]{margin-bottom:20px}.google-search-upgrade-dialog-message[_ngcontent-%COMP%]   .google-search-upgrade-dialog-message-heading[_ngcontent-%COMP%]{font-size:14px;margin-bottom:5px}"],changeDetection:0}),e}(Ir.a);function Ur(t,e){1&t&&r.hc(0,"loading-bubbles",7)}function zr(t,e){1&t&&(r.mc(0,"div",8),r.mc(1,"span",9),r.fd(2,"GOOGLE_SEARCH_IMPORT.NO_RESULTS"),r.lc(),r.lc())}function Yr(t,e){if(1&t){var n=r.nc();r.mc(0,"div"),r.mc(1,"message-card",10),r.uc("buttonClicked",(function(){return r.Qc(n),r.yc().goToPlans()})),r.lc(),r.lc()}if(2&t){var i=r.yc();r.Sb(1),r.Dc("title",i.upgradeMsgTitle)("body",i.upgradeMsgBody)("button",i.upgradeMsgButton)("titleIcon",i.emptyStateIcon)}}function Xr(t,e){1&t&&(r.mc(0,"div",11),r.mc(1,"div",12),r.mc(2,"p",13),r.fd(3,"OFFLINE.PANEL.HEADING"),r.lc(),r.mc(4,"p",14),r.fd(5,"OFFLINE.PANEL.GOOGLE_SEARCH_PANEL"),r.lc(),r.lc(),r.lc())}function Kr(t,e){1&t&&(r.mc(0,"div",11),r.mc(1,"div",12),r.mc(2,"div",15),r.xc(),r.mc(3,"svg",16),r.hc(4,"use",17),r.lc(),r.lc(),r.wc(),r.mc(5,"p",13),r.fd(6,"GOOGLE_SEARCH_IMPORT.SERVICE_UNAVAILABLE.HEADING"),r.lc(),r.mc(7,"p",18),r.fd(8,"GOOGLE_SEARCH_IMPORT.SERVICE_UNAVAILABLE.DESCRIPTION"),r.lc(),r.lc(),r.lc())}function Qr(t,e){if(1&t){var n=r.nc();r.mc(0,"library-tile",21,22),r.uc("dragstart",(function(t){r.Qc(n);var i=e.$implicit;return r.yc(2).handleDragStart(t,i.data)}))("mouseenter",(function(t){r.Qc(n);var i=e.$implicit;return r.yc(2).handleMouseEnter(i,t)}))("mouseleave",(function(t){return r.Qc(n),r.yc(2).handleMouseLeave(t)}))("clicked",(function(t){r.Qc(n);var i=e.$implicit;return r.yc(2).handleClick(t,i.data)}))("closed",(function(t){return r.Qc(n),r.yc(2).handleClose(t)})),r.lc()}if(2&t){var i=e.$implicit;r.Dc("item",i)}}function Wr(t,e){if(1&t&&(r.mc(0,"perfect-scrollbar",19),r.dd(1,Qr,2,1,"library-tile",20),r.zc(2,"async"),r.lc()),2&t){var n=r.yc();r.Sb(1),r.Dc("ngForOf",r.Ac(2,1,n.items))}}var Zr=function(t){function e(e,n,i,a,r,o,s){var c=t.call(this,e,n,i,a,r,o,s)||this;return c.modalController=e,c.translate=n,c.commandService=i,c.state=a,c.ll=r,c.planPermManager=o,c.shapeManageService=s,c.id="google-img-search-results",c.trackingInfo={location:"FAB.GoogleSearch"},c}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"appConnectionStatus",{get:function(){var t=this;return this.state.changes(Mr.c).pipe(Object(g.a)((function(e){e===Mr.c.ONLINE?t.tags.next(t.searchTags):e===Mr.c.OFFLINE&&(t.items=null)})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyStateIcon",{get:function(){return"./assets/images/shape-search-result.svg"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upgradeMsgTitle",{get:function(){return"GOOGLE_SEARCH_IMPORT.UPGRADE_TITLE"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upgradeMsgBody",{get:function(){return["GOOGLE_SEARCH_IMPORT.UPGRADE_DESC"]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upgradeMsgButton",{get:function(){return{label:"LABELS.GOOGLE_UPGRADE",icon:null}},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.state.set("ShapeSearchQuery","")},e.prototype.ngAfterViewInit=function(){this.subs.push(this.listenShapeSearchQueryChanges().subscribe())},e.prototype.ngOnDestroy=function(){for(;this.subs.length;)this.subs.pop().unsubscribe();this.items=null},e.prototype.listenShapeSearchQueryChanges=function(){var t=this;return this.state.changes("ShapeSearchQuery").pipe(Object(g.a)((function(e){e&&t.searchImages(e)})))},e.\u0275fac=function(t){return new(t||e)(r.gc(i.kb),r.gc(o.e),r.gc(i.B),r.gc(i.Mb),r.gc(q.a),r.gc(xn.l),r.gc(_t.a))},e.\u0275cmp=r.ac({type:e,selectors:[["google-img-search-results"]],features:[r.Pb],decls:18,vars:24,consts:[[1,"image-import-container-tiles","fx-margin-top-15","container-padding"],["translate","",1,"fx-margin-bottom-15","body","google-search-content"],["class","fx-margin-top-10","color","secondary",4,"ngIf"],["class","fx-margin-top-10 fx-center",4,"ngIf"],[4,"ngIf"],["class","fx-margin-top-20 fx-center-column",4,"ngIf"],["class","col-menu-scrollbar",4,"ngIf"],["color","secondary",1,"fx-margin-top-10"],[1,"fx-margin-top-10","fx-center"],["translate","",1,"body","grey"],[3,"title","body","button","titleIcon","buttonClicked"],[1,"fx-margin-top-20","fx-center-column"],[1,"google-search-offline-message","fx-margin-bottom-10"],["translate","",1,"navy-blue","caption","fx-margin-bottom-5","fx-center-all"],["translate","",1,"google-search-content","caption"],[1,"service-unavailable-icon-container","fx-margin-bottom-10","fx-center-all"],[1,"nu-icon","nu-icon-med","light-nv-blue"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-warning"],["translate","",1,"grey","caption"],[1,"col-menu-scrollbar"],[3,"item","dragstart","mouseenter","mouseleave","clicked","closed",4,"ngFor","ngForOf"],[3,"item","dragstart","mouseenter","mouseleave","clicked","closed"],["tile",""]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"p",1),r.fd(2,"LABELS.GOOGLE_SEARCH_RESULTS"),r.lc(),r.dd(3,Ur,1,0,"loading-bubbles",2),r.zc(4,"async"),r.dd(5,zr,3,0,"div",3),r.zc(6,"async"),r.zc(7,"async"),r.dd(8,Yr,2,4,"div",4),r.zc(9,"async"),r.zc(10,"async"),r.dd(11,Xr,6,0,"div",5),r.zc(12,"async"),r.dd(13,Kr,9,0,"div",5),r.zc(14,"async"),r.zc(15,"async"),r.dd(16,Wr,3,3,"perfect-scrollbar",6),r.zc(17,"async"),r.lc()),2&t&&(r.Sb(3),r.Dc("ngIf",r.Ac(4,6,e.showLoadingIndicator)),r.Sb(2),r.Dc("ngIf",r.Ac(6,8,e.showResultsNotFound)&&!r.Ac(7,10,e.showUpgradeDialog)),r.Sb(3),r.Dc("ngIf",r.Ac(9,12,e.showUpgradeDialog)&&!(0===r.Ac(10,14,e.appConnectionStatus))),r.Sb(3),r.Dc("ngIf",0===r.Ac(12,16,e.appConnectionStatus)),r.Sb(2),r.Dc("ngIf",r.Ac(14,18,e.serviceUnavailable)&&!(0===r.Ac(15,20,e.appConnectionStatus))),r.Sb(3),r.Dc("ngIf",!r.Ac(17,22,e.showUpgradeDialog)))},directives:[o.a,Z.t,_e.a,br.a,mr.b,Z.s,Er.a],pipes:[Z.b],styles:["library-tile[_ngcontent-%COMP%]{display:inline-block;margin-right:16px;background:#fff}.container-padding[_ngcontent-%COMP%]{padding-left:8px;padding-right:8px}.image-import-container-tiles[_ngcontent-%COMP%]{height:calc(100% - 40px)}.image-import-container-tiles[_ngcontent-%COMP%]  .lib-tile-container{border-radius:4px;padding:2px;height:85px;border:1px solid #d3d3e7;overflow:hidden;width:85px;margin-right:1px;margin-left:1px;position:relative}.image-import-container-tiles[_ngcontent-%COMP%]  .thumb-img-container{height:100%}.col-menu-scrollbar[_ngcontent-%COMP%]   perfect-scrollbar[_ngcontent-%COMP%]{max-height:inherit}.google-search-content[_ngcontent-%COMP%]{color:#64767d}"],changeDetection:0}),e}(Vr),Jr=["textInput"];function $r(t,e){1&t&&r.hc(0,"panel-search-results",8,9)}function to(t,e){1&t&&r.hc(0,"google-img-search-results")}var eo=function(){return["Enter"]},no=function(){function t(t,e,n){this.state=t,this.elementRef=e,this.translate=n,this.selected="search",this.showSearchResults=new Y.a(!1),this.subs=[]}return Object.defineProperty(t.prototype,"icon",{get:function(){var t=this.items.find((function(t){return t.selected}));if(t)return t.icon},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return"search"===this.selected?"PLACEHOLDERS.SEARCH":"PLACEHOLDERS.GOOGLE_SEARCH"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return[{id:"search",label:"Creately Libraries",icon:"search-larger",selected:"search"===this.selected},{id:"google-search",label:"Google Images",icon:"google-search",selected:"google-search"===this.selected}]},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){this.subs.push(this.libraryStatusChange().subscribe())},t.prototype.onSearchTypeChange=function(t){if(this.textInput){var e=this.textInput.isEmpty.value?"":this.textInput.value||"";this.state.set("ShapeSearchQuery",e),this.selected=t,this.focus(),this.textInput.inputChange.next(e)}"google-search"===this.selected&&i.Ob.track("left.googlesearch.click")},t.prototype.libraryStatusChange=function(){var t=this;return this.state.changes("CurrentLibraries").pipe(Object(g.a)((function(){t.state.set("ShapeSearchQuery","")})))},t.prototype.showResults=function(t){t.length>2?(this.state.set("ShapeSearchQuery",t),this.showSearchResults.next(!0)):this.showSearchResults.next(!1)},t.prototype.clickOut=function(t){this.elementRef.nativeElement.contains(t.target)&&"text"===t.target.type&&this.textInput.value.length>2?this.showSearchResults.next(!0):this.showSearchResults.next(!1)},t.prototype.clear=function(){this.textInput.clear()},t.prototype.focus=function(){this.textInput.focus()},t.\u0275fac=function(e){return new(e||t)(r.gc(i.Mb),r.gc(r.r),r.gc(o.e))},t.\u0275cmp=r.ac({type:t,selectors:[["multi-search"]],viewQuery:function(t,e){var n;(1&t&&r.kd(Jr,!0),2&t)&&(r.Mc(n=r.vc())&&(e.textInput=n.first))},inputs:{selected:"selected"},decls:11,vars:14,consts:[[1,"fx-flex"],[1,"search-icon",3,"items","change"],["autoFocus","true",1,"search-input",3,"emitForInputChange","placeholder","debounce","submitOnCode","updateText","submit"],["textInput",""],[1,"search-results"],["translate","",1,"clear-btn","body","btn-link",3,"click"],["class","search-input",4,"ngIf"],[4,"ngIf"],[1,"search-input"],["searchPanel",""]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"search-type-dropdown",1),r.uc("change",(function(t){return e.onSearchTypeChange(t)})),r.lc(),r.mc(2,"text-input",2,3),r.uc("updateText",(function(t){return e.showResults(t)}))("submit",(function(t){return e.showResults(t)})),r.zc(4,"translate"),r.lc(),r.lc(),r.mc(5,"div",4),r.zc(6,"async"),r.mc(7,"a",5),r.uc("click",(function(){return e.clear()})),r.fd(8,"TOOLTIPS.CLEAR_TEXTBOX"),r.lc(),r.dd(9,$r,2,0,"panel-search-results",6),r.dd(10,to,1,0,"google-img-search-results",7),r.lc()),2&t&&(r.Sb(1),r.Dc("items",e.items),r.Sb(1),r.Ec("placeholder",r.Ac(4,9,e.placeholder)),r.Dc("emitForInputChange",!0)("debounce",100)("submitOnCode",r.Hc(13,eo)),r.Sb(3),r.Yb("fx-hidden",!r.Ac(6,11,e.showSearchResults)),r.Sb(4),r.Dc("ngIf","search"===e.selected),r.Sb(1),r.Dc("ngIf","google-search"===e.selected))},directives:[lr,J.a,o.a,Z.t,wr,Zr],pipes:[o.d,Z.b],styles:[".search-input[_ngcontent-%COMP%]{flex-grow:1}.search-input[_ngcontent-%COMP%]  .text-input-inner{height:40px;position:static;display:flex;flex-flow:row-reverse;align-items:center}.search-input[_ngcontent-%COMP%]  .text-input{margin-top:0;font-family:Inter,Arial,sans-serif,ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Noto Sans,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-size:1rem;font-weight:400;border:0}.clear-btn[_ngcontent-%COMP%]{margin:1rem;position:absolute;z-index:3;right:0;color:#0c5e96}.search-results[_ngcontent-%COMP%]{position:absolute;background:#fff;z-index:2;width:100%;height:calc(100% - 130px)}.search-icon[_ngcontent-%COMP%]{align-items:center;display:flex}"],changeDetection:0}),t}(),io=n("XCiK"),ao=n("o+Mh");function ro(t,e){if(1&t&&(r.mc(0,"div",9),r.hc(1,"message-card",10),r.lc()),2&t){var n=r.yc();r.Sb(1),r.Dc("title",n.msgTitle)("body",n.msgBody)("titleIcon",n.emptyStateIcon)}}function oo(t,e){if(1&t){var n=r.nc();r.mc(0,"library-tile",11,12),r.uc("dragstart",(function(t){r.Qc(n);var i=e.$implicit;return r.yc().handleDragStart(t,i.data)}))("mouseenter",(function(t){r.Qc(n);var i=e.$implicit;return r.yc().handleMouseEnter(i,t)}))("mouseleave",(function(t){return r.Qc(n),r.yc().handleMouseLeave(t)}))("clicked",(function(t){r.Qc(n);var i=e.$implicit;return r.yc().handleClick(t,i.data)}))("closed",(function(t){return r.Qc(n),r.yc().handleClose(t)})),r.lc()}if(2&t){var i=e.$implicit;r.Dc("item",i)}}var so,co,lo=function(t){function e(e,n,i,a,r,o,s){var c=t.call(this,e,n,i,a,r,o,s)||this;return c.modalController=e,c.translate=n,c.commandService=i,c.state=a,c.ll=r,c.planPermManager=o,c.shapeManageService=s,c.id="image-import-container",c.importMode=!0,c.trackingInfo={location:"FAB.Images"},c}return Object(u.e)(e,t),Object.defineProperty(e.prototype,"msgTitle",{get:function(){return"FILE_IMPORTS.ADD_IMAGES"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"msgBody",{get:function(){return["FILE_IMPORTS.TO_ADD_IMAGES"]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyStateIcon",{get:function(){return"./assets/images/fab/fab-empty-state.svg"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appConnectionStatus",{get:function(){var t=this;return this.state.changes(Mr.c).pipe(Object(g.a)((function(e){"asset"===t.state.get("SelectedFloatingPanel")&&(e===Mr.c.ONLINE?t.importMode||t.tags.next(t.searchTags):e===Mr.c.OFFLINE&&(t.importMode?t.items=t.getUploadedImages():t.items=null))})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"locator",{get:function(){return this.ll.forCurrent(!1)},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.items=this.getUploadedImages()},e.prototype.ngOnDestroy=function(){for(;this.subs.length;)this.subs.pop().unsubscribe();this.items=null},e.prototype.handleDragStart=function(t,e){this.importMode?i.Ob.track("left.image.import.drag",{value1Type:"imageLink",value1:e.url}):i.Ob.track("left.googleSearch.shape.drag",{value1Type:"imageName",value1:e.name,value2Type:"imageSource",value2:e.url}),this.hidePopoverPreview();var n=t.target.querySelector(".shape-thumbnail-image");t.dataTransfer.effectAllowed="move",e.upload=!this.importMode,t.dataTransfer.setData("URLData",JSON.stringify(e)),t.dataTransfer.setDragImage(n,n.width/2,n.height/2)},e.prototype.handleClose=function(t){if(this.importMode){i.Ob.track("left.image.import.remove",{value1Type:"imageHash",value1:t});var e={};e[t]={action:"remove"},this.commandService.dispatch(Q.a.changeImageGallery,e),this.hidePopoverPreview()}},e.prototype.openImportImageWindow=function(){var t=this;this.switchImportMode(!0);var e={note:this.translate.instant("FILE_IMPORTS.FILE_MAX_MSG")};this.modalController.show(ao.a,{inputs:{importOptions:{allowMultipleUploads:!1,restrictions:{maxFileSize:5e6,maxNumberOfFiles:1,minNumberOfFiles:1,allowedFileTypes:[".jpg",".jpeg",".bmp",".gif",".ico",".svg",".png"]}},uiOptions:e,onComplete:function(e){return t.onImageUploadCompletion(e)}}})},e.prototype.switchImportMode=function(t){this.importMode!==t&&(this.importMode=t,this.items=t?this.getUploadedImages():Object(I.a)([]))},e.prototype.onImageUploadCompletion=function(t){this.commandService.dispatch(Q.a.importImageAndUpload,void 0,{files:t})},e.prototype.getUploadedImages=function(){return this.locator.getDiagramModel().pipe(Object(m.a)((function(t){return Object(x.clone)(t.imageGallery)})),Object(bt.a)(x.isEqual),Object(m.a)((function(t){var e=[];return Object(x.forEach)(t,(function(t,n){var a=i.m.get("CUSTOM_IMAGE_BASE_URL")+n;e.push({id:n,type:"image",thumbnailUrl:a,closeButton:!0,thumbnailType:"image",text:{},data:{name:n,url:a},added:t.added})})),Object(x.reverse)(Object(x.sortBy)(e,["added"]))})))},e.\u0275fac=function(t){return new(t||e)(r.gc(i.kb),r.gc(o.e),r.gc(i.B),r.gc(i.Mb),r.gc(q.a),r.gc(xn.l),r.gc(_t.a))},e.\u0275cmp=r.ac({type:e,selectors:[["image-import-container"]],features:[r.Pb],decls:12,vars:6,consts:[[1,"image-import-container"],[1,"image-import-container-tiles"],[1,"btn-link","btn-medium","nu-ic-upload","fx-center",3,"click"],[1,"nu-icon","nu-icon-xsmall","fx-margin-right-5","upload-btn"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-upload"],["translate",""],["class","fx-margin-right-16",4,"ngIf"],[1,"col-menu-scrollbar"],[3,"item","dragstart","mouseenter","mouseleave","clicked","closed",4,"ngFor","ngForOf"],[1,"fx-margin-right-16"],[3,"title","body","titleIcon"],[3,"item","dragstart","mouseenter","mouseleave","clicked","closed"],["tile",""]],template:function(t,e){if(1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"button",2),r.uc("click",(function(){return e.openImportImageWindow()})),r.xc(),r.mc(3,"svg",3),r.hc(4,"use",4),r.lc(),r.wc(),r.mc(5,"span",5),r.fd(6,"FILE_IMPORTS.UPLOAD"),r.lc(),r.lc(),r.dd(7,ro,2,3,"div",6),r.zc(8,"async"),r.mc(9,"perfect-scrollbar",7),r.dd(10,oo,2,1,"library-tile",8),r.zc(11,"async"),r.lc(),r.lc(),r.lc()),2&t){var n;r.Sb(7),r.Dc("ngIf",0===(null==(n=r.Ac(8,2,e.items))?null:n.length)),r.Sb(3),r.Dc("ngForOf",r.Ac(11,4,e.items))}},directives:[o.a,Z.t,mr.b,Z.s,br.a,Er.a],pipes:[Z.b],styles:[".image-import-container[_ngcontent-%COMP%]{height:100%}library-tile[_ngcontent-%COMP%]{margin-right:.125rem;display:inline-block;background:#fff}.image-import-container-tiles[_ngcontent-%COMP%]{max-height:inherit;height:100%}.image-import-container-tiles[_ngcontent-%COMP%]  .lib-tile-container{padding:.125rem;margin-left:.5rem;margin-right:.5rem;border-radius:4px;height:86px;overflow:hidden;width:86px;position:relative}.image-import-container-tiles[_ngcontent-%COMP%]  .lib-tile-container  .thumb-img-image-container{height:auto;width:auto}.image-import-container-tiles[_ngcontent-%COMP%]  .lib-tile-container  .thumb-img-image-container img{max-width:60px!important;max-height:60px!important;width:auto;height:auto}.image-import-container-tiles[_ngcontent-%COMP%]  .lib-tile-container  .thumb-img-container{height:100%}.col-menu-scrollbar[_ngcontent-%COMP%]{height:200px}.nu-ic-upload[_ngcontent-%COMP%]{margin-bottom:.25rem;margin-top:1.25rem;display:flex}.nu-icon[_ngcontent-%COMP%]{color:#1381cd}.nu-icon[_ngcontent-%COMP%]:hover{color:#0c5e96}"],changeDetection:0}),e}(Vr),uo=function(){function t(){this.id="asset",this.hasSearch=!1,this.isPinned=!0}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.ac({type:t,selectors:[["asset-panel"]],decls:2,vars:0,consts:[[1,"floating-panel","quick-toolbar-panel"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.hc(1,"image-import-container"),r.lc())},directives:[lo],styles:[".floating-panel[_ngcontent-%COMP%]{pointer-events:auto}.floating-panel[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%}.lib-padding[_ngcontent-%COMP%]{padding-left:.5rem;padding-right:.5rem}"],changeDetection:0}),t}();function po(t,e){if(1&t&&(r.xc(),r.mc(0,"svg",4),r.hc(1,"use"),r.lc()),2&t){var n=r.yc();r.Dc("ngClass","nu-icon-"+n.icon),r.Sb(1),r.Tb("href","./assets/icons/symbol-defs.svg#nu-ic-fab-close",null,"xlink")}}!function(t){t.normal="normal",t.large="large"}(so||(so={})),function(t){t.rotate="rotate",t.background="background"}(co||(co={}));var ho,go=function(t,e){return[t,e]},fo=function(){function t(){this.icon="",this.tooltipPlacement=z.u.top,this.size=so.normal,this.active=!1,this.activeAnimation=co.background}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.ac({type:t,selectors:[["floating-action-button"]],inputs:{id:"id",icon:"icon",tooltipPlacement:"tooltipPlacement",size:"size",active:"active",activeAnimation:"activeAnimation",tooltip:"tooltip"},decls:6,vars:12,consts:[["class","fab-close-design nu-icon nu-icon-xlarge",3,"ngClass",4,"ngIf"],["tooltip","",1,"floating-action-button","fx-button","fx-round","fx-pointer-events-auto","btn-primary",3,"ngClass","deactivated","placement"],[1,"nu-icon",3,"ngClass"],["translate","",1,"tooltip-content"],[1,"fab-close-design","nu-icon","nu-icon-xlarge",3,"ngClass"]],template:function(t,e){1&t&&(r.dd(0,po,2,2,"svg",0),r.mc(1,"button",1),r.xc(),r.mc(2,"svg",2),r.hc(3,"use"),r.lc(),r.wc(),r.mc(4,"span",3),r.fd(5),r.lc(),r.lc()),2&t&&(r.Dc("ngIf",!e.active),r.Sb(1),r.Yb("active",e.active),r.Dc("ngClass",r.Jc(9,go,e.size,e.activeAnimation))("deactivated",!e.tooltip)("placement",e.tooltipPlacement),r.Sb(1),r.Dc("ngClass","nu-icon-"+e.icon),r.Sb(1),r.Tb("href","./assets/icons/symbol-defs.svg#nu-ic-"+e.icon,null,"xlink"),r.Sb(2),r.gd(e.tooltip))},directives:[Z.t,_a.a,Z.q,o.a],styles:[".fab-close-design[_ngcontent-%COMP%]{position:absolute;left:-7px;bottom:0;z-index:-1}.floating-action-button[_ngcontent-%COMP%]{pointer-events:all;margin:0;box-shadow:0 12px 32px rgba(0,0,0,.05),0 8px 10px rgba(0,0,0,.05),0 2px 2px rgba(0,0,0,.05)}.floating-action-button[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{will-change:transform;transition:transform .25s linear}.floating-action-button.large[_ngcontent-%COMP%]{height:56px;width:56px}.floating-action-button.large[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{width:24px;height:24px;stroke-width:1px;transition:transform .25s linear}.floating-action-button.rotate[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{color:#fff}.floating-action-button.rotate.active[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{transform:rotate(45deg)}.floating-action-button.background[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{color:#04263d}.floating-action-button.background.active[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{color:#fff}.floating-action-button.background[_ngcontent-%COMP%]:not(.active){background:#fff}"]}),t}();!function(t){t.Closed="closed",t.Opening="opening",t.Opened="opened",t.Closing="closing"}(ho||(ho={}));var bo=n("wkyi"),mo=n("gedj"),vo=n("kZAw"),yo=n("Ownj"),So=function(){function t(t,e){this.state=t,this.libraryList=e}return t.prototype.ngOnInit=function(){var t=this;this.state.changes("SelectedFloatingPanel").pipe(Object(d.a)((function(t){return"icons"===t})),Object(b.a)(3)).subscribe((function(){t.addStickers(),t.loadIconLibraries()}))},t.prototype.addStickers=function(){this.collapsibleMenu.add(bo.a,mo.a,{id:"quick-tool-stickers",trackingInfo:{location:"FAB.Icons"}},!1,{isPremium:!1,collapsable:!1})},t.prototype.loadIconLibraries=function(){var t=this;this.libraryList.getAllIconLibraries().filter((function(e){return!t.collapsibleMenu.has(e.id)})).forEach((function(e){return t.collapsibleMenu.add(bo.a,vo.a,{id:e.id,isCollapsed:!1,trackingInfo:{location:"FAB.Icons"}},!1,{isPremium:!1})}))},t.\u0275fac=function(e){return new(e||t)(r.gc(i.Mb),r.gc(sa.a))},t.\u0275cmp=r.ac({type:t,selectors:[["icons-library-container"]],viewQuery:function(t,e){var n;(1&t&&r.Xc(i.t,!0),2&t)&&(r.Mc(n=r.vc())&&(e.collapsibleMenu=n.first))},decls:3,vars:0,consts:[[1,"lib-container"],[1,"col-menu-scrollbar"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"perfect-scrollbar",1),r.hc(2,"collapsible-menu"),r.lc(),r.lc())},directives:[mr.b,yo.a],styles:[".lib-container[_ngcontent-%COMP%], [_nghost-%COMP%]{max-height:inherit;height:100%}.lib-container[_ngcontent-%COMP%]   .lib-collapsible-menu[_ngcontent-%COMP%], [_nghost-%COMP%]   .lib-collapsible-menu[_ngcontent-%COMP%]{padding-right:.25rem}.lib-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.lib-container[_ngcontent-%COMP%]   perfect-scrollbar[_ngcontent-%COMP%]{max-height:inherit}.lib-container[_ngcontent-%COMP%]  .ps-content{margin-right:.625rem}.lib-message[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),t}(),Oo=function(){function t(){this.id="icons",this.hasSearch=!0,this.isPinned=!0}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.ac({type:t,selectors:[["icons-panel"]],decls:2,vars:0,consts:[[1,"floating-panel","icons-panel"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.hc(1,"icons-library-container"),r.lc())},directives:[So],styles:[".floating-panel[_ngcontent-%COMP%]{pointer-events:auto}.floating-panel[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%}"],changeDetection:0}),t}(),xo=function(){function t(t,e){this.state=t,this.libraryList=e}return t.prototype.ngOnInit=function(){var t=this;this.state.changes("SelectedFloatingPanel").pipe(Object(d.a)((function(t){return"frames"===t})),Object(b.a)(3)).subscribe((function(){t.loadIconLibraries()}))},t.prototype.loadIconLibraries=function(){var t=this;this.libraryList.getAllFramesLibraries().filter((function(e){return!t.collapsibleMenu.has(e.id)})).forEach((function(e){return t.collapsibleMenu.add(bo.a,vo.a,{id:e.id,trackingInfo:{location:"FAB.Frames"}},!1,{isPremium:!1,collapsable:!1})}))},t.\u0275fac=function(e){return new(e||t)(r.gc(i.Mb),r.gc(sa.a))},t.\u0275cmp=r.ac({type:t,selectors:[["frames-library-container"]],viewQuery:function(t,e){var n;(1&t&&r.Xc(i.t,!0),2&t)&&(r.Mc(n=r.vc())&&(e.collapsibleMenu=n.first))},decls:3,vars:0,consts:[[1,"lib-container"],["tooltip-tour-step","data-6",1,"col-menu-scrollbar"],[1,"lib-collapsible-menu"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"perfect-scrollbar",1),r.hc(2,"collapsible-menu",2),r.lc(),r.lc())},directives:[mr.b,Ae.a,yo.a],styles:[".lib-container[_ngcontent-%COMP%], [_nghost-%COMP%]{height:inherit}.lib-container[_ngcontent-%COMP%]   .lib-collapsible-menu[_ngcontent-%COMP%], [_nghost-%COMP%]   .lib-collapsible-menu[_ngcontent-%COMP%]{padding-right:4px}.lib-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:inherit}.lib-container[_ngcontent-%COMP%]  .ps-content{margin-right:10px}.lib-container[_ngcontent-%COMP%]  .col-menu-item-heading-title{padding-left:5px}.lib-message[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),t}(),Co=function(){function t(){this.id="frames",this.hasSearch=!0,this.isPinned=!0}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.ac({type:t,selectors:[["frames-panel"]],decls:2,vars:0,consts:[["tooltip-tour-step","fab-1.3",1,"floating-panel","frames-panel"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.hc(1,"frames-library-container"),r.lc())},directives:[Ae.a,xo],styles:[".floating-panel[_ngcontent-%COMP%]{pointer-events:auto}.floating-panel[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%}"],changeDetection:0}),t}(),To=function(){function t(t,e){this.state=t,this.libraryList=e}return t.prototype.ngOnInit=function(){var t=this;this.state.changes("SelectedFloatingPanel").pipe(Object(d.a)((function(t){return"embeds"===t})),Object(b.a)(3)).subscribe((function(){t.loadIconLibraries()}))},t.prototype.loadIconLibraries=function(){var t=this;this.libraryList.getAllEmbedsLibraries().filter((function(e){return!t.collapsibleMenu.has(e.id)})).forEach((function(e){return t.collapsibleMenu.add(bo.a,vo.a,{id:e.id,trackingInfo:{location:"FAB.Embeds"}},!1,{isPremium:!1,collapsable:!1})}))},t.\u0275fac=function(e){return new(e||t)(r.gc(i.Mb),r.gc(sa.a))},t.\u0275cmp=r.ac({type:t,selectors:[["embeds-library-container"]],viewQuery:function(t,e){var n;(1&t&&r.Xc(i.t,!0),2&t)&&(r.Mc(n=r.vc())&&(e.collapsibleMenu=n.first))},decls:3,vars:0,consts:[[1,"lib-container"],["tooltip-tour-step","data-6",1,"col-menu-scrollbar"],[1,"lib-collapsible-menu"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"perfect-scrollbar",1),r.hc(2,"collapsible-menu",2),r.lc(),r.lc())},directives:[mr.b,Ae.a,yo.a],styles:[".lib-container[_ngcontent-%COMP%], [_nghost-%COMP%]{height:inherit}.lib-container[_ngcontent-%COMP%]   .lib-collapsible-menu[_ngcontent-%COMP%], [_nghost-%COMP%]   .lib-collapsible-menu[_ngcontent-%COMP%]{padding-right:4px}.lib-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:inherit}.lib-container[_ngcontent-%COMP%]  .ps-content{margin-right:10px}.lib-container[_ngcontent-%COMP%]  .col-menu-item-heading-title{padding-left:5px}.lib-message[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),t}(),jo=function(){function t(){this.id="embeds",this.hasSearch=!0,this.isPinned=!0}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.ac({type:t,selectors:[["embeds-panel"]],decls:2,vars:0,consts:[["tooltip-tour-step","fab-1.3",1,"floating-panel","embeds-panel"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.hc(1,"embeds-library-container"),r.lc())},directives:[Ae.a,To],styles:[".floating-panel[_ngcontent-%COMP%]{pointer-events:auto}.floating-panel[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%}"],changeDetection:0}),t}(),Po=n("CrNP"),wo=function(){function t(t,e,n,i,a,r){this.translate=t,this.state=e,this.modalController=n,this.commandService=i,this.libraryList=a,this.recentShapeService=r,this.toolbarButtons=new Y.a([]),this.defaultLibraryId="general",this.previousLibsCount=0,this.currLibPosition=0,this.currFocusLibs={},this.recentShapesPanelId="recent-shapes",this.triggerScrollUpdate=new Se.a,this.subs=[],this.currentLibrariesState=this.state,this.currentLibraryGroupState=this.state}return Object.defineProperty(t.prototype,"activeToolbarButton",{get:function(){return this.state.get("CurrentLibraryGroup")},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.subs.push(this.handleDispatchUpdateLibrariesCommand().subscribe(),this.listenToFloatingPanelChanges().subscribe(),this.listenToToolbarButtonChanges().subscribe(),this.onChildRemoved().subscribe(),this.onChildToggle().subscribe(),this.scrollWhenAllLoaded().subscribe(),this.triggerScrollUpdate.pipe(Object(d.a)((function(t){return!!t})),Object(g.a)((function(){return t.updateScrollPosition()}))).subscribe())},t.prototype.ngOnDestroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},t.prototype.updateScrollPosition=function(){var t=this.state.get("CurrentLibraryGroup");this.currFocusLibs[t]=this.directiveScroll.directiveRef.elementRef.nativeElement.scrollTop||1},t.prototype.openLibraryBrowser=function(){this.modalController.show(dr.a)},t.prototype.listenToToolbarButtonChanges=function(){var t=this;return this.state.changes("CurrentLibraries").pipe(Object(d.a)((function(t){return t&&t.length>0})),Object(f.a)((function(e){return t.getLibraryGroups(e)})),Object(d.a)((function(t){return!!t})),Object(g.a)((function(e){var n=e.map((function(t){return{id:t,label:t}}));t.toolbarButtons.next(n)})))},t.prototype.getLibraryGroups=function(t){return Object(I.a)(t).pipe(Object(m.a)((function(t){return t.map((function(t){return t.libGroup}))})),Object(m.a)((function(t){return Object(x.uniq)(t)})))},t.prototype.initLibrary=function(){var t=this;return Object(Ee.b)([this.currentLibrariesState.changes("CurrentLibraries"),this.currentLibraryGroupState.changes("CurrentLibraryGroup")]).pipe(Object(d.a)((function(t){var e=Object(u.h)(t,2),n=e[0],i=e[1];return!!n&&!!i})),Object(m.a)((function(e){var n=Object(u.h)(e,2),i=n[0],a=n[1];return t.currFocusLibs[a]=0,i.filter((function(t){return t.libGroup===a}))})),Object(b.a)(1),Object(g.a)((function(e){t.updateMenu(e),t.subs.push(t.listenToRecentShapeChanges().subscribe())})))},t.prototype.scrollWhenAllLoaded=function(){var t=this;return this.currentLibrariesState.changes("CurrentLibraries").pipe(Object(d.a)((function(t){return t.filter((function(t){return"loaded"===t.status})).length===t.length})),Object(K.a)(1),Object(g.a)((function(e){if(t.previousLibsCount<e.length){var n=t.state.get("CurrentLibraryGroup");t.currFocusLibs[n]?t.scrollToYPos(t.currFocusLibs[n]):t.scrollToLibrary(e.length-1),t.previousLibsCount=e.length}})))},t.prototype.scrollToLibrary=function(t){var e=this.directiveScroll.directiveRef.elementRef.nativeElement.getBoundingClientRect(),n=this.directiveScroll.directiveRef.geometry(),i=this.collapsibleMenu.children?this.collapsibleMenu.getChildBounds(t):void 0;i&&i.height>e.height?this.directiveScroll.directiveRef.scrollToY(n.h-i.height,100):this.directiveScroll.directiveRef.scrollToBottom(-75,100),this.updateScrollPosition()},t.prototype.scrollToYPos=function(t){this.directiveScroll.directiveRef.geometry().h>t?this.directiveScroll.directiveRef.scrollToY(t,100):this.directiveScroll.directiveRef.scrollToBottom(-75,100)},t.prototype.listenToFloatingPanelChanges=function(){var t=this;return this.state.changes("SelectedFloatingPanel").pipe(Object(d.a)((function(t){return"shapes"===t})),Object(b.a)(3),Object(g.a)((function(){return t.initLibrary().subscribe()})),Object(f.a)((function(){return t.listenToLibraryChanges()})))},t.prototype.handleDispatchUpdateLibrariesCommand=function(){var t=this;return this.currentLibrariesState.changes("CurrentLibraries").pipe(Object(d.a)((function(t){return!!t})),Object(K.a)(1),Object(bt.a)((function(t,e){return Object(x.isEqual)(t.map((function(t){return t.id})).sort(),e.map((function(t){return t.id})).sort())})),Object(g.a)((function(e){t.dispatchUpdateLibrariesCommand(e)})))},t.prototype.listenToLibraryChanges=function(){var t=this;return Object(Ee.b)([this.currentLibrariesState.changes("CurrentLibraries"),this.currentLibraryGroupState.changes("CurrentLibraryGroup")]).pipe(Object(mt.a)(),Object(d.a)((function(t){var e=Object(u.h)(t,2),n=Object(u.h)(e[0],2),i=n[0],a=n[1],r=Object(u.h)(e[1],2),o=r[0],s=r[1];return!(!o||!s||i.length===o.length&&a===s)})),Object(m.a)((function(e){var n=Object(u.h)(e,2),i=Object(u.h)(n[0],2),a=(i[0],i[1],Object(u.h)(n[1],2)),r=a[0],o=a[1];return t.currLibPosition=r.length-1,r.filter((function(t){return t.libGroup===o}))})),Object(g.a)((function(e){t.updateMenu(e),t.previousLibsCount>e.length&&(t.previousLibsCount=e.length)})))},t.prototype.dispatchUpdateLibrariesCommand=function(t){this.commandService.dispatch(Q.a.updateLibraries,{libraries:t})},t.prototype.onChildToggle=function(){var t=this;return this.collapsibleMenu.childToggled.pipe(Object(g.a)((function(e){var n=t.state.get("CurrentLibraries").map((function(t){return t.id===e&&(t.isCollapsed=!t.isCollapsed),t}));t.currLibPosition=n.findIndex((function(t){return t.id===e})),t.state.set("CurrentLibraries",n),t.dispatchUpdateLibrariesCommand(n)})))},t.prototype.onChildRemoved=function(){var t=this;return this.collapsibleMenu.childRemoved.pipe(Object(Tt.a)(1),Object(g.a)((function(e){i.Ob.track("left.library.section.header.close",{value1Type:"libraryId",value1:e});var n=t.currentLibrariesState.get("CurrentLibraries"),a=t.currentLibraryGroupState.get("CurrentLibraryGroup"),r=n.filter((function(t){return t.id!==e}));if(t.libraryList.getMainGroupForLibrary(e).includes(a)&&!r.find((function(t){return t.libGroup===a}))){delete t.currFocusLibs[a];var o=r[r.length-1].libGroup;t.currentLibraryGroupState.set("CurrentLibraryGroup",o),t.currentLibrariesState.set("CurrentLibraries",r)}t.currentLibrariesState.set("CurrentLibraries",r)})))},t.prototype.updateMenu=function(t){this.addLibrariesToMenu(t),this.removeOtherLibrariesFromMenu(t);var e=this.state.get("CurrentLibraryGroup");0===this.directiveScroll.directiveRef.elementRef.nativeElement.scrollTop||this.directiveScroll.directiveRef.elementRef.nativeElement.scrollTop===this.currFocusLibs[e]?this.scrollToLibrary(this.currLibPosition):this.scrollToYPos(this.currFocusLibs[e])},t.prototype.addLibrariesToMenu=function(t){var e=this;t.length<=0||t.filter((function(t){return!e.collapsibleMenu.has(t.id)&&t.type===fi.c.Static})).forEach((function(t){var n=e.libraryList.belongsToPremiumGroup(t.id);t.id.includes("custom-database-")?e.collapsibleMenu.add(bo.a,mo.a,{id:t.id,isCollapsed:t.isCollapsed,trackingInfo:{location:"FAB.Shapes"}},!1,{isPremium:n}).subscribe():e.collapsibleMenu.add(bo.a,vo.a,{id:t.id,isCollapsed:t.isCollapsed,trackingInfo:{location:"FAB.Shapes"}},!1,{isPremium:n}).subscribe()}))},t.prototype.removeOtherLibrariesFromMenu=function(t){var e=this;this.collapsibleMenu.panels.forEach((function(n){n.id!==e.recentShapesPanelId&&(t.find((function(t){return t.id===n.id}))||e.collapsibleMenu.detachById(n.id).subscribe())}))},t.prototype.listenToRecentShapeChanges=function(){var t=this;return this.recentShapeService.getShapes().pipe(Object(g.a)((function(e){var n=t.state.get("CurrentLibraryGroup");!t.collapsibleMenu.has(t.recentShapesPanelId)||"Shapes"===n&&0!==e.length?!t.collapsibleMenu.has(t.recentShapesPanelId)&&"Shapes"===n&&e.length>0&&t.collapsibleMenu.add(bo.a,mo.a,{id:t.recentShapesPanelId,isCollapsed:!1,trackingInfo:{location:"FAB.Shapes"}},!1,{isPremium:!1},0).subscribe():t.collapsibleMenu.detachById(t.recentShapesPanelId).subscribe()})))},t.\u0275fac=function(e){return new(e||t)(r.gc(o.e),r.gc(i.Mb),r.gc(i.kb),r.gc(i.B),r.gc(sa.a),r.gc(Po.a))},t.\u0275cmp=r.ac({type:t,selectors:[["shapes-library-container"]],viewQuery:function(t,e){var n;(1&t&&(r.Xc(i.t,!0),r.Xc(mr.b,!0)),2&t)&&(r.Mc(n=r.vc())&&(e.collapsibleMenu=n.first),r.Mc(n=r.vc())&&(e.directiveScroll=n.first))},inputs:{triggerScrollUpdate:"triggerScrollUpdate"},decls:6,vars:0,consts:[["tooltip-tour-step","fab-1.4",1,"shape-lib-container"],[1,"lib-scroll-container"],[1,"col-menu-scrollbar"],[1,"lib-collapsible-menu"],["translate","",1,"lib-message","grey","body"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"perfect-scrollbar",2),r.hc(3,"collapsible-menu",3),r.lc(),r.lc(),r.mc(4,"p",4),r.fd(5,"LABELS.YOU_HAVE_NOT_ADDED_ANY_SHAPES"),r.lc(),r.lc())},directives:[Ae.a,mr.b,yo.a,o.a],styles:[".shape-lib-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%}.shape-lib-container[_ngcontent-%COMP%]   .lib-collapsible-menu[_ngcontent-%COMP%]{padding-right:4px}.lib-scroll-container[_ngcontent-%COMP%]{width:100%;height:inherit}.lib-scroll-container[_ngcontent-%COMP%]  .ps-content{margin-right:10px}.lib-message[_ngcontent-%COMP%]{display:none}.lib-toolbar[_ngcontent-%COMP%]{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;width:260px;bottom:68px;position:absolute}.close-btn[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;height:25px}.nu-btn-icon[_ngcontent-%COMP%]{padding:0}.nu-icon-med[_ngcontent-%COMP%]{width:30px;height:30px;color:rgba(98,104,106,.6)}.nu-icon-med[_ngcontent-%COMP%]:hover{cursor:pointer;color:rgba(41,53,56,.7)}"],changeDetection:0}),t}(),Mo=function(){function t(t,e){this.state=t,this.modalController=e,this.id="shapes",this.hasSearch=!0,this.isPinned=!0,this.hasOpenLibraries=new Y.a(!1),this.subs=[]}return t.prototype.ngOnInit=function(){this.subs.push(this.listenToHasOpenLibrariesChanges().subscribe())},t.prototype.ngOnDestroy=function(){for(this.hasOpenLibraries.unsubscribe();this.subs.length;)this.subs.pop().unsubscribe()},t.prototype.handleMoreButtonClick=function(){this.openLibraryBrowser()},t.prototype.openLibraryBrowser=function(){this.modalController.show(dr.a).subscribe()},t.prototype.listenToHasOpenLibrariesChanges=function(){var t=this;return this.state.changes("CurrentLibraries").pipe(Object(m.a)((function(t){return t&&t.length>0})),Object(bt.a)(),Object(g.a)((function(e){return t.hasOpenLibraries.next(e)})))},t.\u0275fac=function(e){return new(e||t)(r.gc(i.Mb),r.gc(i.kb))},t.\u0275cmp=r.ac({type:t,selectors:[["shapes-panel"]],inputs:{triggerScrollUpdate:"triggerScrollUpdate"},decls:3,vars:5,consts:[[1,"floating-panel","shapes-panel"],[3,"triggerScrollUpdate"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.zc(1,"async"),r.hc(2,"shapes-library-container",1),r.lc()),2&t&&(r.Yb("no-libraries",!r.Ac(1,3,e.hasOpenLibraries)),r.Sb(2),r.Dc("triggerScrollUpdate",e.triggerScrollUpdate))},directives:[wo],pipes:[Z.b],styles:[".floating-panel[_ngcontent-%COMP%]{pointer-events:auto}.floating-panel[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%}.shapes-panel.no-libraries[_ngcontent-%COMP%]  .lib-shapes{height:0}.shapes-panel.no-libraries[_ngcontent-%COMP%]  .lib-message{display:block;padding:10px 10px 0}"],changeDetection:0}),t}(),Io=n("Q0Yk");function Eo(t,e){if(1&t&&(r.xc(),r.mc(0,"svg",4),r.hc(1,"use"),r.lc()),2&t){var n=r.yc();r.Dc("ngClass","nu-icon-"+n.icon),r.Sb(1),r.Tb("href","./assets/icons/symbol-defs.svg#nu-ic-"+n.icon,null,"xlink")}}function Do(t,e){if(1&t&&r.hc(0,"img",5),2&t){var n=r.yc();r.Ec("src",n.icon,r.Tc)}}var ko=function(){function t(){this.icon="",this.label="",this.active=!1,this.selected=!1,this.isImage=!1}return t.prototype.ngAfterViewInit=function(){this.isImage=this.icon&&this.icon.includes("/assets/images/")},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.ac({type:t,selectors:[["panel-toolbar-button"]],inputs:{id:"id",icon:"icon",label:"label",active:"active",selected:"selected",tooltip:"tooltip"},decls:6,vars:9,consts:[["tooltip","",1,"panel-toolbar-button","btn-small","btn-secondary","body","fx-pointer-events-auto",3,"deactivated"],["class","nu-icon",3,"ngClass",4,"ngIf"],["class","nu-icon nu-icon-xsmall",3,"src",4,"ngIf"],["translate","",1,"tooltip-content"],[1,"nu-icon",3,"ngClass"],[1,"nu-icon","nu-icon-xsmall",3,"src"]],template:function(t,e){1&t&&(r.mc(0,"button",0),r.dd(1,Eo,2,2,"svg",1),r.dd(2,Do,1,1,"img",2),r.mc(3,"span",3),r.fd(4),r.lc(),r.fd(5),r.lc()),2&t&&(r.Yb("has-icon-only",!!e.icon&&!e.label)("active",e.active),r.Dc("deactivated",!e.tooltip),r.Sb(1),r.Dc("ngIf",e.icon&&!e.isImage),r.Sb(1),r.Dc("ngIf",e.isImage),r.Sb(2),r.gd(e.tooltip),r.Sb(1),r.hd(" ",e.label,"\n"))},directives:[_a.a,Z.t,o.a,Z.q],styles:[".panel-toolbar-button[_ngcontent-%COMP%]{padding:.375rem .5rem;background:#fff;border:1px solid #e9e9e9;border-radius:6px;color:#04263d;height:36px;white-space:nowrap;cursor:pointer;display:flex;align-items:center}.panel-toolbar-button.has-icon-only[_ngcontent-%COMP%]{width:32px}.panel-toolbar-button[_ngcontent-%COMP%]:not(.has-icon-only){padding:.5rem .75rem}.panel-toolbar-button.active[_ngcontent-%COMP%], .panel-toolbar-button[_ngcontent-%COMP%]:hover{background:#e1f1fb}.panel-toolbar-button[_ngcontent-%COMP%]   .nu-icon-pin[_ngcontent-%COMP%]{width:14px;height:14px}.panel-toolbar-button[_ngcontent-%COMP%]   .nu-icon[_ngcontent-%COMP%]{margin-right:8px}"]}),t}(),Ao=["panelTagContainer"],_o=["slider"];function Lo(t,e){if(1&t){var n=r.nc();r.mc(0,"panel-toolbar-button",5),r.uc("click",(function(){r.Qc(n);var t=e.$implicit;return r.yc().onButtonClick(t.id)})),r.lc()}if(2&t){var i=e.$implicit,a=r.yc();r.Dc("icon",null==i?null:i.icon)("label",null==i?null:i.label)("active",a.activeButton==i.id)}}var Ro=function(){function t(t){this.state=t,this._buttons=new Y.a([]),this.orderedBtns=new Y.a([]),this.buttonClick=new r.t,this.subs=[]}return Object.defineProperty(t.prototype,"buttons",{get:function(){return this._buttons.value},set:function(t){this._buttons.next(t)},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){this.subs.push(this.listenToButtonChanges().subscribe())},t.prototype.ngOnChanges=function(){var t,e=this;if(this.activeButton){var n=this.buttons.map((function(t){return t}));if((null===(t=this.buttons[0])||void 0===t?void 0:t.id)!==this.activeButton){var i=this.buttons.find((function(t){return t.id===e.activeButton}));i&&(n.splice(n.indexOf(i),1),n.unshift(i))}this.orderedBtns.next(n)}else this.orderedBtns.next(this.buttons)},t.prototype.ngOnDestroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},t.prototype.onButtonClick=function(t){["icons","shapes","asset","frames","embeds"].includes(t)?i.Ob.track("fab."+t+".click"):i.Ob.track("fab.click",{value1Type:"tagBarButton",value1:t}),this.buttonClick.emit(t)},t.prototype.listenToButtonChanges=function(){return this._buttons.pipe(Object(Tt.a)(1),Object(g.a)((function(){})))},t.\u0275fac=function(e){return new(e||t)(r.gc(i.Mb))},t.\u0275cmp=r.ac({type:t,selectors:[["panel-tag-bar"]],viewQuery:function(t,e){var n;(1&t&&(r.kd(Ao,!0),r.kd(_o,!0)),2&t)&&(r.Mc(n=r.vc())&&(e.panelTagContainer=n.first),r.Mc(n=r.vc())&&(e.slider=n.first))},inputs:{activeButton:"activeButton",buttons:"buttons"},outputs:{buttonClick:"buttonClick"},features:[r.Qb],decls:6,vars:3,consts:[[1,"panel-tag-bar"],[1,"fx-overflow-hidden"],["panelTagContainer",""],[1,"panel-tag-bar-buttons"],[3,"icon","label","active","click",4,"ngFor","ngForOf"],[3,"icon","label","active","click"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1,2),r.mc(3,"div",3),r.dd(4,Lo,1,3,"panel-toolbar-button",4),r.zc(5,"async"),r.lc(),r.lc(),r.lc()),2&t&&(r.Sb(4),r.Dc("ngForOf",r.Ac(5,1,e.orderedBtns)))},directives:[Z.s,ko],pipes:[Z.b],styles:[".panel-tag-bar[_ngcontent-%COMP%]{padding-left:.25rem;padding-bottom:.5rem;background:#fafafc;display:flex;left:0;flex-wrap:wrap;height:64px;overflow:hidden;box-shadow:inset 0 2px 4px -2px rgba(39,41,50,.04);position:absolute;z-index:3}.panel-tag-bar[_ngcontent-%COMP%]:hover{height:auto}.panel-tag-bar[_ngcontent-%COMP%]   panel-toolbar-button[_ngcontent-%COMP%]{margin-top:.5rem;margin-right:.5rem}@media only screen and (max-width:1440px){.panel-tag-bar[_ngcontent-%COMP%]{padding-left:.5rem}}.panel-tag-bar-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}"]}),t}(),Bo=["plusFab"],Ho=["panelContainer"],Fo=["multiSearch"],No=["panel"];function Go(t,e){if(1&t&&(r.xc(),r.wc(),r.mc(0,"simple-dropdown-item",28),r.uc("click",(function(){return e.$implicit.onClick()})),r.mc(1,"a",29),r.fd(2),r.lc(),r.lc()),2&t){var n=e.$implicit;r.Dc("item",n),r.Sb(2),r.gd(n.label)}}var qo=function(){return{closeOnItemClicked:!0,openOnHover:!1,closeOnBlur:!0,multiselectable:!1}};function Vo(t,e){if(1&t&&(r.mc(0,"div",22),r.mc(1,"abs-dropdown",23),r.mc(2,"simple-dropdown-button",24),r.xc(),r.mc(3,"svg",25),r.hc(4,"use",26),r.lc(),r.lc(),r.dd(5,Go,3,2,"simple-dropdown-item",27),r.lc(),r.lc()),2&t){var n=r.yc();r.Sb(1),r.Dc("settings",r.Hc(3,qo)),r.Sb(1),r.Dc("items",n.contextMenuItems),r.Sb(3),r.Dc("ngForOf",n.contextMenuItems)}}function Uo(t,e){if(1&t){var n=r.nc();r.mc(0,"div"),r.mc(1,"panel-tag-bar",30),r.uc("buttonClick",(function(t){return r.Qc(n),r.yc().handleButtonClick(t)})),r.lc(),r.lc()}if(2&t){var i=e.ngIf,a=r.yc();r.Yb("fx-hidden",a.hasSearchResults()),r.Sb(1),r.Dc("buttons",i)("activeButton",a.activeToolbarButton)}}var zo=function(){return{event:"fab.button.click"}},Yo=function(){return["fx-pointer-events-none","fx-hidden"]},Xo=function(){return["fx-pointer-events-auto"]},Ko=function(){return{event:"fab.moreshapes.click"}},Qo=function(){return{event:"fab.templates.click"}},Wo=function(){function t(t,e,n,i,a){this.translate=t,this.state=e,this.elementRef=n,this.modalController=i,this.userLocator=a,this.toolbarButtons=new Y.a([]),this.hasOverlay=!1,this.triggerScrollUpdate=new Se.a,this.subs=[],this.toolbarButtons=new Y.a(this.toolbarBtns),this.menuViewState=ho.Closed,this.floatingPanelViewState=ho.Closed,this.isPinned=!0,this.hasSearch=!0}return Object.defineProperty(t.prototype,"tooltipForFAB",{get:function(){return this.menuViewState===ho.Closed||this.menuViewState===ho.Closing?this.translate.instant("TEMPLATE_PANEL.ADD_TO_WORKSPACE"):this.translate.instant("TOOLTIPS.CLOSE_PANEL")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedPanelId",{get:function(){return this.state.get("SelectedFloatingPanel")||"shapes"},set:function(t){this.panels&&(this._selectedPanel&&this._selectedPanel.id===t||(this._selectedPanel=this.panels.find((function(e){return e.id===t}))),this.state.get("SelectedFloatingPanel")!==t&&this.state.set("SelectedFloatingPanel",t))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeToolbarButton",{get:function(){if(this.selectedPanelId)return"shapes"===this.selectedPanelId&&"Shapes"!==this.state.get("CurrentLibraryGroup")?this.state.get("CurrentLibraryGroup"):this.selectedPanelId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedPanel",{get:function(){return this._selectedPanel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasActions",{get:function(){return this.hasSearch||this.hasContextMenu},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasContextMenu",{get:function(){var t,e,n;return!!(null===(n=null===(e=null===(t=this._selectedPanel)||void 0===t?void 0:t.contextMenuItems)||void 0===e?void 0:e.value)||void 0===n?void 0:n.length)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contextMenuItems",{get:function(){var t,e,n;return(null===(n=null===(e=null===(t=this._selectedPanel)||void 0===t?void 0:t.contextMenuItems)||void 0===e?void 0:e.value)||void 0===n?void 0:n.filter((function(t){return t.available})))||[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"toolbarBtns",{get:function(){var t=Object(x.uniqBy)(this.state.get("CurrentLibraries"),(function(t){return t.libGroup})).filter((function(t){return"Shapes"!==t.libGroup})).map((function(t){return{id:t.libGroup,label:t.libGroup}}));return Object(u.j)(this.defaultButtons,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultButtons",{get:function(){return[{id:"shapes",label:"Shapes",icon:"./assets/images/fab/fab-shapes.svg"},{id:"asset",label:"Imports",icon:"./assets/images/fab/fab-assets.svg"},{id:"icons",label:"Stickers",icon:"./assets/images/fab/fab-stickers.svg"},{id:"frames",label:"Frames",icon:"./assets/images/fab/fab-frames.svg"},{id:"embeds",label:"Embeds",icon:"./assets/images/fab/fab-frames.svg"}]},enumerable:!1,configurable:!0}),t.prototype.ngAfterViewInit=function(){this.subs.push(this.listenToToolbarButtonChanges().subscribe(),this.listenFloatingPanelChanges().subscribe(),this.toggleOnLibStateChange().subscribe())},t.prototype.ngOnDestroy=function(){for(;this.subs.length;)this.subs.pop().unsubscribe();this.toolbarButtons.complete()},t.prototype.toggleOnLibStateChange=function(){var t=this;return this.state.changes("CurrentLibraries").pipe(Object(g.a)((function(){var e=t.state.get("SelectedFloatingPanel");if(e&&"shapes"!==e){if("none"===e)return t.toggleMenu(),void t.togglePanel("shapes");t.togglePanel("shapes")}})))},t.prototype.toggleMenu=function(){this.menuViewState===ho.Opened?(i.Ob.track("fab.panel.close"),this.closeMenu(),this.toolbarButtons.next([])):(this.toolbarButtons.next(this.toolbarBtns),this.openMenu())},t.prototype.togglePanel=function(t,e){void 0===e&&(e=!1);var n=this.selectedPanelId===t;this.multiSearch&&"asset"!==t&&(this.multiSearch.clear(),this.multiSearch.focus()),this.selectedPanelId=t,"none"!==t?this.floatingPanelViewState===ho.Opened?n&&!e?this.goToNextViewState(ho.Closed):this.handleSelectedPanelOpen():(this.goToNextViewState(ho.Opened),this.handleSelectedPanelOpen(),this.toolbarButtons.next(this.toolbarBtns)):this.goToNextViewState(ho.Closed)},t.prototype.hasSearchResults=function(){var t,e;return!!(null===(e=null===(t=this.multiSearch)||void 0===t?void 0:t.showSearchResults)||void 0===e?void 0:e.value)},t.prototype.handleButtonClick=function(t){var e;this.triggerScrollUpdate.next(!0),(null===(e=this.toolbarButtons.value.find((function(e){return e.id===t})))||void 0===e?void 0:e.icon)?(this.state.set("SelectedFloatingPanel",t),"shapes"===t&&this.state.set("CurrentLibraryGroup","Shapes")):this.state.set("CurrentLibraryGroup",t)},t.prototype.handleMoreButtonClick=function(t){"more-shapes"===t?this.openLibraryBrowser():this.handleShowTemplates(),this.triggerScrollUpdate.next(!0)},t.prototype.openLibraryBrowser=function(){this.modalController.show(dr.a)},t.prototype.handleShowTemplates=function(){return this.state.set("TemplateOriginLocation","floating-panel"),this.state.set("ToggleTemplatesModal",!0)},t.prototype.listenToToolbarButtonChanges=function(){var t=this;return this.state.changes("CurrentLibraries").pipe(Object(g.a)((function(){return t.toolbarButtons.next(t.toolbarBtns)})))},t.prototype.getLibraryGroups=function(t){return Object(I.a)(t).pipe(Object(m.a)((function(t){return t.map((function(t){return t.libGroup}))})),Object(m.a)((function(t){return Object(x.uniq)(t)})))},t.prototype.listenFloatingPanelChanges=function(){var t=this;return this.state.changes("SelectedFloatingPanel").pipe(Object(d.a)((function(t){return!!t})),Object(g.a)((function(e){t.menuViewState===ho.Closed&&t.toggleMenu(),t.togglePanel(e,!0)})))},t.prototype.handleOutsideClick=function(){var t=this;return Object(X.a)(document,"mousedown").pipe(Object(d.a)((function(e){var n;return!t.elementRef.nativeElement.contains(e.target)&&!t.isPinned&&(null===(n=t.plusFab)||void 0===n?void 0:n.active)})),Object(g.a)((function(){return t.goToNextViewState(ho.Closed)})))},t.prototype.openMenu=function(){this.plusFab.active=!0,this.menuViewState=ho.Opened;var t="none"===this.selectedPanelId?"shapes":this.selectedPanelId;this.togglePanel(t,!0)},t.prototype.closeMenu=function(){this.plusFab.active=!1,this.menuViewState=ho.Closed,this.floatingPanelViewState===ho.Opened&&this.goToNextViewState(ho.Closed)},t.prototype.handleSelectedPanelOpen=function(){var t,e;(null===(t=this.selectedPanel)||void 0===t?void 0:t.onOpen)&&this.selectedPanel.onOpen(),this.hasSearch=null===(e=this.selectedPanel)||void 0===e?void 0:e.hasSearch,this.plusFab.active=!0},t.prototype.handleSelectedPanelClose=function(){var t;(null===(t=this.selectedPanel)||void 0===t?void 0:t.onClose)&&this.selectedPanel.onClose()},t.prototype.goToNextViewState=function(t){var e=this;if(this.floatingPanelViewState!==t&&this.panelContainer){var n,i=this.floatingPanelViewState;switch(i){case ho.Closed:t===ho.Opened&&(n=ho.Opening);break;case ho.Opened:t===ho.Closed&&(n=ho.Closing)}n&&(this.floatingPanelViewState=n),this.transitionState(i,t).start().pipe(Object(g.a)({complete:function(){e.floatingPanelViewState=t,e.floatingPanelViewState===ho.Closed&&e.handleSelectedPanelClose()}})).subscribe()}},t.prototype.transitionState=function(t,e){var n,a,r={opacity:0,transform:"translateY(75px)"},o={opacity:1,transform:"translateY(0)"};switch(t){case ho.Closed:n=r;break;case ho.Opened:n=o}switch(e){case ho.Closed:a=r;break;case ho.Opened:a=o}var s=new i.l({from:n,to:a,transitionProperty:"opacity, transform",duration:100,easing:"ease-in-out"});return s.element=this.panelContainer.nativeElement,s},t.\u0275fac=function(e){return new(e||t)(r.gc(o.e),r.gc(i.Mb),r.gc(r.r),r.gc(i.kb),r.gc(xn.y))},t.\u0275cmp=r.ac({type:t,selectors:[["floating-panel-container"]],viewQuery:function(t,e){var n;(1&t&&(r.kd(Bo,!0),r.kd(Ho,!0),r.kd(Fo,!0),r.kd(No,!0)),2&t)&&(r.Mc(n=r.vc())&&(e.plusFab=n.first),r.Mc(n=r.vc())&&(e.panelContainer=n.first),r.Mc(n=r.vc())&&(e.multiSearch=n.first),r.Mc(n=r.vc())&&(e.panels=n))},decls:35,vars:33,consts:[[1,"floating-section"],[1,"floating-menu-container"],["tooltip-tour-step","new-fab-tooltip","icon","plus-large","size","large","activeAnimation","rotate",1,"plus-button",3,"trackAction","tooltip","click"],["plusFab",""],[1,"fx-pointer-events-auto","floating-quick-tools"],["tooltip-tour-step","fab-1.1"],[1,"floating-panel-container",3,"ngClass"],["panelContainer",""],["tooltip-tour-step","fab",1,"actions-container"],["tooltip-tour-step","fab-1.4.3"],["multiSearch",""],["class","context-menu-container",4,"ngIf"],[3,"fx-hidden",4,"ngIf"],[1,"panel-container"],["panel",""],[3,"triggerScrollUpdate"],[1,"more-btns-section"],["tooltip-tour-step","fab-1.4.1",1,"more-shapes-btn","btn-medium","btn-primary","fx-span-width","fx-no-padding","fx-no-margin",3,"trackAction","click"],["src","./assets/images/fab/fab-all-shapes.svg",1,"fx-margin-right-8","nu-icon","nu-icon-xsmall"],[1,"more-shapes-btn","btn-medium","btn-primary","fx-span-width","fx-no-padding","fx-no-margin",3,"trackAction","click"],["src","./assets/images/fab/fab-templates.svg",1,"fx-margin-right-8","nu-icon","nu-icon-xsmall"],["id","preview-popover"],[1,"context-menu-container"],["direction","up",1,"context-menu",3,"settings"],["ddbutton","",3,"items"],[1,"nu-icon","nu-icon-more"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-more"],["dditem","",3,"item","click",4,"ngFor","ngForOf"],["dditem","",3,"item","click"],["translate","",1,"context-menu-item"],[3,"buttons","activeButton","buttonClick"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"floating-action-button",2,3),r.uc("click",(function(){return e.toggleMenu()})),r.lc(),r.mc(4,"div",4),r.hc(5,"insert-buttons-container",5),r.lc(),r.lc(),r.mc(6,"div",6,7),r.mc(8,"div",8),r.hc(9,"multi-search",9,10),r.dd(11,Vo,6,4,"div",11),r.dd(12,Uo,2,4,"div",12),r.zc(13,"async"),r.lc(),r.mc(14,"div",13),r.hc(15,"icons-panel",null,14),r.hc(17,"frames-panel",null,14),r.hc(19,"embeds-panel",null,14),r.hc(21,"asset-panel",null,14),r.hc(23,"shapes-panel",15,14),r.lc(),r.mc(25,"div",16),r.mc(26,"button",17),r.uc("click",(function(){return e.handleMoreButtonClick("more-shapes")})),r.hc(27,"img",18),r.fd(28),r.zc(29,"async"),r.lc(),r.mc(30,"button",19),r.uc("click",(function(){return e.handleMoreButtonClick("templates")})),r.hc(31,"img",20),r.fd(32),r.zc(33,"async"),r.lc(),r.lc(),r.lc(),r.hc(34,"library-preview-popover",21),r.lc()),2&t&&(r.Sb(2),r.Dc("trackAction",r.Hc(28,zo))("tooltip",e.tooltipForFAB),r.Sb(4),r.Yb("has-actions",e.hasActions),r.Dc("ngClass","closed"===e.floatingPanelViewState?r.Hc(29,Yo):r.Hc(30,Xo)),r.Sb(5),r.Dc("ngIf",e.hasContextMenu),r.Sb(1),r.Dc("ngIf",r.Ac(13,22,e.toolbarButtons)),r.Sb(3),r.Yb("fx-hidden","icons"!==e.selectedPanelId||e.hasSearchResults()),r.Sb(2),r.Yb("fx-hidden","frames"!==e.selectedPanelId||e.hasSearchResults()),r.Sb(2),r.Yb("fx-hidden","embeds"!==e.selectedPanelId||e.hasSearchResults()),r.Sb(2),r.Yb("fx-hidden","asset"!==e.selectedPanelId||e.hasSearchResults()),r.Sb(2),r.Yb("fx-hidden","shapes"!==e.selectedPanelId||e.hasSearchResults()),r.Dc("triggerScrollUpdate",e.triggerScrollUpdate),r.Sb(3),r.Dc("trackAction",r.Hc(31,Ko)),r.Sb(2),r.hd(" ",r.Ac(29,24,e.translate.get("SHAPES_PANEL.ALL_SHAPES"))," "),r.Sb(2),r.Dc("trackAction",r.Hc(32,Qo)),r.Sb(2),r.hd(" ",r.Ac(33,26,e.translate.get("TEMPLATE_PANEL.TEMPLATES"))," "))},directives:[fo,Ae.a,Ra.a,_a.a,tr,Z.q,no,Z.t,Oo,Co,jo,uo,Mo,Io.a,ir.a,ar.a,Z.s,rr.a,o.a,Ro],pipes:[Z.b],styles:["[_nghost-%COMP%]{display:flex;align-items:flex-end;-webkit-align-items:flex-end}.floating-section[_ngcontent-%COMP%]{display:flex;flex-direction:column-reverse}.plus-button[_ngcontent-%COMP%]{z-index:1}.floating-menu-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;position:relative}.menu-button[_ngcontent-%COMP%]{margin-bottom:.625rem;display:block}.menu-container[_ngcontent-%COMP%]{position:absolute;bottom:0;opacity:0;transition:transform .1s ease-in-out,opacity .1s ease-in-out}.menu-container.active[_ngcontent-%COMP%]{transform:translateY(-55px);opacity:1}@supports (background:-webkit-canvas(squares)){.floating-panel-container[_ngcontent-%COMP%]{left:80px}}.floating-panel-container[_ngcontent-%COMP%]{box-shadow:0 2px 2px rgba(0,0,0,.15),0 1px 12px rgba(0,0,0,.15);margin-bottom:1rem;margin-left:0;opacity:0;display:flex;flex-direction:column;flex-grow:1;background:#fff;border-radius:6px;width:329px}.floating-panel-container[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{pointer-events:all;align-items:center;padding:6px 0 16px;height:112px}.floating-panel-container[_ngcontent-%COMP%]   .context-menu-item[_ngcontent-%COMP%]{padding:.5rem .25rem;color:#04263d;border-radius:.25rem;display:block}.floating-panel-container[_ngcontent-%COMP%]   .context-menu-item[_ngcontent-%COMP%]:hover{color:#04263d;background:#e1f1fb}@media only screen and (max-width:1440px){.floating-panel-container[_ngcontent-%COMP%]{width:228px}}.panel-container[_ngcontent-%COMP%]{height:calc(100vh - 196px - 160px);padding-right:0;padding-left:.5rem;flex-grow:1}@media only screen and (max-width:1440px){.panel-container[_ngcontent-%COMP%]{height:calc(100vh - 196px - 200px)}}.floating-quick-tools[_ngcontent-%COMP%]{box-shadow:0 2px 2px rgba(0,0,0,.15),0 1px 12px rgba(0,0,0,.15);padding:.25rem .25rem .25rem 1.25rem;margin-left:-1rem;background:#fff;border-radius:4px 0 4px 4px;width:298px}.more-btns-section[_ngcontent-%COMP%]{padding:1rem;display:flex;flex-direction:row;position:relative}@media only screen and (max-width:1440px){.more-btns-section[_ngcontent-%COMP%]{flex-direction:column}}.more-btns-section[_ngcontent-%COMP%] > button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:1rem}@media only screen and (max-width:1440px){.more-btns-section[_ngcontent-%COMP%] > button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:0;margin-top:.5rem}}"]}),t}(),Zo=["sliderContainer"],Jo=["slider"];function $o(t,e){if(1&t){var n=r.nc();r.mc(0,"button",10),r.uc("click",(function(){return r.Qc(n),r.yc().handlePreviousButtonClick()})),r.xc(),r.mc(1,"svg",11),r.hc(2,"use",12),r.lc(),r.lc()}}function ts(t,e){if(1&t){var n=r.nc();r.mc(0,"panel-toolbar-button",13),r.uc("click",(function(){r.Qc(n);var t=e.$implicit;return r.yc().buttonClick.next(t.id)})),r.lc()}if(2&t){var i=e.$implicit,a=r.yc();r.Dc("icon",null==i?null:i.icon)("label",null==i?null:i.label)("active",a.activeButton==i.id)}}function es(t,e){if(1&t){var n=r.nc();r.mc(0,"button",14),r.uc("click",(function(){return r.Qc(n),r.yc().handleNextButtonClick()})),r.xc(),r.mc(1,"svg",15),r.hc(2,"use",12),r.lc(),r.lc()}}var ns=function(t){return{left:t}},is=function(){function t(t){this.state=t,this._buttons=new Y.a([]),this.pinButtonClick=new r.t,this.buttonClick=new r.t,this.moreButtonClick=new r.t,this.sliderLeft=0,this.subs=[]}return Object.defineProperty(t.prototype,"buttons",{get:function(){return this._buttons.value},set:function(t){this._buttons.next(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliderContainerWidth",{get:function(){return this.sliderContainer.nativeElement.offsetWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliderWidth",{get:function(){return this.slider.nativeElement.scrollWidth},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){this.subs.push(this.listenToButtonChanges().subscribe())},t.prototype.handleNextButtonClick=function(){this.showPreviousButton||(this.showPreviousButton=!0);var e=this.sliderWidth-(this.sliderContainerWidth+-this.sliderLeft);e>0&&(e>t.SCROLL_STEP_SIZE?this.sliderLeft-=t.SCROLL_STEP_SIZE:this.sliderLeft-=e),-this.sliderLeft==this.sliderWidth-this.sliderContainerWidth&&(this.showNextButton=!1)},t.prototype.handlePreviousButtonClick=function(){this.showNextButton||(this.showNextButton=!0),this.sliderLeft<0&&(this.sliderLeft<-t.SCROLL_STEP_SIZE?this.sliderLeft+=t.SCROLL_STEP_SIZE:this.sliderLeft+=-this.sliderLeft),0===this.sliderLeft&&(this.showPreviousButton=!1)},t.prototype.listenToButtonChanges=function(){var t=this;return this._buttons.pipe(Object(Tt.a)(1),Object(g.a)((function(){t.sliderWidth>t.sliderContainerWidth&&!t.showNextButton&&(t.showNextButton=!0)})))},t.SCROLL_STEP_SIZE=35,t.\u0275fac=function(e){return new(e||t)(r.gc(i.Mb))},t.\u0275cmp=r.ac({type:t,selectors:[["panel-toolbar"]],viewQuery:function(t,e){var n;(1&t&&(r.kd(Zo,!0),r.kd(Jo,!0)),2&t)&&(r.Mc(n=r.vc())&&(e.sliderContainer=n.first),r.Mc(n=r.vc())&&(e.slider=n.first))},inputs:{isPinned:"isPinned",activeButton:"activeButton",buttons:"buttons"},outputs:{pinButtonClick:"pinButtonClick",buttonClick:"buttonClick",moreButtonClick:"moreButtonClick"},decls:10,vars:7,consts:[[1,"panel-toolbar"],["class","panel-toolbar-slider-control-button previous",3,"click",4,"ngIf"],[1,"panel-toolbar-buttons-slider-container"],["sliderContainer",""],[1,"panel-toolbar-buttons-slider",3,"ngStyle"],["slider",""],["icon","pin",3,"active","click"],[3,"icon","label","active","click",4,"ngFor","ngForOf"],["icon","plus",3,"click"],["class","panel-toolbar-slider-control-button next",3,"click",4,"ngIf"],[1,"panel-toolbar-slider-control-button","previous",3,"click"],[1,"nu-icon","nu-ic-collapse-arrow-left"],[0,"xlink","href","./assets/icons/symbol-defs.svg#nu-ic-collapse-arrow"],[3,"icon","label","active","click"],[1,"panel-toolbar-slider-control-button","next",3,"click"],[1,"nu-icon","nu-ic-collapse-arrow-right"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.dd(1,$o,3,0,"button",1),r.mc(2,"div",2,3),r.mc(4,"div",4,5),r.mc(6,"panel-toolbar-button",6),r.uc("click",(function(){return e.pinButtonClick.next()})),r.lc(),r.dd(7,ts,1,3,"panel-toolbar-button",7),r.mc(8,"panel-toolbar-button",8),r.uc("click",(function(){return e.moreButtonClick.next()})),r.lc(),r.lc(),r.lc(),r.dd(9,es,3,0,"button",9),r.lc()),2&t&&(r.Sb(1),r.Dc("ngIf",e.showPreviousButton),r.Sb(3),r.Dc("ngStyle",r.Ic(5,ns,e.sliderLeft+"px")),r.Sb(2),r.Dc("active",e.isPinned),r.Sb(1),r.Dc("ngForOf",e.buttons),r.Sb(2),r.Dc("ngIf",e.showNextButton))},directives:[Z.t,Z.w,ko,Z.s],styles:[".panel-toolbar[_ngcontent-%COMP%]{display:flex;background:#fff;padding:10px 16px;position:relative}panel-toolbar-button[_ngcontent-%COMP%]:not(:last-child){margin-right:10px}.panel-toolbar-buttons-slider-container[_ngcontent-%COMP%]{overflow:hidden}.panel-toolbar-buttons-slider[_ngcontent-%COMP%]{display:flex;position:relative;transition:left .25s ease-in-out}.panel-toolbar-slider-control-button[_ngcontent-%COMP%]{width:16px;height:32px;background:transparent;display:flex;position:absolute;pointer-events:all;cursor:pointer}.panel-toolbar-slider-control-button.previous[_ngcontent-%COMP%]{left:0}.panel-toolbar-slider-control-button.next[_ngcontent-%COMP%]{right:0}.nu-ic-collapse-arrow-left[_ngcontent-%COMP%]{transform:rotate(180deg)}"]}),t}(),as=["quickToolCollapsibleMenu"],rs=["quickToolScrollbar"],os=function(){function t(t,e,n){this.state=t,this.commandService=e,this.libraryList=n,this.subs=[]}return t.prototype.ngOnInit=function(){this.subs.push(this.listenToFloatingPanelChanges().subscribe(),this.listenToLibraryChanges().subscribe())},t.prototype.ngOnDestroy=function(){for(;this.subs.length>0;)this.subs.pop().unsubscribe()},t.prototype.initLibrary=function(){this.resetLibs(),this.updateMenu(this.getDefaultLibraries())},t.prototype.getDefaultLibraries=function(){var t,e=null===(t=this.state.get("CurrentLibraries"))||void 0===t?void 0:t.filter((function(t){return t.id.includes("custom-database-")})).length;return this.libraryList.getQuickToolLibraries().filter((function(t){return!!e||"quick-tool-database"!==t.id})).map((function(t){return{id:t.id,libGroup:t.libGroup,type:fi.c.Static,status:"loading"}}))},t.prototype.scrollToLibrary=function(t){var e=this.directiveScroll.directiveRef.elementRef.nativeElement.getBoundingClientRect(),n=this.directiveScroll.directiveRef.geometry(),i=this.collapsibleMenu.children?this.collapsibleMenu.getChildBounds(t):void 0;i&&i.height>e.height?this.directiveScroll.directiveRef.scrollToY(n.h-i.height,100):this.directiveScroll.directiveRef.scrollToBottom(0,100)},t.prototype.listenToFloatingPanelChanges=function(){var t=this;return this.state.changes("SelectedFloatingPanel").pipe(Object(d.a)((function(t){return"quick-toolbar"===t})),Object(g.a)((function(){return t.initLibrary()})))},t.prototype.resetLibs=function(){this.removeOtherLibrariesFromMenu([])},t.prototype.listenToLibraryChanges=function(){var t=this;return this.state.changes("SelectedFloatingPanel").pipe(Object(d.a)((function(t){return"quick-toolbar"===t})),Object(f.a)((function(){return t.state.changes("CurrentLibraries").pipe(Object(d.a)((function(t){return!!t})),Object(m.a)((function(t){return t.filter((function(t){return t.id.includes("custom-database-")})).map((function(t){return t.id}))})),Object(bt.a)(),Object(g.a)((function(){var e=t.getDefaultLibraries();t.updateMenu(e)})))})))},t.prototype.updateMenu=function(t){this.addLibrariesToMenu(t),this.removeOtherLibrariesFromMenu(t)},t.prototype.addLibrariesToMenu=function(t){var e=this;t.length<=0||t.filter((function(t){return!e.collapsibleMenu.has(t.id)&&t.type===fi.c.Static})).forEach((function(t){t.type===fi.c.Static&&(t.id.includes("custom-database-")||t.id.includes("quick-tool-")?e.collapsibleMenu.add(i.u,mo.a,{id:t.id,trackingInfo:{location:"FAB.QuickTool"}},!1,{collapsable:!1}):e.collapsibleMenu.add(i.u,vo.a,{id:t.id,trackingInfo:{location:"FAB.QuickTool"}},!1))}))},t.prototype.removeOtherLibrariesFromMenu=function(t){var e=this;this.collapsibleMenu.panels.forEach((function(n){t.find((function(t){return t.id===n.id}))||e.collapsibleMenu.detachById(n.id).subscribe()}))},t.\u0275fac=function(e){return new(e||t)(r.gc(i.Mb),r.gc(i.B),r.gc(sa.a))},t.\u0275cmp=r.ac({type:t,selectors:[["quick-toolbar-library-container"]],viewQuery:function(t,e){var n;(1&t&&(r.Xc(as,!0),r.Xc(rs,!0)),2&t)&&(r.Mc(n=r.vc())&&(e.collapsibleMenu=n.first),r.Mc(n=r.vc())&&(e.directiveScroll=n.first))},decls:5,vars:0,consts:[[1,"lib-container"],["tooltip-tour-step","fab-1.1",1,"col-menu-scrollbar"],["quickToolScrollbar",""],[1,"lib-collapsible-menu"],["quickToolCollapsibleMenu",""]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"perfect-scrollbar",1,2),r.hc(3,"collapsible-menu",3,4),r.lc(),r.lc())},directives:[mr.b,Ae.a,yo.a],styles:[".lib-container[_ngcontent-%COMP%], [_nghost-%COMP%]{max-height:inherit;padding-left:8px;padding-right:4px}.lib-container[_ngcontent-%COMP%]   .lib-collapsible-menu[_ngcontent-%COMP%], [_nghost-%COMP%]   .lib-collapsible-menu[_ngcontent-%COMP%]{padding-right:4px}.lib-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:inherit}.lib-container[_ngcontent-%COMP%]   perfect-scrollbar[_ngcontent-%COMP%]{max-height:inherit}.lib-container[_ngcontent-%COMP%]  .ps-content{margin-right:10px}.lib-container[_ngcontent-%COMP%]  .col-menu-item-heading-title{padding-left:5px}.lib-message[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),t}(),ss=function(){function t(){this.id="quick-toolbar",this.hasSearch=!0,this.isPinned=!0}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.ac({type:t,selectors:[["quick-toolbar-panel"]],decls:4,vars:0,consts:[[1,"floating-panel","quick-toolbar-panel"],["tooltip-tour-step","fab"],[1,"lib-insert-btn-section","lib-padding"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.hc(1,"quick-toolbar-library-container",1),r.mc(2,"div",2),r.hc(3,"insert-buttons-container"),r.lc(),r.lc())},directives:[os,Ae.a,tr],styles:[".floating-panel[_ngcontent-%COMP%]{pointer-events:auto}.floating-panel[_ngcontent-%COMP%], [_nghost-%COMP%]{height:100%}.quick-toolbar-panel.no-libraries[_ngcontent-%COMP%]  .lib-shapes{height:0}.lib-padding[_ngcontent-%COMP%]{padding-left:8px;padding-right:8px}"],changeDetection:0}),t}(),cs=n("HY3P"),ls=n("bq/2"),us=n("eaE7"),ps=n("BJDd"),ds=n("hb43"),hs=n("UfOR"),gs=n("S8c2"),fs=n("fdBj"),bs=n("LX6Z"),ms=n("6uE6"),vs=n("Y4mt"),ys=n("rPyh"),Ss=n("sIsI"),Os=n("nmkj"),xs=n("OlX0"),Cs=n("uIWG"),Ts=n("igS9"),js=n("/kaM"),Ps=n("xejr"),ws=n("0Ohc"),Ms=n("am3J"),Is=n("ZFuN"),Es=n("+ZK7"),Ds=n("rwb9"),ks=n("vd2+"),As=n("HF29"),_s=n("QVgP"),Ls=n("qtZD"),Rs=n("bMav"),Bs=n("UFl8"),Hs=n("T4H+"),Fs=n("thzy"),Ns=n("NvYU"),Gs=n("S8Qb"),qs=n("uDTp"),Vs=n("lQIu"),Us=n("D8VW"),zs=n("8uPo"),Ys=n("GmW1"),Xs=n("ys29"),Ks=n("D+VW"),Qs=n("8Tlt"),Ws=n("rDL/"),Zs=n("LiJA"),Js=n("0Gjp"),$s=n("eRmX"),tc=n("IG37"),ec=n("XwbL"),nc=n("uXwy"),ic=n("g5Ym"),ac=n("dfHf"),rc=n("1ahL"),oc=n("x7My"),sc=n("TeX2"),cc=n("4Kso"),lc=n("/ege"),uc=n("TT9f"),pc=n("x+xc"),dc=function(){function t(){}return t.\u0275mod=r.ec({type:t}),t.\u0275inj=r.dc({factory:function(e){return new(e||t)},providers:[Oa.a,xa.a,hi.a,pt.a,ua.a,sa.a,Da.a],imports:[[Z.c,Ce.m,z.o,Ea.a,i.W,o.c]]}),t}();r.Uc(io.a,[Z.q,Z.r,Z.s,Z.t,Z.A,Z.w,Z.x,Z.y,Z.z,Z.u,Z.v,Ce.I,Ce.x,Ce.H,Ce.d,Ce.y,Ce.B,Ce.a,Ce.E,Ce.F,Ce.A,Ce.s,Ce.t,Ce.D,Ce.o,Ce.n,Ce.z,Ce.b,Ce.e,Ce.v,Ce.w,Ce.u,cs.a,ls.a,us.a,ps.a,_a.a,ds.a,hs.a,gs.a,fs.a,bs.a,ms.a,yo.a,vs.a,ys.a,Ss.a,Os.a,xs.a,Cs.a,Ts.a,js.b,Ps.a,ws.a,Ms.a,Is.a,J.a,ir.a,Es.a,Ds.a,rr.a,ar.a,ks.a,mr.b,mr.c,As.a,_s.a,Ls.a,_e.a,Rs.a,Bs.a,Hs.a,Fs.a,Ns.a,br.a,Gs.a,qs.a,Vs.b,Us.a,zs.a,Ys.a,Xs.a,Ks.a,Qs.a,Io.a,Er.a,Ws.a,Zs.a,Js.a,$s.a,vr.a,tc.a,ec.a,nc.a,ic.a,bo.a,ac.a,rc.a,oc.a,sc.a,Ae.a,cc.a,La.a,Ra.a,lc.a,uc.a,o.a,fo,Wo,Mo,ss,Oo,wo,os,So,xo,To,Co,jo,uo,lo,io.a,tr,nr,is,Ro,ko,fr,wr,lr,no,Zr],[Z.b,Z.G,Z.p,Z.k,Z.E,Z.g,Z.C,Z.F,Z.d,Z.f,Z.i,Z.j,Z.l,pc.b,pc.a,o.d]),r.Uc(fr,[Z.q,Z.r,Z.s,Z.t,Z.A,Z.w,Z.x,Z.y,Z.z,Z.u,Z.v,Ce.I,Ce.x,Ce.H,Ce.d,Ce.y,Ce.B,Ce.a,Ce.E,Ce.F,Ce.A,Ce.s,Ce.t,Ce.D,Ce.o,Ce.n,Ce.z,Ce.b,Ce.e,Ce.v,Ce.w,Ce.u,cs.a,ls.a,us.a,ps.a,_a.a,ds.a,hs.a,gs.a,fs.a,bs.a,ms.a,yo.a,vs.a,ys.a,Ss.a,Os.a,xs.a,Cs.a,Ts.a,js.b,Ps.a,ws.a,Ms.a,Is.a,J.a,ir.a,Es.a,Ds.a,rr.a,ar.a,ks.a,mr.b,mr.c,As.a,_s.a,Ls.a,_e.a,Rs.a,Bs.a,Hs.a,Fs.a,Ns.a,br.a,Gs.a,qs.a,Vs.b,Us.a,zs.a,Ys.a,Xs.a,Ks.a,Qs.a,Io.a,Er.a,Ws.a,Zs.a,Js.a,$s.a,vr.a,tc.a,ec.a,nc.a,ic.a,bo.a,ac.a,rc.a,oc.a,sc.a,Ae.a,cc.a,La.a,Ra.a,lc.a,uc.a,o.a,fo,Wo,Mo,ss,Oo,wo,os,So,xo,To,Co,jo,uo,lo,io.a,tr,nr,is,Ro,ko,fr,wr,lr,no,Zr],[Z.b,Z.G,Z.p,Z.k,Z.E,Z.g,Z.C,Z.F,Z.d,Z.f,Z.i,Z.j,Z.l,pc.b,pc.a,o.d]);var hc=n("Ax/4"),gc=n("XRvk"),fc=n("54H5"),bc=n("CdCz"),mc=n("f0nv"),vc=n("z3n9"),yc=n("SXG+"),Sc=n("CDoB"),Oc=n("9jP7"),xc=[{matcher:function(t,e){var n;return"dashboard"===(null===(n=null==e?void 0:e.segments[0])||void 0===n?void 0:n.path)?{consumed:t}:null},resolve:[ya],canDeactivate:[ya],children:[{component:Aa.a,path:""},{outlet:"dashboard-canvas-message",component:s,path:""}]},{path:"**",resolve:[ya],canDeactivate:[ya],children:[{component:Aa.a,path:""},{outlet:"tiptap-docs",component:Sc.a,path:""},{outlet:"hyperlink-editor",component:ut.a,path:""},{outlet:"shapelink-editor",component:ot,path:""},{outlet:"floating-panels",component:Wo,path:""}]}],Cc=function(){function t(t,e,n,i,a,r,o,s,c,l,u,p,d,h,g,f,b,m,v,y,O,x,C,j,P,w,M){this.mapper=t,this.defSumLocator=e,this.changeBindingSvc=n,this.resultChangeBindingSvc=i,this.textBoundsBinder=a,this.containerChangeBinder=r,this.containerRulesBinder=o,this.containerChildrenLayoutingBinder=s,this.shapeBoundsBinder=c,this.shapeAddedBinder=l,this.connectorReconnectBinder=u,this.connectorReconnectBinderAutolayout=p,this.connectionChangeBinder=d,this.connectorLookupValueBinder=h,this.gluepointsBinder=g,this.textDataItemBinder=f,this.layoutingBinder=b,this.textParserinder=m,this.shapeCodeBinder=v,this.taskBinder=y,this.shapeEDataChangeBinder=O,this.searchService=x,this.defShapeSearchProvider=C,this.librarySearchProvider=j,this.state=P,this.dataDefCodeBinder=w,this.displayRuleBinder=M,this.state.set("ProjectDiagrams",{}),this.state.set("ProjectMap",{}),this.state.set("RecentDiagrams",[]),N.s.register(this.mapper),S.a.register(this.mapper),Q.a.register(this.mapper),N.f.register(this.mapper),T.a.register(this.mapper),Zt.a.register(this.mapper),N.I.register(this.mapper),e.load().subscribe(),this.changeBindingSvc.register(f),this.resultChangeBindingSvc.register(b),this.resultChangeBindingSvc.register(s),this.changeBindingSvc.register(m),this.changeBindingSvc.register(a),this.changeBindingSvc.register(r),this.changeBindingSvc.register(o),this.changeBindingSvc.register(s),this.changeBindingSvc.register(c),this.changeBindingSvc.register(l),this.changeBindingSvc.register(u),this.changeBindingSvc.register(p),this.changeBindingSvc.register(d),this.changeBindingSvc.register(h),this.changeBindingSvc.register(g),this.changeBindingSvc.register(v),this.changeBindingSvc.register(y),this.changeBindingSvc.register(M),this.changeBindingSvc.register(w),this.changeBindingSvc.register(O),this.searchService.register(C),this.searchService.register(j)}return t.\u0275mod=r.ec({type:t}),t.\u0275inj=r.dc({factory:function(e){return new(e||t)(r.qc(i.z),r.qc(xa.a),r.qc(Ca.a),r.qc(vc.a),r.qc(dt.a),r.qc(F.a),r.qc(fc.a),r.qc(H.a),r.qc(st.a),r.qc(B),r.qc(lt.a),r.qc(Oc.a),r.qc(c.a),r.qc(bc.a),r.qc(ct.a),r.qc(Ta.a),r.qc(yc.a),r.qc(ja.a),r.qc(Pa.a),r.qc(hc.a),r.qc(l.a),r.qc(Ia.a),r.qc(wa.a),r.qc(Ma.a),r.qc(i.Mb),r.qc(gc.a),r.qc(mc.a))},providers:[ya,ve,xe,ye.b,pa,Oa.a,xa.a,hi.a,pt.a,ua.a,lt.a,Oc.a,ct.a,B,sa.a,Da.a,va],imports:[[Sa.h.forChild(xc),Z.c,Ce.m,z.o,ka.a,dc,Ea.a,i.W,o.c]]}),t}()}}]);
//# sourceMappingURL=30.49a787b6ab5e2a45f7ea.js.map